<!--

The OpenFin Hypergrid is a high performant canvas based general grid control.  It is implemented as a Polymer HTML5 web-component. See [Polymer](https://www.polymer-project.org/) and [Web Components](http://www.w3.org/TR/components-intro/).

<br>
### Openfin polymerized hypergrid Demo
To see the "pink" demo
- see the [github pages hosted deplyment](http://openfin.github.io/fin-hypergrid/components/fin-hypergrid/demo.html) or
- run the [openfin installer](https://dl.openfin.co/services/download?fileName=hypergrid-demo-installer&config=http://openfin.github.io/fin-hypergrid/components/fin-hypergrid/demo.json)


### The Hypergrid is dependent on several other OpenFin projects
- [fin-canvas](http://stevewirts.github.io/fin-canvas/components/fin-canvas/): a wrapper to provide a simpler interface to the HTML5 canvas component
- [fin-rectangle](http://stevewirts.github.io/fin-rectangle/components/fin-rectangle/): a small library providing Point and Rectangle objects
- [fin-vampire-bar](http://datamadic.github.io/fin-vampire-bar/components/fin-vampire-bar/): a web-component based general scroll bar control

### Pluggable Grid Behaviors
The Hypergrid design makes no assumptions about the data you wish to view which allows for external data sources and external manipulation and analytics.  Manipulations such as sorting, aggregation, and grouping can be achieved using best of breed high-performant real time tools designed for such purposes. All the code that impacts these operations has been factored into an Object called [PluggableGridBehavior](index.html#fin-hypergrid-behavior-default).  A PluggableGridBehavior can be thought of as a traditional tablemodel but with a little more responsibility.  There are Three example PluggableGridBehaviors provided, the base or DefaultGridBehavior, a QGridBehavior, and an InMemoryGridBehavior.

@group OpenFin hypergrid
@element fin-hypergrid
@homepage http://github.com/openfin/fin-hypergrid
--><html><head><script>window.PolymerGestures={};</script><script>(function(scope){var hasFullPath=false;var pathTest=document.createElement("meta");if(pathTest.createShadowRoot){var sr=pathTest.createShadowRoot();var s=document.createElement("span");sr.appendChild(s);pathTest.addEventListener("testpath",function(ev){if(ev.path){hasFullPath=ev.path[0]===s}ev.stopPropagation()});var ev=new CustomEvent("testpath",{bubbles:true});document.head.appendChild(pathTest);s.dispatchEvent(ev);pathTest.parentNode.removeChild(pathTest);sr=s=null}pathTest=null;var target={shadow:function(inEl){if(inEl){return inEl.shadowRoot||inEl.webkitShadowRoot}},canTarget:function(shadow){return shadow&&Boolean(shadow.elementFromPoint)},targetingShadow:function(inEl){var s=this.shadow(inEl);if(this.canTarget(s)){return s}},olderShadow:function(shadow){var os=shadow.olderShadowRoot;if(!os){var se=shadow.querySelector("shadow");if(se){os=se.olderShadowRoot}}return os},allShadows:function(element){var shadows=[],s=this.shadow(element);while(s){shadows.push(s);s=this.olderShadow(s)}return shadows},searchRoot:function(inRoot,x,y){var t,st,sr,os;if(inRoot){t=inRoot.elementFromPoint(x,y);if(t){sr=this.targetingShadow(t)}else if(inRoot!==document){sr=this.olderShadow(inRoot)}return this.searchRoot(sr,x,y)||t}},owner:function(element){if(!element){return document}var s=element;while(s.parentNode){s=s.parentNode}if(s.nodeType!=Node.DOCUMENT_NODE&&s.nodeType!=Node.DOCUMENT_FRAGMENT_NODE){s=document}return s},findTarget:function(inEvent){if(hasFullPath&&inEvent.path&&inEvent.path.length){return inEvent.path[0]}var x=inEvent.clientX,y=inEvent.clientY;var s=this.owner(inEvent.target);if(!s.elementFromPoint(x,y)){s=document}return this.searchRoot(s,x,y)},findTouchAction:function(inEvent){var n;if(hasFullPath&&inEvent.path&&inEvent.path.length){var path=inEvent.path;for(var i=0;i<path.length;i++){n=path[i];if(n.nodeType===Node.ELEMENT_NODE&&n.hasAttribute("touch-action")){return n.getAttribute("touch-action")}}}else{n=inEvent.target;while(n){if(n.nodeType===Node.ELEMENT_NODE&&n.hasAttribute("touch-action")){return n.getAttribute("touch-action")}n=n.parentNode||n.host}}return"auto"},LCA:function(a,b){if(a===b){return a}if(a&&!b){return a}if(b&&!a){return b}if(!b&&!a){return document}if(a.contains&&a.contains(b)){return a}if(b.contains&&b.contains(a)){return b}var adepth=this.depth(a);var bdepth=this.depth(b);var d=adepth-bdepth;if(d>=0){a=this.walk(a,d)}else{b=this.walk(b,-d)}while(a&&b&&a!==b){a=a.parentNode||a.host;b=b.parentNode||b.host}return a},walk:function(n,u){for(var i=0;n&&i<u;i++){n=n.parentNode||n.host}return n},depth:function(n){var d=0;while(n){d++;n=n.parentNode||n.host}return d},deepContains:function(a,b){var common=this.LCA(a,b);return common===a},insideNode:function(node,x,y){var rect=node.getBoundingClientRect();return rect.left<=x&&x<=rect.right&&rect.top<=y&&y<=rect.bottom},path:function(event){var p;if(hasFullPath&&event.path&&event.path.length){p=event.path}else{p=[];var n=this.findTarget(event);while(n){p.push(n);n=n.parentNode||n.host}}return p}};scope.targetFinding=target;scope.findTarget=target.findTarget.bind(target);scope.deepContains=target.deepContains.bind(target);scope.insideNode=target.insideNode})(window.PolymerGestures);</script><script>(function(){function shadowSelector(v){return"html /deep/ "+selector(v)}function selector(v){return'[touch-action="'+v+'"]'}function rule(v){return"{ -ms-touch-action: "+v+"; touch-action: "+v+";}"}var attrib2css=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]},"manipulation"];var styles="";var hasTouchAction=typeof document.head.style.touchAction==="string";var hasShadowRoot=!window.ShadowDOMPolyfill&&document.head.createShadowRoot;if(hasTouchAction){attrib2css.forEach(function(r){if(String(r)===r){styles+=selector(r)+rule(r)+"\n";if(hasShadowRoot){styles+=shadowSelector(r)+rule(r)+"\n"}}else{styles+=r.selectors.map(selector)+rule(r.rule)+"\n";if(hasShadowRoot){styles+=r.selectors.map(shadowSelector)+rule(r.rule)+"\n"}}});var el=document.createElement("style");el.textContent=styles;document.head.appendChild(el)}})();</script><script>(function(scope){var MOUSE_PROPS=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"];var MOUSE_DEFAULTS=[false,false,null,null,0,0,0,0,false,false,false,false,0,null,0,0];var NOP_FACTORY=function(){return function(){}};var eventFactory={preventTap:NOP_FACTORY,makeBaseEvent:function(inType,inDict){var e=document.createEvent("Event");e.initEvent(inType,inDict.bubbles||false,inDict.cancelable||false);e.preventTap=eventFactory.preventTap(e);return e},makeGestureEvent:function(inType,inDict){inDict=inDict||Object.create(null);var e=this.makeBaseEvent(inType,inDict);for(var i=0,keys=Object.keys(inDict),k;i<keys.length;i++){k=keys[i];e[k]=inDict[k]}return e},makePointerEvent:function(inType,inDict){inDict=inDict||Object.create(null);var e=this.makeBaseEvent(inType,inDict);for(var i=0,p;i<MOUSE_PROPS.length;i++){p=MOUSE_PROPS[i];e[p]=inDict[p]||MOUSE_DEFAULTS[i]}e.buttons=inDict.buttons||0;var pressure=0;if(inDict.pressure){pressure=inDict.pressure}else{pressure=e.buttons?.5:0}e.x=e.clientX;e.y=e.clientY;e.pointerId=inDict.pointerId||0;e.width=inDict.width||0;e.height=inDict.height||0;e.pressure=pressure;e.tiltX=inDict.tiltX||0;e.tiltY=inDict.tiltY||0;e.pointerType=inDict.pointerType||"";e.hwTimestamp=inDict.hwTimestamp||0;e.isPrimary=inDict.isPrimary||false;e._source=inDict._source||"";return e}};scope.eventFactory=eventFactory})(window.PolymerGestures);</script><script>(function(scope){var USE_MAP=window.Map&&window.Map.prototype.forEach;var POINTERS_FN=function(){return this.size};function PointerMap(){if(USE_MAP){var m=new Map;m.pointers=POINTERS_FN;return m}else{this.keys=[];this.values=[]}}PointerMap.prototype={set:function(inId,inEvent){var i=this.keys.indexOf(inId);if(i>-1){this.values[i]=inEvent}else{this.keys.push(inId);this.values.push(inEvent)}},has:function(inId){return this.keys.indexOf(inId)>-1},"delete":function(inId){var i=this.keys.indexOf(inId);if(i>-1){this.keys.splice(i,1);this.values.splice(i,1)}},get:function(inId){var i=this.keys.indexOf(inId);return this.values[i]},clear:function(){this.keys.length=0;this.values.length=0},forEach:function(callback,thisArg){this.values.forEach(function(v,i){callback.call(thisArg,v,this.keys[i],this)},this)},pointers:function(){return this.keys.length}};scope.PointerMap=PointerMap})(window.PolymerGestures);</script><script>(function(scope){var CLONE_PROPS=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp","preventTap","tapPrevented","_source"];var CLONE_DEFAULTS=[false,false,null,null,0,0,0,0,false,false,false,false,0,null,0,0,0,0,0,0,0,"",0,false,"",null,null,0,0,0,0,function(){},false];var HAS_SVG_INSTANCE=typeof SVGElementInstance!=="undefined";var eventFactory=scope.eventFactory;var currentGestures;var dispatcher={IS_IOS:false,pointermap:new scope.PointerMap,requiredGestures:new scope.PointerMap,eventMap:Object.create(null),eventSources:Object.create(null),eventSourceList:[],gestures:[],dependencyMap:{down:{listeners:0,index:-1},up:{listeners:0,index:-1}},gestureQueue:[],registerSource:function(name,source){var s=source;var newEvents=s.events;if(newEvents){newEvents.forEach(function(e){if(s[e]){this.eventMap[e]=s[e].bind(s)}},this);this.eventSources[name]=s;this.eventSourceList.push(s)}},registerGesture:function(name,source){var obj=Object.create(null);obj.listeners=0;obj.index=this.gestures.length;for(var i=0,g;i<source.exposes.length;i++){g=source.exposes[i].toLowerCase();this.dependencyMap[g]=obj}this.gestures.push(source)},register:function(element,initial){var l=this.eventSourceList.length;for(var i=0,es;i<l&&(es=this.eventSourceList[i]);i++){es.register.call(es,element,initial)}},unregister:function(element){var l=this.eventSourceList.length;for(var i=0,es;i<l&&(es=this.eventSourceList[i]);i++){es.unregister.call(es,element)}},down:function(inEvent){this.requiredGestures.set(inEvent.pointerId,currentGestures);this.fireEvent("down",inEvent)},move:function(inEvent){inEvent.type="move";this.fillGestureQueue(inEvent)},up:function(inEvent){this.fireEvent("up",inEvent);this.requiredGestures.delete(inEvent.pointerId)},cancel:function(inEvent){inEvent.tapPrevented=true;this.fireEvent("up",inEvent);this.requiredGestures.delete(inEvent.pointerId)},addGestureDependency:function(node,currentGestures){var gesturesWanted=node._pgEvents;if(gesturesWanted&&currentGestures){var gk=Object.keys(gesturesWanted);for(var i=0,r,ri,g;i<gk.length;i++){g=gk[i];if(gesturesWanted[g]>0){r=this.dependencyMap[g];ri=r?r.index:-1;currentGestures[ri]=true}}}},eventHandler:function(inEvent){var type=inEvent.type;if(type==="touchstart"||type==="mousedown"||type==="pointerdown"||type==="MSPointerDown"){if(!inEvent._handledByPG){currentGestures={}}if(this.IS_IOS){var ev=inEvent;if(type==="touchstart"){var ct=inEvent.changedTouches[0];ev={target:inEvent.target,clientX:ct.clientX,clientY:ct.clientY,path:inEvent.path}}var nodes=inEvent.path||scope.targetFinding.path(ev);for(var i=0,n;i<nodes.length;i++){n=nodes[i];this.addGestureDependency(n,currentGestures)}}else{this.addGestureDependency(inEvent.currentTarget,currentGestures)}}if(inEvent._handledByPG){return}var fn=this.eventMap&&this.eventMap[type];if(fn){fn(inEvent)}inEvent._handledByPG=true},listen:function(target,events){for(var i=0,l=events.length,e;i<l&&(e=events[i]);i++){this.addEvent(target,e)}},unlisten:function(target,events){for(var i=0,l=events.length,e;i<l&&(e=events[i]);i++){this.removeEvent(target,e)}},addEvent:function(target,eventName){target.addEventListener(eventName,this.boundHandler)},removeEvent:function(target,eventName){target.removeEventListener(eventName,this.boundHandler)},makeEvent:function(inType,inEvent){var e=eventFactory.makePointerEvent(inType,inEvent);e.preventDefault=inEvent.preventDefault;e.tapPrevented=inEvent.tapPrevented;e._target=e._target||inEvent.target;return e},fireEvent:function(inType,inEvent){var e=this.makeEvent(inType,inEvent);return this.dispatchEvent(e)},cloneEvent:function(inEvent){var eventCopy=Object.create(null),p;for(var i=0;i<CLONE_PROPS.length;i++){p=CLONE_PROPS[i];eventCopy[p]=inEvent[p]||CLONE_DEFAULTS[i];if(p==="target"||p==="relatedTarget"){if(HAS_SVG_INSTANCE&&eventCopy[p]instanceof SVGElementInstance){eventCopy[p]=eventCopy[p].correspondingUseElement}}}eventCopy.preventDefault=function(){inEvent.preventDefault()};return eventCopy},dispatchEvent:function(inEvent){var t=inEvent._target;if(t){t.dispatchEvent(inEvent);var clone=this.cloneEvent(inEvent);clone.target=t;this.fillGestureQueue(clone)}},gestureTrigger:function(){for(var i=0,e,rg;i<this.gestureQueue.length;i++){e=this.gestureQueue[i];rg=e._requiredGestures;if(rg){for(var j=0,g,fn;j<this.gestures.length;j++){if(rg[j]){g=this.gestures[j];fn=g[e.type];if(fn){fn.call(g,e)}}}}}this.gestureQueue.length=0},fillGestureQueue:function(ev){if(!this.gestureQueue.length){requestAnimationFrame(this.boundGestureTrigger)}ev._requiredGestures=this.requiredGestures.get(ev.pointerId);this.gestureQueue.push(ev)}};dispatcher.boundHandler=dispatcher.eventHandler.bind(dispatcher);dispatcher.boundGestureTrigger=dispatcher.gestureTrigger.bind(dispatcher);scope.dispatcher=dispatcher;scope.activateGesture=function(node,gesture){var g=gesture.toLowerCase();var dep=dispatcher.dependencyMap[g];if(dep){var recognizer=dispatcher.gestures[dep.index];if(!node._pgListeners){dispatcher.register(node);node._pgListeners=0}if(recognizer){var touchAction=recognizer.defaultActions&&recognizer.defaultActions[g];var actionNode;switch(node.nodeType){case Node.ELEMENT_NODE:actionNode=node;break;case Node.DOCUMENT_FRAGMENT_NODE:actionNode=node.host;break;default:actionNode=null;break}if(touchAction&&actionNode&&!actionNode.hasAttribute("touch-action")){actionNode.setAttribute("touch-action",touchAction)}}if(!node._pgEvents){node._pgEvents={}}node._pgEvents[g]=(node._pgEvents[g]||0)+1;node._pgListeners++}return Boolean(dep)};scope.addEventListener=function(node,gesture,handler,capture){if(handler){scope.activateGesture(node,gesture);node.addEventListener(gesture,handler,capture)}};scope.deactivateGesture=function(node,gesture){var g=gesture.toLowerCase();var dep=dispatcher.dependencyMap[g];if(dep){if(node._pgListeners>0){node._pgListeners--}if(node._pgListeners===0){dispatcher.unregister(node)}if(node._pgEvents){if(node._pgEvents[g]>0){node._pgEvents[g]--}else{node._pgEvents[g]=0}}}return Boolean(dep)};scope.removeEventListener=function(node,gesture,handler,capture){if(handler){scope.deactivateGesture(node,gesture);node.removeEventListener(gesture,handler,capture)}}})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var pointermap=dispatcher.pointermap;var DEDUP_DIST=25;var WHICH_TO_BUTTONS=[0,1,4,2];var currentButtons=0;var FIREFOX_LINUX=/Linux.*Firefox\//i;var HAS_BUTTONS=function(){if(FIREFOX_LINUX.test(navigator.userAgent)){return false}try{return new MouseEvent("test",{buttons:1}).buttons===1}catch(e){return false}}();var mouseEvents={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup"],exposes:["down","up","move"],register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){if(target===document){return}dispatcher.unlisten(target,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(inEvent){var lts=this.lastTouches;var x=inEvent.clientX,y=inEvent.clientY;for(var i=0,l=lts.length,t;i<l&&(t=lts[i]);i++){var dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DIST&&dy<=DEDUP_DIST){return true}}},prepareEvent:function(inEvent){var e=dispatcher.cloneEvent(inEvent);e.pointerId=this.POINTER_ID;e.isPrimary=true;e.pointerType=this.POINTER_TYPE;e._source="mouse";if(!HAS_BUTTONS){var type=inEvent.type;var bit=WHICH_TO_BUTTONS[inEvent.which]||0;if(type==="mousedown"){currentButtons|=bit}else if(type==="mouseup"){currentButtons&=~bit}e.buttons=currentButtons}return e},mousedown:function(inEvent){if(!this.isEventSimulatedFromTouch(inEvent)){var p=pointermap.has(this.POINTER_ID);var e=this.prepareEvent(inEvent);e.target=scope.findTarget(inEvent);pointermap.set(this.POINTER_ID,e.target);dispatcher.down(e)}},mousemove:function(inEvent){if(!this.isEventSimulatedFromTouch(inEvent)){var target=pointermap.get(this.POINTER_ID);if(target){var e=this.prepareEvent(inEvent);e.target=target;if((HAS_BUTTONS?e.buttons:e.which)===0){if(!HAS_BUTTONS){currentButtons=e.buttons=0}dispatcher.cancel(e);this.cleanupMouse(e.buttons)}else{dispatcher.move(e)}}}},mouseup:function(inEvent){if(!this.isEventSimulatedFromTouch(inEvent)){var e=this.prepareEvent(inEvent);e.relatedTarget=scope.findTarget(inEvent);e.target=pointermap.get(this.POINTER_ID);dispatcher.up(e);this.cleanupMouse(e.buttons)}},cleanupMouse:function(buttons){if(buttons===0){pointermap.delete(this.POINTER_ID)}}};scope.mouseEvents=mouseEvents})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var allShadows=scope.targetFinding.allShadows.bind(scope.targetFinding);var pointermap=dispatcher.pointermap;var touchMap=Array.prototype.map.call.bind(Array.prototype.map);var DEDUP_TIMEOUT=2500;var DEDUP_DIST=25;var CLICK_COUNT_TIMEOUT=200;var HYSTERESIS=20;var ATTRIB="touch-action";var HAS_TOUCH_ACTION=false;var touchEvents={IS_IOS:false,events:["touchstart","touchmove","touchend","touchcancel"],exposes:["down","up","move"],register:function(target,initial){if(this.IS_IOS?initial:!initial){dispatcher.listen(target,this.events)}},unregister:function(target){if(!this.IS_IOS){dispatcher.unlisten(target,this.events)}},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y"},touchActionToScrollType:function(touchAction){var t=touchAction;var st=this.scrollTypes;if(t===st.EMITTER){return"none"}else if(t===st.XSCROLLER){return"X"}else if(t===st.YSCROLLER){return"Y"}else{return"XY"}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(inTouch){return this.firstTouch===inTouch.identifier},setPrimaryTouch:function(inTouch){if(pointermap.pointers()===0||pointermap.pointers()===1&&pointermap.has(1)){this.firstTouch=inTouch.identifier;this.firstXY={X:inTouch.clientX,Y:inTouch.clientY};this.firstTarget=inTouch.target;this.scrolling=null;this.cancelResetClickCount()}},removePrimaryPointer:function(inPointer){if(inPointer.isPrimary){this.firstTouch=null;this.firstXY=null;this.resetClickCount()}},clickCount:0,resetId:null,resetClickCount:function(){var fn=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(fn,CLICK_COUNT_TIMEOUT)},cancelResetClickCount:function(){if(this.resetId){clearTimeout(this.resetId)}},typeToButtons:function(type){var ret=0;if(type==="touchstart"||type==="touchmove"){ret=1}return ret},findTarget:function(touch,id){if(this.currentTouchEvent.type==="touchstart"){if(this.isPrimaryTouch(touch)){var fastPath={clientX:touch.clientX,clientY:touch.clientY,path:this.currentTouchEvent.path,target:this.currentTouchEvent.target};return scope.findTarget(fastPath)}else{return scope.findTarget(touch)}}return pointermap.get(id)},touchToPointer:function(inTouch){var cte=this.currentTouchEvent;var e=dispatcher.cloneEvent(inTouch);var id=e.pointerId=inTouch.identifier+2;e.target=this.findTarget(inTouch,id);e.bubbles=true;e.cancelable=true;e.detail=this.clickCount;e.buttons=this.typeToButtons(cte.type);e.width=inTouch.webkitRadiusX||inTouch.radiusX||0;e.height=inTouch.webkitRadiusY||inTouch.radiusY||0;e.pressure=inTouch.webkitForce||inTouch.force||.5;e.isPrimary=this.isPrimaryTouch(inTouch);e.pointerType=this.POINTER_TYPE;e._source="touch";var self=this;e.preventDefault=function(){self.scrolling=false;self.firstXY=null;cte.preventDefault()};return e},processTouches:function(inEvent,inFunction){var tl=inEvent.changedTouches;this.currentTouchEvent=inEvent;for(var i=0,t,p;i<tl.length;i++){t=tl[i];p=this.touchToPointer(t);if(inEvent.type==="touchstart"){pointermap.set(p.pointerId,p.target)}if(pointermap.has(p.pointerId)){inFunction.call(this,p)}if(inEvent.type==="touchend"||inEvent._cancel){this.cleanUpPointer(p)}}},shouldScroll:function(inEvent){if(this.firstXY){var ret;var touchAction=scope.targetFinding.findTouchAction(inEvent);var scrollAxis=this.touchActionToScrollType(touchAction);if(scrollAxis==="none"){ret=false}else if(scrollAxis==="XY"){ret=true}else{var t=inEvent.changedTouches[0];var a=scrollAxis;var oa=scrollAxis==="Y"?"X":"Y";var da=Math.abs(t["client"+a]-this.firstXY[a]);var doa=Math.abs(t["client"+oa]-this.firstXY[oa]);ret=da>=doa}return ret}},findTouch:function(inTL,inId){for(var i=0,l=inTL.length,t;i<l&&(t=inTL[i]);i++){if(t.identifier===inId){return true}}},vacuumTouches:function(inEvent){var tl=inEvent.touches;if(pointermap.pointers()>=tl.length){var d=[];pointermap.forEach(function(value,key){if(key!==1&&!this.findTouch(tl,key-2)){var p=value;d.push(p)}},this);d.forEach(function(p){this.cancel(p);pointermap.delete(p.pointerId)},this)}},touchstart:function(inEvent){this.vacuumTouches(inEvent);this.setPrimaryTouch(inEvent.changedTouches[0]);this.dedupSynthMouse(inEvent);if(!this.scrolling){this.clickCount++;this.processTouches(inEvent,this.down)}},down:function(inPointer){dispatcher.down(inPointer)},touchmove:function(inEvent){if(HAS_TOUCH_ACTION){if(inEvent.cancelable){this.processTouches(inEvent,this.move)}}else{if(!this.scrolling){if(this.scrolling===null&&this.shouldScroll(inEvent)){this.scrolling=true}else{this.scrolling=false;inEvent.preventDefault();this.processTouches(inEvent,this.move)}}else if(this.firstXY){var t=inEvent.changedTouches[0];var dx=t.clientX-this.firstXY.X;var dy=t.clientY-this.firstXY.Y;var dd=Math.sqrt(dx*dx+dy*dy);if(dd>=HYSTERESIS){this.touchcancel(inEvent);this.scrolling=true;this.firstXY=null}}}},move:function(inPointer){dispatcher.move(inPointer)},touchend:function(inEvent){this.dedupSynthMouse(inEvent);this.processTouches(inEvent,this.up)},up:function(inPointer){inPointer.relatedTarget=scope.findTarget(inPointer);dispatcher.up(inPointer)},cancel:function(inPointer){dispatcher.cancel(inPointer)},touchcancel:function(inEvent){inEvent._cancel=true;this.processTouches(inEvent,this.cancel)},cleanUpPointer:function(inPointer){pointermap["delete"](inPointer.pointerId);this.removePrimaryPointer(inPointer)},dedupSynthMouse:function(inEvent){var lts=scope.mouseEvents.lastTouches;var t=inEvent.changedTouches[0];if(this.isPrimaryTouch(t)){var lt={x:t.clientX,y:t.clientY};lts.push(lt);var fn=function(lts,lt){var i=lts.indexOf(lt);if(i>-1){lts.splice(i,1)}}.bind(null,lts,lt);setTimeout(fn,DEDUP_TIMEOUT)}}};var STOP_PROP_FN=Event.prototype.stopImmediatePropagation||Event.prototype.stopPropagation;document.addEventListener("click",function(ev){var x=ev.clientX,y=ev.clientY;var closeTo=function(touch){var dx=Math.abs(x-touch.x),dy=Math.abs(y-touch.y);return dx<=DEDUP_DIST&&dy<=DEDUP_DIST};var wasTouched=scope.mouseEvents.lastTouches.some(closeTo);var path=scope.targetFinding.path(ev);if(wasTouched){for(var i=0;i<path.length;i++){if(path[i]===touchEvents.firstTarget){return}}ev.preventDefault();STOP_PROP_FN.call(ev)}},true);scope.touchEvents=touchEvents})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var pointermap=dispatcher.pointermap;var HAS_BITMAP_TYPE=window.MSPointerEvent&&typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE==="number";var msEvents={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel"],register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){if(target===document){return}dispatcher.unlisten(target,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(inEvent){var e=inEvent;e=dispatcher.cloneEvent(inEvent);if(HAS_BITMAP_TYPE){e.pointerType=this.POINTER_TYPES[inEvent.pointerType]}e._source="ms";return e},cleanup:function(id){pointermap["delete"](id)},MSPointerDown:function(inEvent){var e=this.prepareEvent(inEvent);e.target=scope.findTarget(inEvent);pointermap.set(inEvent.pointerId,e.target);dispatcher.down(e)},MSPointerMove:function(inEvent){var target=pointermap.get(inEvent.pointerId);if(target){var e=this.prepareEvent(inEvent);e.target=target;dispatcher.move(e)}},MSPointerUp:function(inEvent){var e=this.prepareEvent(inEvent);e.relatedTarget=scope.findTarget(inEvent);e.target=pointermap.get(e.pointerId);dispatcher.up(e);this.cleanup(inEvent.pointerId)},MSPointerCancel:function(inEvent){var e=this.prepareEvent(inEvent);e.relatedTarget=scope.findTarget(inEvent);e.target=pointermap.get(e.pointerId);dispatcher.cancel(e);this.cleanup(inEvent.pointerId)}};scope.msEvents=msEvents})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var pointermap=dispatcher.pointermap;var pointerEvents={events:["pointerdown","pointermove","pointerup","pointercancel"],prepareEvent:function(inEvent){var e=dispatcher.cloneEvent(inEvent);e._source="pointer";return e},register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){if(target===document){return}dispatcher.unlisten(target,this.events)},cleanup:function(id){pointermap["delete"](id)},pointerdown:function(inEvent){var e=this.prepareEvent(inEvent);e.target=scope.findTarget(inEvent);pointermap.set(e.pointerId,e.target);dispatcher.down(e)},pointermove:function(inEvent){var target=pointermap.get(inEvent.pointerId);if(target){var e=this.prepareEvent(inEvent);e.target=target;dispatcher.move(e)}},pointerup:function(inEvent){var e=this.prepareEvent(inEvent);e.relatedTarget=scope.findTarget(inEvent);e.target=pointermap.get(e.pointerId);dispatcher.up(e);this.cleanup(inEvent.pointerId)},pointercancel:function(inEvent){var e=this.prepareEvent(inEvent);e.relatedTarget=scope.findTarget(inEvent);e.target=pointermap.get(e.pointerId);dispatcher.cancel(e);this.cleanup(inEvent.pointerId)}};scope.pointerEvents=pointerEvents})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var nav=window.navigator;if(window.PointerEvent){dispatcher.registerSource("pointer",scope.pointerEvents)}else if(nav.msPointerEnabled){dispatcher.registerSource("ms",scope.msEvents)}else{dispatcher.registerSource("mouse",scope.mouseEvents);if(window.ontouchstart!==undefined){dispatcher.registerSource("touch",scope.touchEvents)}}var ua=navigator.userAgent;var IS_IOS=ua.match(/iPad|iPhone|iPod/)&&"ontouchstart"in window;dispatcher.IS_IOS=IS_IOS;scope.touchEvents.IS_IOS=IS_IOS;dispatcher.register(document,true)})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var eventFactory=scope.eventFactory;var pointermap=new scope.PointerMap;var track={events:["down","move","up"],exposes:["trackstart","track","trackx","tracky","trackend"],defaultActions:{track:"none",trackx:"pan-y",tracky:"pan-x"},WIGGLE_THRESHOLD:4,clampDir:function(inDelta){return inDelta>0?1:-1},calcPositionDelta:function(inA,inB){var x=0,y=0;if(inA&&inB){x=inB.pageX-inA.pageX;y=inB.pageY-inA.pageY}return{x:x,y:y}},fireTrack:function(inType,inEvent,inTrackingData){var t=inTrackingData;var d=this.calcPositionDelta(t.downEvent,inEvent);var dd=this.calcPositionDelta(t.lastMoveEvent,inEvent);if(dd.x){t.xDirection=this.clampDir(dd.x)}else if(inType==="trackx"){return}if(dd.y){t.yDirection=this.clampDir(dd.y)}else if(inType==="tracky"){return}var gestureProto={bubbles:true,cancelable:true,trackInfo:t.trackInfo,relatedTarget:inEvent.relatedTarget,pointerType:inEvent.pointerType,pointerId:inEvent.pointerId,_source:"track"};if(inType!=="tracky"){gestureProto.x=inEvent.x;gestureProto.dx=d.x;gestureProto.ddx=dd.x;gestureProto.clientX=inEvent.clientX;gestureProto.pageX=inEvent.pageX;gestureProto.screenX=inEvent.screenX;gestureProto.xDirection=t.xDirection}if(inType!=="trackx"){gestureProto.dy=d.y;gestureProto.ddy=dd.y;gestureProto.y=inEvent.y;gestureProto.clientY=inEvent.clientY;gestureProto.pageY=inEvent.pageY;gestureProto.screenY=inEvent.screenY;gestureProto.yDirection=t.yDirection}var e=eventFactory.makeGestureEvent(inType,gestureProto);t.downTarget.dispatchEvent(e)},down:function(inEvent){if(inEvent.isPrimary&&(inEvent.pointerType==="mouse"?inEvent.buttons===1:true)){var p={downEvent:inEvent,downTarget:inEvent.target,trackInfo:{},lastMoveEvent:null,xDirection:0,yDirection:0,tracking:false};pointermap.set(inEvent.pointerId,p)}},move:function(inEvent){var p=pointermap.get(inEvent.pointerId);if(p){if(!p.tracking){var d=this.calcPositionDelta(p.downEvent,inEvent);var move=d.x*d.x+d.y*d.y;if(move>this.WIGGLE_THRESHOLD){p.tracking=true;p.lastMoveEvent=p.downEvent;this.fireTrack("trackstart",inEvent,p)}}if(p.tracking){this.fireTrack("track",inEvent,p);this.fireTrack("trackx",inEvent,p);this.fireTrack("tracky",inEvent,p)}p.lastMoveEvent=inEvent}},up:function(inEvent){var p=pointermap.get(inEvent.pointerId);if(p){if(p.tracking){this.fireTrack("trackend",inEvent,p)}pointermap.delete(inEvent.pointerId)}}};dispatcher.registerGesture("track",track)})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var eventFactory=scope.eventFactory;var hold={HOLD_DELAY:200,WIGGLE_THRESHOLD:16,events:["down","move","up"],exposes:["hold","holdpulse","release"],heldPointer:null,holdJob:null,pulse:function(){var hold=Date.now()-this.heldPointer.timeStamp;var type=this.held?"holdpulse":"hold";this.fireHold(type,hold);this.held=true},cancel:function(){clearInterval(this.holdJob);if(this.held){this.fireHold("release")}this.held=false;this.heldPointer=null;this.target=null;this.holdJob=null},down:function(inEvent){if(inEvent.isPrimary&&!this.heldPointer){this.heldPointer=inEvent;this.target=inEvent.target;this.holdJob=setInterval(this.pulse.bind(this),this.HOLD_DELAY)}},up:function(inEvent){if(this.heldPointer&&this.heldPointer.pointerId===inEvent.pointerId){this.cancel()}},move:function(inEvent){if(this.heldPointer&&this.heldPointer.pointerId===inEvent.pointerId){var x=inEvent.clientX-this.heldPointer.clientX;var y=inEvent.clientY-this.heldPointer.clientY;if(x*x+y*y>this.WIGGLE_THRESHOLD){this.cancel()}}},fireHold:function(inType,inHoldTime){var p={bubbles:true,cancelable:true,pointerType:this.heldPointer.pointerType,pointerId:this.heldPointer.pointerId,x:this.heldPointer.clientX,y:this.heldPointer.clientY,_source:"hold"};if(inHoldTime){p.holdTime=inHoldTime}var e=eventFactory.makeGestureEvent(inType,p);this.target.dispatchEvent(e)}};dispatcher.registerGesture("hold",hold)})(window.PolymerGestures);</script><script>(function(scope){var dispatcher=scope.dispatcher;var eventFactory=scope.eventFactory;var pointermap=new scope.PointerMap;var tap={events:["down","up"],exposes:["tap"],down:function(inEvent){if(inEvent.isPrimary&&!inEvent.tapPrevented){pointermap.set(inEvent.pointerId,{target:inEvent.target,buttons:inEvent.buttons,x:inEvent.clientX,y:inEvent.clientY})}},shouldTap:function(e,downState){var tap=true;if(e.pointerType==="mouse"){tap=e.buttons^1&&downState.buttons&1}return tap&&!e.tapPrevented},up:function(inEvent){var start=pointermap.get(inEvent.pointerId);if(start&&this.shouldTap(inEvent,start)){var t=scope.targetFinding.LCA(start.target,inEvent.relatedTarget);if(t){var e=eventFactory.makeGestureEvent("tap",{bubbles:true,cancelable:true,x:inEvent.clientX,y:inEvent.clientY,detail:inEvent.detail,pointerType:inEvent.pointerType,pointerId:inEvent.pointerId,altKey:inEvent.altKey,ctrlKey:inEvent.ctrlKey,metaKey:inEvent.metaKey,shiftKey:inEvent.shiftKey,_source:"tap"});t.dispatchEvent(e)}}pointermap.delete(inEvent.pointerId)}};eventFactory.preventTap=function(e){return function(){e.tapPrevented=true;pointermap.delete(e.pointerId)}};dispatcher.registerGesture("tap",tap)})(window.PolymerGestures);</script><script>(function(global){"use strict";var Token,TokenName,Syntax,Messages,source,index,length,delegate,lookahead,state;Token={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8};TokenName={};TokenName[Token.BooleanLiteral]="Boolean";TokenName[Token.EOF]="<end>";TokenName[Token.Identifier]="Identifier";TokenName[Token.Keyword]="Keyword";TokenName[Token.NullLiteral]="Null";TokenName[Token.NumericLiteral]="Numeric";TokenName[Token.Punctuator]="Punctuator";TokenName[Token.StringLiteral]="String";Syntax={ArrayExpression:"ArrayExpression",BinaryExpression:"BinaryExpression",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",Identifier:"Identifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ThisExpression:"ThisExpression",UnaryExpression:"UnaryExpression"};Messages={UnexpectedToken:"Unexpected token %0",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared"};function assert(condition,message){if(!condition){throw new Error("ASSERT: "+message)}}function isDecimalDigit(ch){return ch>=48&&ch<=57}function isWhiteSpace(ch){return ch===32||ch===9||ch===11||ch===12||ch===160||ch>=5760&&" ᠎             　﻿".indexOf(String.fromCharCode(ch))>0}function isLineTerminator(ch){return ch===10||ch===13||ch===8232||ch===8233}function isIdentifierStart(ch){return ch===36||ch===95||ch>=65&&ch<=90||ch>=97&&ch<=122}function isIdentifierPart(ch){return ch===36||ch===95||ch>=65&&ch<=90||ch>=97&&ch<=122||ch>=48&&ch<=57}function isKeyword(id){return id==="this"}function skipWhitespace(){while(index<length&&isWhiteSpace(source.charCodeAt(index))){++index}}function getIdentifier(){var start,ch;start=index++;while(index<length){ch=source.charCodeAt(index);if(isIdentifierPart(ch)){++index}else{break}}return source.slice(start,index)}function scanIdentifier(){var start,id,type;start=index;id=getIdentifier();if(id.length===1){type=Token.Identifier}else if(isKeyword(id)){type=Token.Keyword}else if(id==="null"){type=Token.NullLiteral}else if(id==="true"||id==="false"){type=Token.BooleanLiteral}else{type=Token.Identifier}return{type:type,value:id,range:[start,index]}}function scanPunctuator(){var start=index,code=source.charCodeAt(index),code2,ch1=source[index],ch2;switch(code){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:++index;return{type:Token.Punctuator,value:String.fromCharCode(code),range:[start,index]};default:code2=source.charCodeAt(index+1);if(code2===61){switch(code){case 37:case 38:case 42:case 43:case 45:case 47:case 60:case 62:case 124:index+=2;return{type:Token.Punctuator,value:String.fromCharCode(code)+String.fromCharCode(code2),range:[start,index]};case 33:case 61:index+=2;if(source.charCodeAt(index)===61){++index}return{type:Token.Punctuator,value:source.slice(start,index),range:[start,index]};default:break}}break}ch2=source[index+1];if(ch1===ch2&&"&|".indexOf(ch1)>=0){index+=2;return{type:Token.Punctuator,value:ch1+ch2,range:[start,index]}}if("<>=!+-*%&|^/".indexOf(ch1)>=0){++index;return{type:Token.Punctuator,value:ch1,range:[start,index]}}throwError({},Messages.UnexpectedToken,"ILLEGAL")}function scanNumericLiteral(){var number,start,ch;ch=source[index];assert(isDecimalDigit(ch.charCodeAt(0))||ch===".","Numeric literal must start with a decimal digit or a decimal point");start=index;number="";if(ch!=="."){number=source[index++];ch=source[index];if(number==="0"){if(ch&&isDecimalDigit(ch.charCodeAt(0))){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}while(isDecimalDigit(source.charCodeAt(index))){number+=source[index++]}ch=source[index]}if(ch==="."){number+=source[index++];while(isDecimalDigit(source.charCodeAt(index))){number+=source[index++]}ch=source[index]}if(ch==="e"||ch==="E"){number+=source[index++];ch=source[index];if(ch==="+"||ch==="-"){number+=source[index++]}if(isDecimalDigit(source.charCodeAt(index))){while(isDecimalDigit(source.charCodeAt(index))){number+=source[index++]}}else{throwError({},Messages.UnexpectedToken,"ILLEGAL")}}if(isIdentifierStart(source.charCodeAt(index))){throwError({},Messages.UnexpectedToken,"ILLEGAL")}return{type:Token.NumericLiteral,value:parseFloat(number),range:[start,index]}}function scanStringLiteral(){var str="",quote,start,ch,octal=false;quote=source[index];assert(quote==="'"||quote==='"',"String literal must starts with a quote");start=index;++index;while(index<length){ch=source[index++];if(ch===quote){quote="";break}else if(ch==="\\"){ch=source[index++];if(!ch||!isLineTerminator(ch.charCodeAt(0))){switch(ch){case"n":str+="\n";break;case"r":str+="\r";break;case"t":str+="	";break;case"b":str+="\b";break;case"f":str+="\f";break;case"v":str+="";break;default:str+=ch;break}}else{if(ch==="\r"&&source[index]==="\n"){++index}}}else if(isLineTerminator(ch.charCodeAt(0))){break}else{str+=ch}}if(quote!==""){throwError({},Messages.UnexpectedToken,"ILLEGAL")}return{type:Token.StringLiteral,value:str,octal:octal,range:[start,index]}}function isIdentifierName(token){return token.type===Token.Identifier||token.type===Token.Keyword||token.type===Token.BooleanLiteral||token.type===Token.NullLiteral}function advance(){var ch;skipWhitespace();if(index>=length){return{type:Token.EOF,range:[index,index]}}ch=source.charCodeAt(index);if(ch===40||ch===41||ch===58){return scanPunctuator()}if(ch===39||ch===34){return scanStringLiteral()}if(isIdentifierStart(ch)){return scanIdentifier()}if(ch===46){if(isDecimalDigit(source.charCodeAt(index+1))){return scanNumericLiteral()}return scanPunctuator()}if(isDecimalDigit(ch)){return scanNumericLiteral()}return scanPunctuator()}function lex(){var token;token=lookahead;index=token.range[1];lookahead=advance();index=token.range[1];return token}function peek(){var pos;pos=index;lookahead=advance();index=pos}function throwError(token,messageFormat){var error,args=Array.prototype.slice.call(arguments,2),msg=messageFormat.replace(/%(\d)/g,function(whole,index){assert(index<args.length,"Message reference must be in range");return args[index]});error=new Error(msg);error.index=index;error.description=msg;throw error}function throwUnexpected(token){throwError(token,Messages.UnexpectedToken,token.value)}function expect(value){var token=lex();if(token.type!==Token.Punctuator||token.value!==value){throwUnexpected(token)}}function match(value){return lookahead.type===Token.Punctuator&&lookahead.value===value}function matchKeyword(keyword){return lookahead.type===Token.Keyword&&lookahead.value===keyword}function consumeSemicolon(){if(source.charCodeAt(index)===59){lex();return}skipWhitespace();if(match(";")){lex();return}if(lookahead.type!==Token.EOF&&!match("}")){throwUnexpected(lookahead)}}function parseArrayInitialiser(){var elements=[];expect("[");while(!match("]")){if(match(",")){lex();elements.push(null)}else{elements.push(parseExpression());if(!match("]")){expect(",")}}}expect("]");return delegate.createArrayExpression(elements)}function parseObjectPropertyKey(){var token;skipWhitespace();token=lex();if(token.type===Token.StringLiteral||token.type===Token.NumericLiteral){return delegate.createLiteral(token)}return delegate.createIdentifier(token.value)}function parseObjectProperty(){var token,key;token=lookahead;skipWhitespace();if(token.type===Token.EOF||token.type===Token.Punctuator){throwUnexpected(token)}key=parseObjectPropertyKey();expect(":");return delegate.createProperty("init",key,parseExpression())}function parseObjectInitialiser(){var properties=[];expect("{");while(!match("}")){properties.push(parseObjectProperty());if(!match("}")){expect(",")}}expect("}");return delegate.createObjectExpression(properties)}function parseGroupExpression(){var expr;expect("(");expr=parseExpression();expect(")");return expr}function parsePrimaryExpression(){var type,token,expr;if(match("(")){return parseGroupExpression()}type=lookahead.type;if(type===Token.Identifier){expr=delegate.createIdentifier(lex().value)}else if(type===Token.StringLiteral||type===Token.NumericLiteral){expr=delegate.createLiteral(lex())}else if(type===Token.Keyword){if(matchKeyword("this")){lex();expr=delegate.createThisExpression()}}else if(type===Token.BooleanLiteral){token=lex();token.value=token.value==="true";expr=delegate.createLiteral(token)}else if(type===Token.NullLiteral){token=lex();token.value=null;expr=delegate.createLiteral(token)}else if(match("[")){expr=parseArrayInitialiser()}else if(match("{")){expr=parseObjectInitialiser()}if(expr){return expr}throwUnexpected(lex())}function parseArguments(){var args=[];expect("(");if(!match(")")){while(index<length){args.push(parseExpression());if(match(")")){break}expect(",")}}expect(")");return args}function parseNonComputedProperty(){var token;token=lex();if(!isIdentifierName(token)){throwUnexpected(token)}return delegate.createIdentifier(token.value)}function parseNonComputedMember(){expect(".");return parseNonComputedProperty()}function parseComputedMember(){var expr;expect("[");expr=parseExpression();expect("]");return expr}function parseLeftHandSideExpression(){var expr,args,property;expr=parsePrimaryExpression();while(true){if(match("[")){property=parseComputedMember();expr=delegate.createMemberExpression("[",expr,property)}else if(match(".")){property=parseNonComputedMember();expr=delegate.createMemberExpression(".",expr,property)}else if(match("(")){args=parseArguments();expr=delegate.createCallExpression(expr,args)}else{break}}return expr}var parsePostfixExpression=parseLeftHandSideExpression;function parseUnaryExpression(){var token,expr;if(lookahead.type!==Token.Punctuator&&lookahead.type!==Token.Keyword){expr=parsePostfixExpression()}else if(match("+")||match("-")||match("!")){token=lex();expr=parseUnaryExpression();expr=delegate.createUnaryExpression(token.value,expr)}else if(matchKeyword("delete")||matchKeyword("void")||matchKeyword("typeof")){throwError({},Messages.UnexpectedToken)}else{expr=parsePostfixExpression()}return expr}function binaryPrecedence(token){var prec=0;if(token.type!==Token.Punctuator&&token.type!==Token.Keyword){return 0}switch(token.value){case"||":prec=1;break;case"&&":prec=2;break;case"==":case"!=":case"===":case"!==":prec=6;break;case"<":case">":case"<=":case">=":case"instanceof":prec=7;break;case"in":prec=7;break;case"+":case"-":prec=9;break;case"*":case"/":case"%":prec=11;break;default:break}return prec}function parseBinaryExpression(){var expr,token,prec,stack,right,operator,left,i;left=parseUnaryExpression();token=lookahead;prec=binaryPrecedence(token);if(prec===0){return left}token.prec=prec;lex();right=parseUnaryExpression();stack=[left,token,right];while((prec=binaryPrecedence(lookahead))>0){while(stack.length>2&&prec<=stack[stack.length-2].prec){right=stack.pop();operator=stack.pop().value;left=stack.pop();expr=delegate.createBinaryExpression(operator,left,right);stack.push(expr)}token=lex();token.prec=prec;stack.push(token);expr=parseUnaryExpression();stack.push(expr)}i=stack.length-1;expr=stack[i];while(i>1){expr=delegate.createBinaryExpression(stack[i-1].value,stack[i-2],expr);i-=2}return expr}function parseConditionalExpression(){var expr,consequent,alternate;expr=parseBinaryExpression();if(match("?")){lex();consequent=parseConditionalExpression();expect(":");alternate=parseConditionalExpression();expr=delegate.createConditionalExpression(expr,consequent,alternate)}return expr}var parseExpression=parseConditionalExpression;function parseFilter(){var identifier,args;identifier=lex();if(identifier.type!==Token.Identifier){throwUnexpected(identifier)}args=match("(")?parseArguments():[];return delegate.createFilter(identifier.value,args)}function parseFilters(){while(match("|")){lex();parseFilter()}}function parseTopLevel(){skipWhitespace();peek();var expr=parseExpression();if(expr){if(lookahead.value===","||lookahead.value=="in"&&expr.type===Syntax.Identifier){parseInExpression(expr)}else{parseFilters();if(lookahead.value==="as"){parseAsExpression(expr)}else{delegate.createTopLevel(expr)}}}if(lookahead.type!==Token.EOF){throwUnexpected(lookahead)}}function parseAsExpression(expr){lex();var identifier=lex().value;delegate.createAsExpression(expr,identifier)}function parseInExpression(identifier){var indexName;if(lookahead.value===","){lex();if(lookahead.type!==Token.Identifier)throwUnexpected(lookahead);indexName=lex().value}lex();var expr=parseExpression();parseFilters();delegate.createInExpression(identifier.name,indexName,expr)}function parse(code,inDelegate){delegate=inDelegate;source=code;index=0;length=source.length;lookahead=null;state={labelSet:{}};return parseTopLevel()}global.esprima={parse:parse}})(this);</script><script>(function(global){"use strict";function prepareBinding(expressionText,name,node,filterRegistry){var expression;try{expression=getExpression(expressionText);if(expression.scopeIdent&&(node.nodeType!==Node.ELEMENT_NODE||node.tagName!=="TEMPLATE"||name!=="bind"&&name!=="repeat")){throw Error("as and in can only be used within <template bind/repeat>")}}catch(ex){console.error("Invalid expression syntax: "+expressionText,ex);return}return function(model,node,oneTime){var binding=expression.getBinding(model,filterRegistry,oneTime);if(expression.scopeIdent&&binding){node.polymerExpressionScopeIdent_=expression.scopeIdent;if(expression.indexIdent)node.polymerExpressionIndexIdent_=expression.indexIdent}return binding}}var expressionParseCache=Object.create(null);function getExpression(expressionText){var expression=expressionParseCache[expressionText];if(!expression){var delegate=new ASTDelegate;esprima.parse(expressionText,delegate);expression=new Expression(delegate);expressionParseCache[expressionText]=expression}return expression}function Literal(value){this.value=value;this.valueFn_=undefined}Literal.prototype={valueFn:function(){if(!this.valueFn_){var value=this.value;this.valueFn_=function(){return value}}return this.valueFn_}};function IdentPath(name){this.name=name;this.path=Path.get(name)}IdentPath.prototype={valueFn:function(){if(!this.valueFn_){var name=this.name;var path=this.path;this.valueFn_=function(model,observer){if(observer)observer.addPath(model,path);return path.getValueFrom(model)}}return this.valueFn_},setValue:function(model,newValue){if(this.path.length==1)model=findScope(model,this.path[0]);return this.path.setValueFrom(model,newValue)}};function MemberExpression(object,property,accessor){this.computed=accessor=="[";this.dynamicDeps=typeof object=="function"||object.dynamicDeps||this.computed&&!(property instanceof Literal);this.simplePath=!this.dynamicDeps&&(property instanceof IdentPath||property instanceof Literal)&&(object instanceof MemberExpression||object instanceof IdentPath);this.object=this.simplePath?object:getFn(object);this.property=!this.computed||this.simplePath?property:getFn(property)}MemberExpression.prototype={get fullPath(){if(!this.fullPath_){var parts=this.object instanceof MemberExpression?this.object.fullPath.slice():[this.object.name];parts.push(this.property instanceof IdentPath?this.property.name:this.property.value);this.fullPath_=Path.get(parts)}return this.fullPath_},valueFn:function(){if(!this.valueFn_){var object=this.object;if(this.simplePath){var path=this.fullPath;this.valueFn_=function(model,observer){if(observer)observer.addPath(model,path);return path.getValueFrom(model)}}else if(!this.computed){var path=Path.get(this.property.name);this.valueFn_=function(model,observer,filterRegistry){var context=object(model,observer,filterRegistry);if(observer)observer.addPath(context,path);return path.getValueFrom(context)}}else{var property=this.property;this.valueFn_=function(model,observer,filterRegistry){var context=object(model,observer,filterRegistry);var propName=property(model,observer,filterRegistry);if(observer)observer.addPath(context,[propName]);return context?context[propName]:undefined}}}return this.valueFn_},setValue:function(model,newValue){if(this.simplePath){this.fullPath.setValueFrom(model,newValue);return newValue}var object=this.object(model);var propName=this.property instanceof IdentPath?this.property.name:this.property(model);return object[propName]=newValue}};function Filter(name,args){this.name=name;this.args=[];for(var i=0;i<args.length;i++){this.args[i]=getFn(args[i])}}Filter.prototype={transform:function(model,observer,filterRegistry,toModelDirection,initialArgs){var fn=filterRegistry[this.name];var context=model;if(fn){context=undefined}else{fn=context[this.name];if(!fn){console.error("Cannot find function or filter: "+this.name);return}}if(toModelDirection){fn=fn.toModel}else if(typeof fn.toDOM=="function"){fn=fn.toDOM}if(typeof fn!="function"){console.error("Cannot find function or filter: "+this.name);return}var args=initialArgs||[];for(var i=0;i<this.args.length;i++){args.push(getFn(this.args[i])(model,observer,filterRegistry))}return fn.apply(context,args)}};function notImplemented(){throw Error("Not Implemented")}var unaryOperators={"+":function(v){return+v},"-":function(v){return-v},"!":function(v){return!v}};var binaryOperators={"+":function(l,r){return l+r},"-":function(l,r){return l-r},"*":function(l,r){return l*r},"/":function(l,r){return l/r},"%":function(l,r){return l%r},"<":function(l,r){return l<r},">":function(l,r){return l>r},"<=":function(l,r){return l<=r},">=":function(l,r){return l>=r},"==":function(l,r){return l==r},"!=":function(l,r){return l!=r},"===":function(l,r){return l===r},"!==":function(l,r){return l!==r},"&&":function(l,r){return l&&r},"||":function(l,r){return l||r}};function getFn(arg){return typeof arg=="function"?arg:arg.valueFn()}function ASTDelegate(){this.expression=null;this.filters=[];this.deps={};this.currentPath=undefined;this.scopeIdent=undefined;this.indexIdent=undefined;this.dynamicDeps=false}ASTDelegate.prototype={createUnaryExpression:function(op,argument){if(!unaryOperators[op])throw Error("Disallowed operator: "+op);argument=getFn(argument);return function(model,observer,filterRegistry){return unaryOperators[op](argument(model,observer,filterRegistry))}},createBinaryExpression:function(op,left,right){if(!binaryOperators[op])throw Error("Disallowed operator: "+op);left=getFn(left);right=getFn(right);switch(op){case"||":this.dynamicDeps=true;return function(model,observer,filterRegistry){return left(model,observer,filterRegistry)||right(model,observer,filterRegistry)};case"&&":this.dynamicDeps=true;return function(model,observer,filterRegistry){return left(model,observer,filterRegistry)&&right(model,observer,filterRegistry)}}return function(model,observer,filterRegistry){return binaryOperators[op](left(model,observer,filterRegistry),right(model,observer,filterRegistry))}},createConditionalExpression:function(test,consequent,alternate){test=getFn(test);consequent=getFn(consequent);alternate=getFn(alternate);this.dynamicDeps=true;return function(model,observer,filterRegistry){return test(model,observer,filterRegistry)?consequent(model,observer,filterRegistry):alternate(model,observer,filterRegistry)}},createIdentifier:function(name){var ident=new IdentPath(name);ident.type="Identifier";return ident},createMemberExpression:function(accessor,object,property){var ex=new MemberExpression(object,property,accessor);if(ex.dynamicDeps)this.dynamicDeps=true;return ex},createCallExpression:function(expression,args){if(!(expression instanceof IdentPath))throw Error("Only identifier function invocations are allowed");var filter=new Filter(expression.name,args);return function(model,observer,filterRegistry){return filter.transform(model,observer,filterRegistry,false)}},createLiteral:function(token){return new Literal(token.value)},createArrayExpression:function(elements){for(var i=0;i<elements.length;i++)elements[i]=getFn(elements[i]);return function(model,observer,filterRegistry){var arr=[];for(var i=0;i<elements.length;i++)arr.push(elements[i](model,observer,filterRegistry));return arr}},createProperty:function(kind,key,value){return{key:key instanceof IdentPath?key.name:key.value,value:value}},createObjectExpression:function(properties){for(var i=0;i<properties.length;i++)properties[i].value=getFn(properties[i].value);return function(model,observer,filterRegistry){var obj={};for(var i=0;i<properties.length;i++)obj[properties[i].key]=properties[i].value(model,observer,filterRegistry);return obj}},createFilter:function(name,args){this.filters.push(new Filter(name,args))},createAsExpression:function(expression,scopeIdent){this.expression=expression;this.scopeIdent=scopeIdent},createInExpression:function(scopeIdent,indexIdent,expression){this.expression=expression;this.scopeIdent=scopeIdent;this.indexIdent=indexIdent},createTopLevel:function(expression){this.expression=expression},createThisExpression:notImplemented};function ConstantObservable(value){this.value_=value}ConstantObservable.prototype={open:function(){return this.value_},discardChanges:function(){return this.value_},deliver:function(){},close:function(){}};function Expression(delegate){this.scopeIdent=delegate.scopeIdent;this.indexIdent=delegate.indexIdent;if(!delegate.expression)throw Error("No expression found.");this.expression=delegate.expression;getFn(this.expression);this.filters=delegate.filters;this.dynamicDeps=delegate.dynamicDeps}Expression.prototype={getBinding:function(model,filterRegistry,oneTime){if(oneTime)return this.getValue(model,undefined,filterRegistry);var observer=new CompoundObserver;var firstValue=this.getValue(model,observer,filterRegistry);var firstTime=true;var self=this;function valueFn(){if(firstTime){firstTime=false;return firstValue}if(self.dynamicDeps)observer.startReset();var value=self.getValue(model,self.dynamicDeps?observer:undefined,filterRegistry);if(self.dynamicDeps)observer.finishReset();return value}function setValueFn(newValue){self.setValue(model,newValue,filterRegistry);return newValue}return new ObserverTransform(observer,valueFn,setValueFn,true)},getValue:function(model,observer,filterRegistry){var value=getFn(this.expression)(model,observer,filterRegistry);for(var i=0;i<this.filters.length;i++){value=this.filters[i].transform(model,observer,filterRegistry,false,[value])}return value},setValue:function(model,newValue,filterRegistry){var count=this.filters?this.filters.length:0;while(count-->0){newValue=this.filters[count].transform(model,undefined,filterRegistry,true,[newValue])}if(this.expression.setValue)return this.expression.setValue(model,newValue)}};function convertStylePropertyName(name){return String(name).replace(/[A-Z]/g,function(c){return"-"+c.toLowerCase()})}var parentScopeName="@"+Math.random().toString(36).slice(2);function findScope(model,prop){while(model[parentScopeName]&&!Object.prototype.hasOwnProperty.call(model,prop)){model=model[parentScopeName]}return model}function isLiteralExpression(pathString){switch(pathString){case"":return false;case"false":case"null":case"true":return true}if(!isNaN(Number(pathString)))return true;return false}function PolymerExpressions(){}PolymerExpressions.prototype={styleObject:function(value){var parts=[];for(var key in value){parts.push(convertStylePropertyName(key)+": "+value[key])}return parts.join("; ")},tokenList:function(value){var tokens=[];for(var key in value){if(value[key])tokens.push(key)}return tokens.join(" ")},prepareInstancePositionChanged:function(template){var indexIdent=template.polymerExpressionIndexIdent_;if(!indexIdent)return;return function(templateInstance,index){templateInstance.model[indexIdent]=index}},prepareBinding:function(pathString,name,node){var path=Path.get(pathString);if(!isLiteralExpression(pathString)&&path.valid){if(path.length==1){return function(model,node,oneTime){if(oneTime)return path.getValueFrom(model);var scope=findScope(model,path[0]);return new PathObserver(scope,path)}}return}return prepareBinding(pathString,name,node,this)},prepareInstanceModel:function(template){var scopeName=template.polymerExpressionScopeIdent_;if(!scopeName)return;var parentScope=template.templateInstance?template.templateInstance.model:template.model;var indexName=template.polymerExpressionIndexIdent_;return function(model){return createScopeObject(parentScope,model,scopeName,indexName)}}};var createScopeObject="__proto__"in{}?function(parentScope,model,scopeName,indexName){var scope={};scope[scopeName]=model;scope[indexName]=undefined;scope[parentScopeName]=parentScope;scope.__proto__=parentScope;return scope}:function(parentScope,model,scopeName,indexName){var scope=Object.create(parentScope);Object.defineProperty(scope,scopeName,{value:model,configurable:true,writable:true});Object.defineProperty(scope,indexName,{value:undefined,configurable:true,writable:true});Object.defineProperty(scope,parentScopeName,{value:parentScope,configurable:true,writable:true});return scope};global.PolymerExpressions=PolymerExpressions;PolymerExpressions.getExpression=getExpression})(this);</script><style shim-shadowdom="">html /deep/ [layout][horizontal],html /deep/ [layout][vertical]{display:-ms-flexbox;display:-webkit-flex;display:flex}html /deep/ [layout][horizontal][inline],html /deep/ [layout][vertical][inline]{display:-ms-inline-flexbox;display:-webkit-inline-flex;display:inline-flex}html /deep/ [layout][horizontal]{-ms-flex-direction:row;-webkit-flex-direction:row;flex-direction:row}html /deep/ [layout][horizontal][reverse]{-ms-flex-direction:row-reverse;-webkit-flex-direction:row-reverse;flex-direction:row-reverse}html /deep/ [layout][vertical]{-ms-flex-direction:column;-webkit-flex-direction:column;flex-direction:column}html /deep/ [layout][vertical][reverse]{-ms-flex-direction:column-reverse;-webkit-flex-direction:column-reverse;flex-direction:column-reverse}html /deep/ [layout][wrap]{-ms-flex-wrap:wrap;-webkit-flex-wrap:wrap;flex-wrap:wrap}html /deep/ [layout][wrap-reverse]{-ms-flex-wrap:wrap-reverse;-webkit-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse}html /deep/ [flex]{-ms-flex:1 1 0;-webkit-flex:1;flex:1;-webkit-flex-basis:0;flex-basis:0}html /deep/ [vertical][layout]>[flex][auto-vertical],html /deep/ [vertical][layout]::shadow [flex][auto-vertical]{-ms-flex:1 1 auto;-webkit-flex-basis:auto;flex-basis:auto}html /deep/ [flex][auto]{-ms-flex:1 1 auto;-webkit-flex-basis:auto;flex-basis:auto}html /deep/ [flex][none]{-ms-flex:none;-webkit-flex:none;flex:none}html /deep/ [flex][one]{-ms-flex:1;-webkit-flex:1;flex:1}html /deep/ [flex][two]{-ms-flex:2;-webkit-flex:2;flex:2}html /deep/ [flex][three]{-ms-flex:3;-webkit-flex:3;flex:3}html /deep/ [flex][four]{-ms-flex:4;-webkit-flex:4;flex:4}html /deep/ [flex][five]{-ms-flex:5;-webkit-flex:5;flex:5}html /deep/ [flex][six]{-ms-flex:6;-webkit-flex:6;flex:6}html /deep/ [flex][seven]{-ms-flex:7;-webkit-flex:7;flex:7}html /deep/ [flex][eight]{-ms-flex:8;-webkit-flex:8;flex:8}html /deep/ [flex][nine]{-ms-flex:9;-webkit-flex:9;flex:9}html /deep/ [flex][ten]{-ms-flex:10;-webkit-flex:10;flex:10}html /deep/ [flex][eleven]{-ms-flex:11;-webkit-flex:11;flex:11}html /deep/ [flex][twelve]{-ms-flex:12;-webkit-flex:12;flex:12}html /deep/ [layout][start]{-ms-flex-align:start;-webkit-align-items:flex-start;align-items:flex-start}html /deep/ [layout][center],html /deep/ [layout][center-center]{-ms-flex-align:center;-webkit-align-items:center;align-items:center}html /deep/ [layout][end]{-ms-flex-align:end;-webkit-align-items:flex-end;align-items:flex-end}html /deep/ [layout][start-justified]{-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start}html /deep/ [layout][center-justified],html /deep/ [layout][center-center]{-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center}html /deep/ [layout][end-justified]{-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end}html /deep/ [layout][around-justified]{-ms-flex-pack:distribute;-webkit-justify-content:space-around;justify-content:space-around}html /deep/ [layout][justified]{-ms-flex-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}html /deep/ [self-start]{-ms-align-self:flex-start;-webkit-align-self:flex-start;align-self:flex-start}html /deep/ [self-center]{-ms-align-self:center;-webkit-align-self:center;align-self:center}html /deep/ [self-end]{-ms-align-self:flex-end;-webkit-align-self:flex-end;align-self:flex-end}html /deep/ [self-stretch]{-ms-align-self:stretch;-webkit-align-self:stretch;align-self:stretch}html /deep/ [block]{display:block}html /deep/ [hidden]{display:none!important}html /deep/ [relative]{position:relative}html /deep/ [fit]{position:absolute;top:0;right:0;bottom:0;left:0}body[fullbleed]{margin:0;height:100vh}html /deep/ [segment],html /deep/ segment{display:block;position:relative;-webkit-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box;margin:1em .5em;padding:1em;background-color:#fff;-webkit-box-shadow:0 0 0 1px rgba(0,0,0,.1);box-shadow:0 0 0 1px rgba(0,0,0,.1);border-radius:5px 5px 5px 5px}</style><script>Polymer={version:"master"};</script><script>if(typeof window.Polymer==="function"){Polymer={}}</script><script>(function(scope){function withDependencies(task,depends){depends=depends||[];if(!depends.map){depends=[depends]}return task.apply(this,depends.map(marshal))}function module(name,dependsOrFactory,moduleFactory){var module;switch(arguments.length){case 0:return;case 1:module=null;break;case 2:module=dependsOrFactory.apply(this);break;default:module=withDependencies(moduleFactory,dependsOrFactory);break}modules[name]=module}function marshal(name){return modules[name]}var modules={};function using(depends,task){HTMLImports.whenImportsReady(function(){withDependencies(task,depends)})}scope.marshal=marshal;scope.modularize=module;scope.using=using})(window);</script><style type="text/css">:host{display:block;position:relative}</style><script>(function(exports){crossfilter.version="1.3.11";function crossfilter_identity(d){return d}crossfilter.permute=permute;function permute(array,index){for(var i=0,n=index.length,copy=new Array(n);i<n;++i){copy[i]=array[index[i]]}return copy}var bisect=crossfilter.bisect=bisect_by(crossfilter_identity);bisect.by=bisect_by;function bisect_by(f){function bisectLeft(a,x,lo,hi){while(lo<hi){var mid=lo+hi>>>1;if(f(a[mid])<x)lo=mid+1;else hi=mid}return lo}function bisectRight(a,x,lo,hi){while(lo<hi){var mid=lo+hi>>>1;if(x<f(a[mid]))hi=mid;else lo=mid+1}return lo}bisectRight.right=bisectRight;bisectRight.left=bisectLeft;return bisectRight}var heap=crossfilter.heap=heap_by(crossfilter_identity);heap.by=heap_by;function heap_by(f){function heap(a,lo,hi){var n=hi-lo,i=(n>>>1)+1;while(--i>0)sift(a,i,n,lo);return a}function sort(a,lo,hi){var n=hi-lo,t;while(--n>0)t=a[lo],a[lo]=a[lo+n],a[lo+n]=t,sift(a,1,n,lo);return a}function sift(a,i,n,lo){var d=a[--lo+i],x=f(d),child;while((child=i<<1)<=n){if(child<n&&f(a[lo+child])>f(a[lo+child+1]))child++;if(x<=f(a[lo+child]))break;a[lo+i]=a[lo+child];i=child}a[lo+i]=d}heap.sort=sort;return heap}var heapselect=crossfilter.heapselect=heapselect_by(crossfilter_identity);heapselect.by=heapselect_by;function heapselect_by(f){var heap=heap_by(f);function heapselect(a,lo,hi,k){var queue=new Array(k=Math.min(hi-lo,k)),min,i,x,d;for(i=0;i<k;++i)queue[i]=a[lo++];heap(queue,0,k);if(lo<hi){min=f(queue[0]);do{if(x=f(d=a[lo])>min){queue[0]=d;min=f(heap(queue,0,k)[0])}}while(++lo<hi)}return queue}return heapselect}var insertionsort=crossfilter.insertionsort=insertionsort_by(crossfilter_identity);insertionsort.by=insertionsort_by;function insertionsort_by(f){function insertionsort(a,lo,hi){for(var i=lo+1;i<hi;++i){for(var j=i,t=a[i],x=f(t);j>lo&&f(a[j-1])>x;--j){a[j]=a[j-1]}a[j]=t}return a}return insertionsort}var quicksort=crossfilter.quicksort=quicksort_by(crossfilter_identity);quicksort.by=quicksort_by;function quicksort_by(f){var insertionsort=insertionsort_by(f);function sort(a,lo,hi){return(hi-lo<quicksort_sizeThreshold?insertionsort:quicksort)(a,lo,hi)}function quicksort(a,lo,hi){var sixth=(hi-lo)/6|0,i1=lo+sixth,i5=hi-1-sixth,i3=lo+hi-1>>1,i2=i3-sixth,i4=i3+sixth;var e1=a[i1],x1=f(e1),e2=a[i2],x2=f(e2),e3=a[i3],x3=f(e3),e4=a[i4],x4=f(e4),e5=a[i5],x5=f(e5);var t;if(x1>x2)t=e1,e1=e2,e2=t,t=x1,x1=x2,x2=t;if(x4>x5)t=e4,e4=e5,e5=t,t=x4,x4=x5,x5=t;if(x1>x3)t=e1,e1=e3,e3=t,t=x1,x1=x3,x3=t;if(x2>x3)t=e2,e2=e3,e3=t,t=x2,x2=x3,x3=t;if(x1>x4)t=e1,e1=e4,e4=t,t=x1,x1=x4,x4=t;if(x3>x4)t=e3,e3=e4,e4=t,t=x3,x3=x4,x4=t;if(x2>x5)t=e2,e2=e5,e5=t,t=x2,x2=x5,x5=t;if(x2>x3)t=e2,e2=e3,e3=t,t=x2,x2=x3,x3=t;if(x4>x5)t=e4,e4=e5,e5=t,t=x4,x4=x5,x5=t;var pivot1=e2,pivotValue1=x2,pivot2=e4,pivotValue2=x4;a[i1]=e1;a[i2]=a[lo];a[i3]=e3;a[i4]=a[hi-1];a[i5]=e5;var less=lo+1,great=hi-2;var pivotsEqual=pivotValue1<=pivotValue2&&pivotValue1>=pivotValue2;if(pivotsEqual){for(var k=less;k<=great;++k){var ek=a[k],xk=f(ek);if(xk<pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}++less}else if(xk>pivotValue1){while(true){var greatValue=f(a[great]);if(greatValue>pivotValue1){great--;continue}else if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek;break}else{a[k]=a[great];a[great--]=ek;break}}}}}else{for(var k=less;k<=great;k++){var ek=a[k],xk=f(ek);if(xk<pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}++less}else{if(xk>pivotValue2){while(true){var greatValue=f(a[great]);if(greatValue>pivotValue2){great--;if(great<k)break;continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek}else{a[k]=a[great];a[great--]=ek}break}}}}}}a[lo]=a[less-1];a[less-1]=pivot1;a[hi-1]=a[great+1];a[great+1]=pivot2;sort(a,lo,less-1);sort(a,great+2,hi);if(pivotsEqual){return a}if(less<i1&&great>i5){var lessValue,greatValue;while((lessValue=f(a[less]))<=pivotValue1&&lessValue>=pivotValue1)++less;while((greatValue=f(a[great]))<=pivotValue2&&greatValue>=pivotValue2)--great;for(var k=less;k<=great;k++){var ek=a[k],xk=f(ek);if(xk<=pivotValue1&&xk>=pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}less++}else{if(xk<=pivotValue2&&xk>=pivotValue2){while(true){var greatValue=f(a[great]);if(greatValue<=pivotValue2&&greatValue>=pivotValue2){great--;if(great<k)break;continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek}else{a[k]=a[great];a[great--]=ek}break}}}}}}return sort(a,less,great+1)}return sort}var quicksort_sizeThreshold=32;var crossfilter_array8=crossfilter_arrayUntyped,crossfilter_array16=crossfilter_arrayUntyped,crossfilter_array32=crossfilter_arrayUntyped,crossfilter_arrayLengthen=crossfilter_arrayLengthenUntyped,crossfilter_arrayWiden=crossfilter_arrayWidenUntyped;if(typeof Uint8Array!=="undefined"){crossfilter_array8=function(n){return new Uint8Array(n)};crossfilter_array16=function(n){return new Uint16Array(n)};crossfilter_array32=function(n){return new Uint32Array(n)};crossfilter_arrayLengthen=function(array,length){if(array.length>=length)return array;var copy=new array.constructor(length);copy.set(array);return copy};crossfilter_arrayWiden=function(array,width){var copy;switch(width){case 16:copy=crossfilter_array16(array.length);break;case 32:copy=crossfilter_array32(array.length);break;default:throw new Error("invalid array width!")}copy.set(array);return copy}}function crossfilter_arrayUntyped(n){var array=new Array(n),i=-1;while(++i<n)array[i]=0;return array}function crossfilter_arrayLengthenUntyped(array,length){var n=array.length;while(n<length)array[n++]=0;return array}function crossfilter_arrayWidenUntyped(array,width){if(width>32)throw new Error("invalid array width!");return array}function crossfilter_filterExact(bisect,value){return function(values){var n=values.length;return[bisect.left(values,value,0,n),bisect.right(values,value,0,n)]}}function crossfilter_filterRange(bisect,range){var min=range[0],max=range[1];return function(values){var n=values.length;return[bisect.left(values,min,0,n),bisect.left(values,max,0,n)]}}function crossfilter_filterAll(values){return[0,values.length]}function crossfilter_null(){return null}function crossfilter_zero(){return 0}function crossfilter_reduceIncrement(p){return p+1}function crossfilter_reduceDecrement(p){return p-1}function crossfilter_reduceAdd(f){return function(p,v){return p+ +f(v)}}function crossfilter_reduceSubtract(f){return function(p,v){return p-f(v)}}exports.crossfilter=crossfilter;function crossfilter(){var crossfilter={add:add,remove:removeData,dimension:dimension,groupAll:groupAll,size:size};var data=[],n=0,m=0,M=8,filters=crossfilter_array8(0),filterListeners=[],dataListeners=[],removeDataListeners=[];function add(newData){var n0=n,n1=newData.length;if(n1){data=data.concat(newData);filters=crossfilter_arrayLengthen(filters,n+=n1);dataListeners.forEach(function(l){l(newData,n0,n1)})}return crossfilter}function removeData(){var newIndex=crossfilter_index(n,n),removed=[];for(var i=0,j=0;i<n;++i){if(filters[i])newIndex[i]=j++;else removed.push(i)}filterListeners.forEach(function(l){l(0,[],removed)});removeDataListeners.forEach(function(l){l(newIndex)});for(var i=0,j=0,k;i<n;++i){if(k=filters[i]){if(i!==j)filters[j]=k,data[j]=data[i];++j}}data.length=j;while(n>j)filters[--n]=0}function dimension(value){var dimension={filter:filter,filterExact:filterExact,filterRange:filterRange,filterFunction:filterFunction,filterAll:filterAll,top:top,bottom:bottom,group:group,groupAll:groupAll,dispose:dispose,remove:dispose};var one=~m&-~m,zero=~one,values,index,newValues,newIndex,sort=quicksort_by(function(i){return newValues[i]}),refilter=crossfilter_filterAll,refilterFunction,indexListeners=[],dimensionGroups=[],lo0=0,hi0=0;dataListeners.unshift(preAdd);dataListeners.push(postAdd);removeDataListeners.push(removeData);m|=one;if(M>=32?!one:m&(1<<M)-1){filters=crossfilter_arrayWiden(filters,M<<=1)}preAdd(data,0,n);postAdd(data,0,n);function preAdd(newData,n0,n1){newValues=newData.map(value);newIndex=sort(crossfilter_range(n1),0,n1);newValues=permute(newValues,newIndex);var bounds=refilter(newValues),lo1=bounds[0],hi1=bounds[1],i;if(refilterFunction){for(i=0;i<n1;++i){if(!refilterFunction(newValues[i],i))filters[newIndex[i]+n0]|=one}}else{for(i=0;i<lo1;++i)filters[newIndex[i]+n0]|=one;for(i=hi1;i<n1;++i)filters[newIndex[i]+n0]|=one}if(!n0){values=newValues;index=newIndex;lo0=lo1;hi0=hi1;return}var oldValues=values,oldIndex=index,i0=0,i1=0;values=new Array(n);index=crossfilter_index(n,n);for(i=0;i0<n0&&i1<n1;++i){if(oldValues[i0]<newValues[i1]){values[i]=oldValues[i0];index[i]=oldIndex[i0++]}else{values[i]=newValues[i1];index[i]=newIndex[i1++]+n0}}for(;i0<n0;++i0,++i){values[i]=oldValues[i0];index[i]=oldIndex[i0]}for(;i1<n1;++i1,++i){values[i]=newValues[i1];index[i]=newIndex[i1]+n0}bounds=refilter(values),lo0=bounds[0],hi0=bounds[1]}function postAdd(newData,n0,n1){indexListeners.forEach(function(l){l(newValues,newIndex,n0,n1)});newValues=newIndex=null}function removeData(reIndex){for(var i=0,j=0,k;i<n;++i){if(filters[k=index[i]]){if(i!==j)values[j]=values[i];index[j]=reIndex[k];++j}}values.length=j;while(j<n)index[j++]=0;var bounds=refilter(values);lo0=bounds[0],hi0=bounds[1]}function filterIndexBounds(bounds){var lo1=bounds[0],hi1=bounds[1];if(refilterFunction){refilterFunction=null;filterIndexFunction(function(d,i){return lo1<=i&&i<hi1});lo0=lo1;hi0=hi1;return dimension}var i,j,k,added=[],removed=[];if(lo1<lo0){for(i=lo1,j=Math.min(lo0,hi1);i<j;++i){filters[k=index[i]]^=one;added.push(k)}}else if(lo1>lo0){for(i=lo0,j=Math.min(lo1,hi0);i<j;++i){filters[k=index[i]]^=one;removed.push(k)}}if(hi1>hi0){for(i=Math.max(lo1,hi0),j=hi1;i<j;++i){filters[k=index[i]]^=one;added.push(k)}}else if(hi1<hi0){for(i=Math.max(lo0,hi1),j=hi0;i<j;++i){filters[k=index[i]]^=one;removed.push(k)}}lo0=lo1;hi0=hi1;filterListeners.forEach(function(l){l(one,added,removed)});return dimension}function filter(range){return range==null?filterAll():Array.isArray(range)?filterRange(range):typeof range==="function"?filterFunction(range):filterExact(range)}function filterExact(value){return filterIndexBounds((refilter=crossfilter_filterExact(bisect,value))(values))}function filterRange(range){return filterIndexBounds((refilter=crossfilter_filterRange(bisect,range))(values))}function filterAll(){return filterIndexBounds((refilter=crossfilter_filterAll)(values))}function filterFunction(f){refilter=crossfilter_filterAll;filterIndexFunction(refilterFunction=f);lo0=0;hi0=n;return dimension}function filterIndexFunction(f){var i,k,x,added=[],removed=[];for(i=0;i<n;++i){if(!(filters[k=index[i]]&one)^!!(x=f(values[i],i))){if(x)filters[k]&=zero,added.push(k);else filters[k]|=one,removed.push(k)}}filterListeners.forEach(function(l){l(one,added,removed)})}function top(k){var array=[],i=hi0,j;while(--i>=lo0&&k>0){if(!filters[j=index[i]]){array.push(data[j]);--k}}return array}function bottom(k){var array=[],i=lo0,j;while(i<hi0&&k>0){if(!filters[j=index[i]]){array.push(data[j]);--k}i++}return array}function group(key){var group={top:top,all:all,reduce:reduce,reduceCount:reduceCount,reduceSum:reduceSum,order:order,orderNatural:orderNatural,size:size,dispose:dispose,remove:dispose};dimensionGroups.push(group);var groups,groupIndex,groupWidth=8,groupCapacity=crossfilter_capacity(groupWidth),k=0,select,heap,reduceAdd,reduceRemove,reduceInitial,update=crossfilter_null,reset=crossfilter_null,resetNeeded=true,groupAll=key===crossfilter_null;if(arguments.length<1)key=crossfilter_identity;filterListeners.push(update);indexListeners.push(add);removeDataListeners.push(removeData);add(values,index,0,n);function add(newValues,newIndex,n0,n1){var oldGroups=groups,reIndex=crossfilter_index(k,groupCapacity),add=reduceAdd,initial=reduceInitial,k0=k,i0=0,i1=0,j,g0,x0,x1,g,x;if(resetNeeded)add=initial=crossfilter_null;groups=new Array(k),k=0;groupIndex=k0>1?crossfilter_arrayLengthen(groupIndex,n):crossfilter_index(n,groupCapacity);if(k0)x0=(g0=oldGroups[0]).key;while(i1<n1&&!((x1=key(newValues[i1]))>=x1))++i1;while(i1<n1){if(g0&&x0<=x1){g=g0,x=x0;reIndex[i0]=k;if(g0=oldGroups[++i0])x0=g0.key}else{g={key:x1,value:initial()},x=x1}groups[k]=g;while(!(x1>x)){groupIndex[j=newIndex[i1]+n0]=k;if(!(filters[j]&zero))g.value=add(g.value,data[j]);if(++i1>=n1)break;x1=key(newValues[i1])}groupIncrement()}while(i0<k0){groups[reIndex[i0]=k]=oldGroups[i0++];groupIncrement()}if(k>i0)for(i0=0;i0<n0;++i0){groupIndex[i0]=reIndex[groupIndex[i0]]}j=filterListeners.indexOf(update);if(k>1){update=updateMany;reset=resetMany}else{if(!k&&groupAll){k=1;groups=[{key:null,value:initial()}]}if(k===1){update=updateOne;reset=resetOne}else{update=crossfilter_null;reset=crossfilter_null}groupIndex=null}filterListeners[j]=update;function groupIncrement(){if(++k===groupCapacity){reIndex=crossfilter_arrayWiden(reIndex,groupWidth<<=1);groupIndex=crossfilter_arrayWiden(groupIndex,groupWidth);groupCapacity=crossfilter_capacity(groupWidth)}}}function removeData(){if(k>1){var oldK=k,oldGroups=groups,seenGroups=crossfilter_index(oldK,oldK);for(var i=0,j=0;i<n;++i){if(filters[i]){seenGroups[groupIndex[j]=groupIndex[i]]=1;++j}}groups=[],k=0;for(i=0;i<oldK;++i){if(seenGroups[i]){seenGroups[i]=k++;groups.push(oldGroups[i])}}if(k>1){for(var i=0;i<j;++i)groupIndex[i]=seenGroups[groupIndex[i]]}else{groupIndex=null}filterListeners[filterListeners.indexOf(update)]=k>1?(reset=resetMany,update=updateMany):k===1?(reset=resetOne,update=updateOne):reset=update=crossfilter_null}else if(k===1){if(groupAll)return;for(var i=0;i<n;++i)if(filters[i])return;groups=[],k=0;filterListeners[filterListeners.indexOf(update)]=update=reset=crossfilter_null}}function updateMany(filterOne,added,removed){if(filterOne===one||resetNeeded)return;var i,k,n,g;for(i=0,n=added.length;i<n;++i){if(!(filters[k=added[i]]&zero)){g=groups[groupIndex[k]];g.value=reduceAdd(g.value,data[k])}}for(i=0,n=removed.length;i<n;++i){if((filters[k=removed[i]]&zero)===filterOne){g=groups[groupIndex[k]];g.value=reduceRemove(g.value,data[k])}}}function updateOne(filterOne,added,removed){if(filterOne===one||resetNeeded)return;var i,k,n,g=groups[0];for(i=0,n=added.length;i<n;++i){if(!(filters[k=added[i]]&zero)){g.value=reduceAdd(g.value,data[k])}}for(i=0,n=removed.length;i<n;++i){if((filters[k=removed[i]]&zero)===filterOne){g.value=reduceRemove(g.value,data[k])}}}function resetMany(){var i,g;for(i=0;i<k;++i){groups[i].value=reduceInitial()}for(i=0;i<n;++i){if(!(filters[i]&zero)){g=groups[groupIndex[i]];g.value=reduceAdd(g.value,data[i])}}}function resetOne(){var i,g=groups[0];g.value=reduceInitial();for(i=0;i<n;++i){if(!(filters[i]&zero)){g.value=reduceAdd(g.value,data[i])}}}function all(){if(resetNeeded)reset(),resetNeeded=false;return groups}function top(k){var top=select(all(),0,groups.length,k);return heap.sort(top,0,top.length)}function reduce(add,remove,initial){reduceAdd=add;reduceRemove=remove;reduceInitial=initial;resetNeeded=true;return group}function reduceCount(){return reduce(crossfilter_reduceIncrement,crossfilter_reduceDecrement,crossfilter_zero)}function reduceSum(value){return reduce(crossfilter_reduceAdd(value),crossfilter_reduceSubtract(value),crossfilter_zero)}function order(value){select=heapselect_by(valueOf);heap=heap_by(valueOf);function valueOf(d){return value(d.value)}return group}function orderNatural(){return order(crossfilter_identity)}function size(){return k}function dispose(){var i=filterListeners.indexOf(update);if(i>=0)filterListeners.splice(i,1);i=indexListeners.indexOf(add);if(i>=0)indexListeners.splice(i,1);i=removeDataListeners.indexOf(removeData);if(i>=0)removeDataListeners.splice(i,1);return group}return reduceCount().orderNatural()}function groupAll(){var g=group(crossfilter_null),all=g.all;delete g.all;delete g.top;delete g.order;delete g.orderNatural;delete g.size;g.value=function(){return all()[0].value};return g}function dispose(){dimensionGroups.forEach(function(group){group.dispose()});var i=dataListeners.indexOf(preAdd);if(i>=0)dataListeners.splice(i,1);i=dataListeners.indexOf(postAdd);if(i>=0)dataListeners.splice(i,1);i=removeDataListeners.indexOf(removeData);if(i>=0)removeDataListeners.splice(i,1);m&=zero;return filterAll()}return dimension}function groupAll(){var group={reduce:reduce,reduceCount:reduceCount,reduceSum:reduceSum,value:value,dispose:dispose,remove:dispose};var reduceValue,reduceAdd,reduceRemove,reduceInitial,resetNeeded=true;filterListeners.push(update);dataListeners.push(add);add(data,0,n);function add(newData,n0){var i;if(resetNeeded)return;for(i=n0;i<n;++i){if(!filters[i]){reduceValue=reduceAdd(reduceValue,data[i])}}}function update(filterOne,added,removed){var i,k,n;if(resetNeeded)return;for(i=0,n=added.length;i<n;++i){if(!filters[k=added[i]]){reduceValue=reduceAdd(reduceValue,data[k])}}for(i=0,n=removed.length;i<n;++i){if(filters[k=removed[i]]===filterOne){reduceValue=reduceRemove(reduceValue,data[k])}}}function reset(){var i;reduceValue=reduceInitial();for(i=0;i<n;++i){if(!filters[i]){reduceValue=reduceAdd(reduceValue,data[i])}}}function reduce(add,remove,initial){reduceAdd=add;reduceRemove=remove;reduceInitial=initial;resetNeeded=true;return group}function reduceCount(){return reduce(crossfilter_reduceIncrement,crossfilter_reduceDecrement,crossfilter_zero)}function reduceSum(value){return reduce(crossfilter_reduceAdd(value),crossfilter_reduceSubtract(value),crossfilter_zero)}function value(){if(resetNeeded)reset(),resetNeeded=false;return reduceValue}function dispose(){var i=filterListeners.indexOf(update);if(i>=0)filterListeners.splice(i);i=dataListeners.indexOf(add);if(i>=0)dataListeners.splice(i);return group}return reduceCount()}function size(){return n}return arguments.length?add(arguments[0]):crossfilter}function crossfilter_index(n,m){return(m<257?crossfilter_array8:m<65537?crossfilter_array16:crossfilter_array32)(n)}function crossfilter_range(n){var range=crossfilter_index(n,n);for(var i=-1;++i<n;)range[i]=i;return range}function crossfilter_capacity(w){return w===8?256:w===16?65536:4294967296}})(typeof exports!=="undefined"&&exports||this);</script></head><body><div hidden=""><scripts><script>(function(){if(window.WebComponents){var scripts=document._currentScript.parentNode;scripts.parentNode.removeChild(scripts)}})();</script><script>if(!window.WebComponents){WebComponents={flush:function(){},flags:{log:{}}};Platform=WebComponents;CustomElements={useNative:true,ready:true,takeRecords:function(){},"instanceof":function(obj,base){return obj instanceof base}};HTMLImports={useNative:true};addEventListener("HTMLImportsLoaded",function(){document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:true}))});ShadowDOMPolyfill=null;wrap=unwrap=function(n){return n}}</script><script>window.HTMLImports=window.HTMLImports||{flags:{}};(function(scope){var IMPORT_LINK_TYPE="import";var useNative=Boolean(IMPORT_LINK_TYPE in document.createElement("link"));var hasShadowDOMPolyfill=Boolean(window.ShadowDOMPolyfill);var wrap=function(node){return hasShadowDOMPolyfill?ShadowDOMPolyfill.wrapIfNeeded(node):node};var rootDocument=wrap(document);var currentScriptDescriptor={get:function(){var script=HTMLImports.currentScript||document.currentScript||(document.readyState!=="complete"?document.scripts[document.scripts.length-1]:null);return wrap(script)},configurable:true};Object.defineProperty(document,"_currentScript",currentScriptDescriptor);Object.defineProperty(rootDocument,"_currentScript",currentScriptDescriptor);var isIE=/Trident/.test(navigator.userAgent);function whenReady(callback,doc){doc=doc||rootDocument;whenDocumentReady(function(){watchImportsLoad(callback,doc)},doc)}var requiredReadyState=isIE?"complete":"interactive";var READY_EVENT="readystatechange";function isDocumentReady(doc){return doc.readyState==="complete"||doc.readyState===requiredReadyState}function whenDocumentReady(callback,doc){if(!isDocumentReady(doc)){var checkReady=function(){if(doc.readyState==="complete"||doc.readyState===requiredReadyState){doc.removeEventListener(READY_EVENT,checkReady);whenDocumentReady(callback,doc)}};doc.addEventListener(READY_EVENT,checkReady)}else if(callback){callback()}}function markTargetLoaded(event){event.target.__loaded=true}function watchImportsLoad(callback,doc){var imports=doc.querySelectorAll("link[rel=import]");var loaded=0,l=imports.length;function checkDone(d){if(loaded==l&&callback){callback()}}function loadedImport(e){markTargetLoaded(e);loaded++;checkDone()}if(l){for(var i=0,imp;i<l&&(imp=imports[i]);i++){if(isImportLoaded(imp)){loadedImport.call(imp,{target:imp})}else{imp.addEventListener("load",loadedImport);imp.addEventListener("error",loadedImport)}}}else{checkDone()}}function isImportLoaded(link){return useNative?link.__loaded||link.import&&link.import.readyState!=="loading":link.__importParsed}if(useNative){new MutationObserver(function(mxns){for(var i=0,l=mxns.length,m;i<l&&(m=mxns[i]);i++){if(m.addedNodes){handleImports(m.addedNodes)}}}).observe(document.head,{childList:true});function handleImports(nodes){for(var i=0,l=nodes.length,n;i<l&&(n=nodes[i]);i++){if(isImport(n)){handleImport(n)}}}function isImport(element){return element.localName==="link"&&element.rel==="import"}function handleImport(element){var loaded=element.import;if(loaded){markTargetLoaded({target:element})}else{element.addEventListener("load",markTargetLoaded);element.addEventListener("error",markTargetLoaded)}}(function(){if(document.readyState==="loading"){var imports=document.querySelectorAll("link[rel=import]");for(var i=0,l=imports.length,imp;i<l&&(imp=imports[i]);i++){handleImport(imp)}}})()}whenReady(function(){HTMLImports.ready=true;HTMLImports.readyTime=(new Date).getTime();rootDocument.dispatchEvent(new CustomEvent("HTMLImportsLoaded",{bubbles:true}))});scope.IMPORT_LINK_TYPE=IMPORT_LINK_TYPE;scope.useNative=useNative;scope.rootDocument=rootDocument;scope.whenReady=whenReady;scope.isIE=isIE})(HTMLImports);</script><script>(function(scope){var style=document.createElement("style");style.textContent=""+"body {"+"transition: opacity ease-in 0.2s;"+" } \n"+"body[unresolved] {"+"opacity: 0; display: block; overflow: hidden;"+" } \n";var head=document.querySelector("head");head.insertBefore(style,head.firstChild)})(Platform);</script></scripts><script>(function(global){"use strict";var testingExposeCycleCount=global.testingExposeCycleCount;function detectObjectObserve(){if(typeof Object.observe!=="function"||typeof Array.observe!=="function"){return false}var records=[];function callback(recs){records=recs}var test={};var arr=[];Object.observe(test,callback);Array.observe(arr,callback);test.id=1;test.id=2;delete test.id;arr.push(1,2);arr.length=0;Object.deliverChangeRecords(callback);if(records.length!==5)return false;if(records[0].type!="add"||records[1].type!="update"||records[2].type!="delete"||records[3].type!="splice"||records[4].type!="splice"){return false}Object.unobserve(test,callback);Array.unobserve(arr,callback);return true}var hasObserve=detectObjectObserve();function detectEval(){if(typeof chrome!=="undefined"&&chrome.app&&chrome.app.runtime){return false}if(typeof navigator!="undefined"&&navigator.getDeviceStorage){return false}try{var f=new Function("","return true;");return f()}catch(ex){return false}}var hasEval=detectEval();function isIndex(s){return+s===s>>>0&&s!==""}function toNumber(s){return+s}function isObject(obj){return obj===Object(obj)}var numberIsNaN=global.Number.isNaN||function(value){return typeof value==="number"&&global.isNaN(value)};function areSameValue(left,right){if(left===right)return left!==0||1/left===1/right;if(numberIsNaN(left)&&numberIsNaN(right))return true;return left!==left&&right!==right}var createObject="__proto__"in{}?function(obj){return obj}:function(obj){var proto=obj.__proto__;if(!proto)return obj;var newObject=Object.create(proto);Object.getOwnPropertyNames(obj).forEach(function(name){Object.defineProperty(newObject,name,Object.getOwnPropertyDescriptor(obj,name))});return newObject};var identStart="[$_a-zA-Z]";var identPart="[$_a-zA-Z0-9]";var identRegExp=new RegExp("^"+identStart+"+"+identPart+"*"+"$");function getPathCharType(char){if(char===undefined)return"eof";var code=char.charCodeAt(0);switch(code){case 91:case 93:case 46:case 34:case 39:case 48:return char;case 95:case 36:return"ident";case 32:case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"ws"}if(97<=code&&code<=122||65<=code&&code<=90)return"ident";if(49<=code&&code<=57)return"number";return"else"}var pathStateMachine={beforePath:{ws:["beforePath"],ident:["inIdent","append"],"[":["beforeElement"],eof:["afterPath"]},inPath:{ws:["inPath"],".":["beforeIdent"],"[":["beforeElement"],eof:["afterPath"]},beforeIdent:{ws:["beforeIdent"],ident:["inIdent","append"]},inIdent:{ident:["inIdent","append"],0:["inIdent","append"],number:["inIdent","append"],ws:["inPath","push"],".":["beforeIdent","push"],"[":["beforeElement","push"],eof:["afterPath","push"]},beforeElement:{ws:["beforeElement"],0:["afterZero","append"],number:["inIndex","append"],"'":["inSingleQuote","append",""],'"':["inDoubleQuote","append",""]},afterZero:{ws:["afterElement","push"],"]":["inPath","push"]},inIndex:{0:["inIndex","append"],number:["inIndex","append"],ws:["afterElement"],"]":["inPath","push"]},inSingleQuote:{"'":["afterElement"],eof:["error"],"else":["inSingleQuote","append"]},inDoubleQuote:{'"':["afterElement"],eof:["error"],"else":["inDoubleQuote","append"]},afterElement:{ws:["afterElement"],"]":["inPath","push"]}};function noop(){}function parsePath(path){var keys=[];var index=-1;var c,newChar,key,type,transition,action,typeMap,mode="beforePath";var actions={push:function(){if(key===undefined)return;keys.push(key);key=undefined},append:function(){if(key===undefined)key=newChar;else key+=newChar}};function maybeUnescapeQuote(){if(index>=path.length)return;var nextChar=path[index+1];if(mode=="inSingleQuote"&&nextChar=="'"||mode=="inDoubleQuote"&&nextChar=='"'){index++;newChar=nextChar;actions.append();return true}}while(mode){index++;c=path[index];if(c=="\\"&&maybeUnescapeQuote(mode))continue;type=getPathCharType(c);typeMap=pathStateMachine[mode];transition=typeMap[type]||typeMap["else"]||"error";if(transition=="error")return;mode=transition[0];action=actions[transition[1]]||noop;newChar=transition[2]===undefined?c:transition[2];action();if(mode==="afterPath"){return keys}}return}function isIdent(s){return identRegExp.test(s)}var constructorIsPrivate={};function Path(parts,privateToken){if(privateToken!==constructorIsPrivate)throw Error("Use Path.get to retrieve path objects");for(var i=0;i<parts.length;i++){this.push(String(parts[i]))}if(hasEval&&this.length){this.getValueFrom=this.compiledGetValueFromFn()}}var pathCache={};function getPath(pathString){if(pathString instanceof Path)return pathString;if(pathString==null||pathString.length==0)pathString="";if(typeof pathString!="string"){if(isIndex(pathString.length)){return new Path(pathString,constructorIsPrivate)}pathString=String(pathString)}var path=pathCache[pathString];if(path)return path;var parts=parsePath(pathString);if(!parts)return invalidPath;var path=new Path(parts,constructorIsPrivate);pathCache[pathString]=path;return path}Path.get=getPath;function formatAccessor(key){if(isIndex(key)){return"["+key+"]"}else{return'["'+key.replace(/"/g,'\\"')+'"]'}}Path.prototype=createObject({__proto__:[],valid:true,toString:function(){var pathString="";for(var i=0;i<this.length;i++){var key=this[i];if(isIdent(key)){pathString+=i?"."+key:key}else{pathString+=formatAccessor(key)}}return pathString},getValueFrom:function(obj,directObserver){for(var i=0;i<this.length;i++){if(obj==null)return;obj=obj[this[i]]}return obj},iterateObjects:function(obj,observe){for(var i=0;i<this.length;i++){if(i)obj=obj[this[i-1]];if(!isObject(obj))return;observe(obj,this[i])}},compiledGetValueFromFn:function(){var str="";var pathString="obj";str+="if (obj != null";var i=0;var key;for(;i<this.length-1;i++){key=this[i];pathString+=isIdent(key)?"."+key:formatAccessor(key);str+=" &&\n     "+pathString+" != null"}str+=")\n";var key=this[i];pathString+=isIdent(key)?"."+key:formatAccessor(key);str+="  return "+pathString+";\nelse\n  return undefined;";return new Function("obj",str)},setValueFrom:function(obj,value){if(!this.length)return false;for(var i=0;i<this.length-1;i++){if(!isObject(obj))return false;obj=obj[this[i]]}if(!isObject(obj))return false;obj[this[i]]=value;return true}});var invalidPath=new Path("",constructorIsPrivate);invalidPath.valid=false;invalidPath.getValueFrom=invalidPath.setValueFrom=function(){};var MAX_DIRTY_CHECK_CYCLES=1e3;function dirtyCheck(observer){var cycles=0;while(cycles<MAX_DIRTY_CHECK_CYCLES&&observer.check_()){cycles++}if(testingExposeCycleCount)global.dirtyCheckCycleCount=cycles;return cycles>0}function objectIsEmpty(object){for(var prop in object)return false;return true}function diffIsEmpty(diff){return objectIsEmpty(diff.added)&&objectIsEmpty(diff.removed)&&objectIsEmpty(diff.changed)}function diffObjectFromOldObject(object,oldObject){var added={};var removed={};var changed={};for(var prop in oldObject){var newValue=object[prop];if(newValue!==undefined&&newValue===oldObject[prop])continue;if(!(prop in object)){removed[prop]=undefined;continue}if(newValue!==oldObject[prop])changed[prop]=newValue}for(var prop in object){if(prop in oldObject)continue;added[prop]=object[prop]}if(Array.isArray(object)&&object.length!==oldObject.length)changed.length=object.length;return{added:added,removed:removed,changed:changed}}var eomTasks=[];function runEOMTasks(){if(!eomTasks.length)return false;for(var i=0;i<eomTasks.length;i++){eomTasks[i]()}eomTasks.length=0;return true}var runEOM=hasObserve?function(){return function(fn){return Promise.resolve().then(fn)}}():function(){return function(fn){eomTasks.push(fn)}}();var observedObjectCache=[];function newObservedObject(){var observer;var object;var discardRecords=false;var first=true;function callback(records){if(observer&&observer.state_===OPENED&&!discardRecords)observer.check_(records)}return{open:function(obs){if(observer)throw Error("ObservedObject in use");if(!first)Object.deliverChangeRecords(callback);observer=obs;first=false},observe:function(obj,arrayObserve){object=obj;if(arrayObserve)Array.observe(object,callback);else Object.observe(object,callback)},deliver:function(discard){discardRecords=discard;Object.deliverChangeRecords(callback);discardRecords=false},close:function(){observer=undefined;Object.unobserve(object,callback);observedObjectCache.push(this)}}}function getObservedObject(observer,object,arrayObserve){var dir=observedObjectCache.pop()||newObservedObject();dir.open(observer);dir.observe(object,arrayObserve);return dir}var observedSetCache=[];function newObservedSet(){var observerCount=0;var observers=[];var objects=[];var rootObj;var rootObjProps;function observe(obj,prop){if(!obj)return;if(obj===rootObj)rootObjProps[prop]=true;if(objects.indexOf(obj)<0){objects.push(obj);Object.observe(obj,callback)}observe(Object.getPrototypeOf(obj),prop)}function allRootObjNonObservedProps(recs){for(var i=0;i<recs.length;i++){var rec=recs[i];if(rec.object!==rootObj||rootObjProps[rec.name]||rec.type==="setPrototype"){return false}}return true}function callback(recs){if(allRootObjNonObservedProps(recs))return;var observer;for(var i=0;i<observers.length;i++){observer=observers[i];if(observer.state_==OPENED){observer.iterateObjects_(observe)}}for(var i=0;i<observers.length;i++){observer=observers[i];if(observer.state_==OPENED){observer.check_()}}}var record={objects:objects,get rootObject(){return rootObj},set rootObject(value){rootObj=value;rootObjProps={}},open:function(obs,object){observers.push(obs);observerCount++;obs.iterateObjects_(observe)},close:function(obs){observerCount--;if(observerCount>0){return}for(var i=0;i<objects.length;i++){Object.unobserve(objects[i],callback);Observer.unobservedCount++}observers.length=0;objects.length=0;rootObj=undefined;rootObjProps=undefined;observedSetCache.push(this);if(lastObservedSet===this)lastObservedSet=null}};return record}var lastObservedSet;function getObservedSet(observer,obj){if(!lastObservedSet||lastObservedSet.rootObject!==obj){lastObservedSet=observedSetCache.pop()||newObservedSet();lastObservedSet.rootObject=obj}lastObservedSet.open(observer,obj);return lastObservedSet}var UNOPENED=0;var OPENED=1;var CLOSED=2;var RESETTING=3;var nextObserverId=1;function Observer(){this.state_=UNOPENED;this.callback_=undefined;this.target_=undefined;this.directObserver_=undefined;this.value_=undefined;this.id_=nextObserverId++}Observer.prototype={open:function(callback,target){if(this.state_!=UNOPENED)throw Error("Observer has already been opened.");addToAll(this);this.callback_=callback;this.target_=target;this.connect_();this.state_=OPENED;return this.value_},close:function(){if(this.state_!=OPENED)return;removeFromAll(this);this.disconnect_();this.value_=undefined;this.callback_=undefined;this.target_=undefined;this.state_=CLOSED},deliver:function(){if(this.state_!=OPENED)return;dirtyCheck(this)},report_:function(changes){try{this.callback_.apply(this.target_,changes)}catch(ex){Observer._errorThrownDuringCallback=true;console.error("Exception caught during observer callback: "+(ex.stack||ex))}},discardChanges:function(){this.check_(undefined,true);return this.value_}};var collectObservers=!hasObserve;var allObservers;Observer._allObserversCount=0;if(collectObservers){allObservers=[]}function addToAll(observer){Observer._allObserversCount++;if(!collectObservers)return;allObservers.push(observer)}function removeFromAll(observer){Observer._allObserversCount--}var runningMicrotaskCheckpoint=false;global.Platform=global.Platform||{};global.Platform.performMicrotaskCheckpoint=function(){if(runningMicrotaskCheckpoint)return;if(!collectObservers)return;runningMicrotaskCheckpoint=true;var cycles=0;var anyChanged,toCheck;do{cycles++;toCheck=allObservers;allObservers=[];anyChanged=false;for(var i=0;i<toCheck.length;i++){var observer=toCheck[i];if(observer.state_!=OPENED)continue;if(observer.check_())anyChanged=true;allObservers.push(observer)}if(runEOMTasks())anyChanged=true}while(cycles<MAX_DIRTY_CHECK_CYCLES&&anyChanged);if(testingExposeCycleCount)global.dirtyCheckCycleCount=cycles;runningMicrotaskCheckpoint=false};if(collectObservers){global.Platform.clearObservers=function(){allObservers=[]}}function ObjectObserver(object){Observer.call(this);this.value_=object;this.oldObject_=undefined}ObjectObserver.prototype=createObject({__proto__:Observer.prototype,arrayObserve:false,connect_:function(callback,target){if(hasObserve){this.directObserver_=getObservedObject(this,this.value_,this.arrayObserve)}else{this.oldObject_=this.copyObject(this.value_)}},copyObject:function(object){var copy=Array.isArray(object)?[]:{};for(var prop in object){copy[prop]=object[prop]}if(Array.isArray(object))copy.length=object.length;return copy},check_:function(changeRecords,skipChanges){var diff;var oldValues;if(hasObserve){if(!changeRecords)return false;oldValues={};diff=diffObjectFromChangeRecords(this.value_,changeRecords,oldValues)}else{oldValues=this.oldObject_;diff=diffObjectFromOldObject(this.value_,this.oldObject_)}if(diffIsEmpty(diff))return false;if(!hasObserve)this.oldObject_=this.copyObject(this.value_);this.report_([diff.added||{},diff.removed||{},diff.changed||{},function(property){return oldValues[property]}]);return true},disconnect_:function(){if(hasObserve){this.directObserver_.close();this.directObserver_=undefined}else{this.oldObject_=undefined}},deliver:function(){if(this.state_!=OPENED)return;if(hasObserve)this.directObserver_.deliver(false);else dirtyCheck(this)},discardChanges:function(){if(this.directObserver_)this.directObserver_.deliver(true);else this.oldObject_=this.copyObject(this.value_);return this.value_}});function ArrayObserver(array){if(!Array.isArray(array))throw Error("Provided object is not an Array");ObjectObserver.call(this,array)}ArrayObserver.prototype=createObject({__proto__:ObjectObserver.prototype,arrayObserve:true,copyObject:function(arr){return arr.slice()},check_:function(changeRecords){var splices;if(hasObserve){if(!changeRecords)return false;splices=projectArraySplices(this.value_,changeRecords)}else{splices=calcSplices(this.value_,0,this.value_.length,this.oldObject_,0,this.oldObject_.length)}if(!splices||!splices.length)return false;if(!hasObserve)this.oldObject_=this.copyObject(this.value_);this.report_([splices]);return true}});ArrayObserver.applySplices=function(previous,current,splices){splices.forEach(function(splice){var spliceArgs=[splice.index,splice.removed.length];var addIndex=splice.index;while(addIndex<splice.index+splice.addedCount){spliceArgs.push(current[addIndex]);addIndex++}Array.prototype.splice.apply(previous,spliceArgs)})};function PathObserver(object,path){Observer.call(this);this.object_=object;this.path_=getPath(path);this.directObserver_=undefined}PathObserver.prototype=createObject({__proto__:Observer.prototype,get path(){return this.path_},connect_:function(){if(hasObserve)this.directObserver_=getObservedSet(this,this.object_);this.check_(undefined,true)},disconnect_:function(){this.value_=undefined;if(this.directObserver_){this.directObserver_.close(this);this.directObserver_=undefined}},iterateObjects_:function(observe){this.path_.iterateObjects(this.object_,observe)},check_:function(changeRecords,skipChanges){var oldValue=this.value_;this.value_=this.path_.getValueFrom(this.object_);if(skipChanges||areSameValue(this.value_,oldValue))return false;this.report_([this.value_,oldValue,this]);return true},setValue:function(newValue){if(this.path_)this.path_.setValueFrom(this.object_,newValue)}});function CompoundObserver(reportChangesOnOpen){Observer.call(this);this.reportChangesOnOpen_=reportChangesOnOpen;this.value_=[];this.directObserver_=undefined;this.observed_=[]}var observerSentinel={};CompoundObserver.prototype=createObject({__proto__:Observer.prototype,connect_:function(){if(hasObserve){var object;var needsDirectObserver=false;for(var i=0;i<this.observed_.length;i+=2){object=this.observed_[i];if(object!==observerSentinel){needsDirectObserver=true;break}}if(needsDirectObserver)this.directObserver_=getObservedSet(this,object)}this.check_(undefined,!this.reportChangesOnOpen_)},disconnect_:function(){for(var i=0;i<this.observed_.length;i+=2){if(this.observed_[i]===observerSentinel)this.observed_[i+1].close()}this.observed_.length=0;this.value_.length=0;if(this.directObserver_){this.directObserver_.close(this);this.directObserver_=undefined}},addPath:function(object,path){if(this.state_!=UNOPENED&&this.state_!=RESETTING)throw Error("Cannot add paths once started.");var path=getPath(path);this.observed_.push(object,path);if(!this.reportChangesOnOpen_)return;var index=this.observed_.length/2-1;this.value_[index]=path.getValueFrom(object)},addObserver:function(observer){if(this.state_!=UNOPENED&&this.state_!=RESETTING)throw Error("Cannot add observers once started.");this.observed_.push(observerSentinel,observer);if(!this.reportChangesOnOpen_)return;var index=this.observed_.length/2-1;this.value_[index]=observer.open(this.deliver,this)},startReset:function(){if(this.state_!=OPENED)throw Error("Can only reset while open");this.state_=RESETTING;this.disconnect_()},finishReset:function(){if(this.state_!=RESETTING)throw Error("Can only finishReset after startReset");this.state_=OPENED;this.connect_();return this.value_},iterateObjects_:function(observe){var object;for(var i=0;i<this.observed_.length;i+=2){object=this.observed_[i];if(object!==observerSentinel)this.observed_[i+1].iterateObjects(object,observe)}},check_:function(changeRecords,skipChanges){var oldValues;for(var i=0;i<this.observed_.length;i+=2){var object=this.observed_[i];var path=this.observed_[i+1];var value;if(object===observerSentinel){var observable=path;value=this.state_===UNOPENED?observable.open(this.deliver,this):observable.discardChanges()}else{value=path.getValueFrom(object)}if(skipChanges){this.value_[i/2]=value;continue}if(areSameValue(value,this.value_[i/2]))continue;oldValues=oldValues||[];oldValues[i/2]=this.value_[i/2];this.value_[i/2]=value}if(!oldValues)return false;this.report_([this.value_,oldValues,this.observed_]);return true}});function identFn(value){return value}function ObserverTransform(observable,getValueFn,setValueFn,dontPassThroughSet){this.callback_=undefined;this.target_=undefined;this.value_=undefined;this.observable_=observable;this.getValueFn_=getValueFn||identFn;this.setValueFn_=setValueFn||identFn;this.dontPassThroughSet_=dontPassThroughSet}ObserverTransform.prototype={open:function(callback,target){this.callback_=callback;this.target_=target;this.value_=this.getValueFn_(this.observable_.open(this.observedCallback_,this));return this.value_},observedCallback_:function(value){value=this.getValueFn_(value);if(areSameValue(value,this.value_))return;var oldValue=this.value_;this.value_=value;this.callback_.call(this.target_,this.value_,oldValue)},discardChanges:function(){this.value_=this.getValueFn_(this.observable_.discardChanges());return this.value_},deliver:function(){return this.observable_.deliver()},setValue:function(value){value=this.setValueFn_(value);if(!this.dontPassThroughSet_&&this.observable_.setValue)return this.observable_.setValue(value)},close:function(){if(this.observable_)this.observable_.close();this.callback_=undefined;this.target_=undefined;this.observable_=undefined;this.value_=undefined;this.getValueFn_=undefined;this.setValueFn_=undefined}};var expectedRecordTypes={add:true,update:true,"delete":true};function diffObjectFromChangeRecords(object,changeRecords,oldValues){var added={};var removed={};for(var i=0;i<changeRecords.length;i++){var record=changeRecords[i];if(!expectedRecordTypes[record.type]){console.error("Unknown changeRecord type: "+record.type);console.error(record);continue}if(!(record.name in oldValues))oldValues[record.name]=record.oldValue;if(record.type=="update")continue;if(record.type=="add"){if(record.name in removed)delete removed[record.name];else added[record.name]=true;continue}if(record.name in added){delete added[record.name];delete oldValues[record.name]}else{removed[record.name]=true}}for(var prop in added)added[prop]=object[prop];for(var prop in removed)removed[prop]=undefined;var changed={};for(var prop in oldValues){if(prop in added||prop in removed)continue;var newValue=object[prop];if(oldValues[prop]!==newValue)changed[prop]=newValue}return{added:added,removed:removed,changed:changed}}function newSplice(index,removed,addedCount){return{index:index,removed:removed,addedCount:addedCount}}var EDIT_LEAVE=0;var EDIT_UPDATE=1;var EDIT_ADD=2;var EDIT_DELETE=3;function ArraySplice(){}ArraySplice.prototype={calcEditDistances:function(current,currentStart,currentEnd,old,oldStart,oldEnd){var rowCount=oldEnd-oldStart+1;var columnCount=currentEnd-currentStart+1;var distances=new Array(rowCount);for(var i=0;i<rowCount;i++){distances[i]=new Array(columnCount);distances[i][0]=i}for(var j=0;j<columnCount;j++)distances[0][j]=j;for(var i=1;i<rowCount;i++){for(var j=1;j<columnCount;j++){if(this.equals(current[currentStart+j-1],old[oldStart+i-1]))distances[i][j]=distances[i-1][j-1];else{var north=distances[i-1][j]+1;var west=distances[i][j-1]+1;distances[i][j]=north<west?north:west}}}return distances},spliceOperationsFromEditDistances:function(distances){var i=distances.length-1;var j=distances[0].length-1;var current=distances[i][j];var edits=[];while(i>0||j>0){if(i==0){edits.push(EDIT_ADD);j--;continue}if(j==0){edits.push(EDIT_DELETE);i--;continue}var northWest=distances[i-1][j-1];var west=distances[i-1][j];var north=distances[i][j-1];var min;if(west<north)min=west<northWest?west:northWest;else min=north<northWest?north:northWest;if(min==northWest){if(northWest==current){edits.push(EDIT_LEAVE)}else{edits.push(EDIT_UPDATE);current=northWest}i--;j--}else if(min==west){edits.push(EDIT_DELETE);i--;current=west}else{edits.push(EDIT_ADD);j--;current=north}}edits.reverse();return edits},calcSplices:function(current,currentStart,currentEnd,old,oldStart,oldEnd){var prefixCount=0;var suffixCount=0;var minLength=Math.min(currentEnd-currentStart,oldEnd-oldStart);if(currentStart==0&&oldStart==0)prefixCount=this.sharedPrefix(current,old,minLength);if(currentEnd==current.length&&oldEnd==old.length)suffixCount=this.sharedSuffix(current,old,minLength-prefixCount);currentStart+=prefixCount;oldStart+=prefixCount;currentEnd-=suffixCount;oldEnd-=suffixCount;if(currentEnd-currentStart==0&&oldEnd-oldStart==0)return[];if(currentStart==currentEnd){var splice=newSplice(currentStart,[],0);while(oldStart<oldEnd)splice.removed.push(old[oldStart++]);return[splice]}else if(oldStart==oldEnd)return[newSplice(currentStart,[],currentEnd-currentStart)];var ops=this.spliceOperationsFromEditDistances(this.calcEditDistances(current,currentStart,currentEnd,old,oldStart,oldEnd));var splice=undefined;var splices=[];var index=currentStart;var oldIndex=oldStart;for(var i=0;i<ops.length;i++){switch(ops[i]){case EDIT_LEAVE:if(splice){splices.push(splice);splice=undefined}index++;oldIndex++;break;case EDIT_UPDATE:if(!splice)splice=newSplice(index,[],0);splice.addedCount++;index++;splice.removed.push(old[oldIndex]);oldIndex++;break;case EDIT_ADD:if(!splice)splice=newSplice(index,[],0);splice.addedCount++;index++;break;case EDIT_DELETE:if(!splice)splice=newSplice(index,[],0);splice.removed.push(old[oldIndex]);oldIndex++;break}}if(splice){splices.push(splice)}return splices},sharedPrefix:function(current,old,searchLength){for(var i=0;i<searchLength;i++)if(!this.equals(current[i],old[i]))return i;return searchLength},sharedSuffix:function(current,old,searchLength){var index1=current.length;var index2=old.length;var count=0;while(count<searchLength&&this.equals(current[--index1],old[--index2]))count++;return count},calculateSplices:function(current,previous){return this.calcSplices(current,0,current.length,previous,0,previous.length)},equals:function(currentValue,previousValue){return currentValue===previousValue}};var arraySplice=new ArraySplice;function calcSplices(current,currentStart,currentEnd,old,oldStart,oldEnd){return arraySplice.calcSplices(current,currentStart,currentEnd,old,oldStart,oldEnd)}function intersect(start1,end1,start2,end2){if(end1<start2||end2<start1)return-1;if(end1==start2||end2==start1)return 0;if(start1<start2){if(end1<end2)return end1-start2;else return end2-start2}else{if(end2<end1)return end2-start1;else return end1-start1}}function mergeSplice(splices,index,removed,addedCount){var splice=newSplice(index,removed,addedCount);var inserted=false;var insertionOffset=0;for(var i=0;i<splices.length;i++){var current=splices[i];current.index+=insertionOffset;if(inserted)continue;var intersectCount=intersect(splice.index,splice.index+splice.removed.length,current.index,current.index+current.addedCount);if(intersectCount>=0){splices.splice(i,1);i--;insertionOffset-=current.addedCount-current.removed.length;splice.addedCount+=current.addedCount-intersectCount;var deleteCount=splice.removed.length+current.removed.length-intersectCount;if(!splice.addedCount&&!deleteCount){inserted=true}else{var removed=current.removed;if(splice.index<current.index){var prepend=splice.removed.slice(0,current.index-splice.index);Array.prototype.push.apply(prepend,removed);removed=prepend}if(splice.index+splice.removed.length>current.index+current.addedCount){var append=splice.removed.slice(current.index+current.addedCount-splice.index);Array.prototype.push.apply(removed,append)}splice.removed=removed;if(current.index<splice.index){splice.index=current.index}}}else if(splice.index<current.index){inserted=true;splices.splice(i,0,splice);i++;var offset=splice.addedCount-splice.removed.length;current.index+=offset;insertionOffset+=offset}}if(!inserted)splices.push(splice)}function createInitialSplices(array,changeRecords){var splices=[];for(var i=0;i<changeRecords.length;i++){var record=changeRecords[i];switch(record.type){case"splice":mergeSplice(splices,record.index,record.removed.slice(),record.addedCount);break;case"add":case"update":case"delete":if(!isIndex(record.name))continue;var index=toNumber(record.name);if(index<0)continue;mergeSplice(splices,index,[record.oldValue],1);break;default:console.error("Unexpected record type: "+JSON.stringify(record));break}}return splices}function projectArraySplices(array,changeRecords){var splices=[];createInitialSplices(array,changeRecords).forEach(function(splice){if(splice.addedCount==1&&splice.removed.length==1){if(splice.removed[0]!==array[splice.index])splices.push(splice);return}splices=splices.concat(calcSplices(array,splice.index,splice.index+splice.addedCount,splice.removed,0,splice.removed.length))});return splices}var expose=global;if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){expose=exports=module.exports}expose=exports}expose.Observer=Observer;expose.Observer.runEOM_=runEOM;expose.Observer.observerSentinel_=observerSentinel;expose.Observer.hasObjectObserve=hasObserve;expose.ArrayObserver=ArrayObserver;expose.ArrayObserver.calculateSplices=function(current,previous){return arraySplice.calculateSplices(current,previous)};expose.ArraySplice=ArraySplice;expose.ObjectObserver=ObjectObserver;expose.PathObserver=PathObserver;expose.CompoundObserver=CompoundObserver;expose.Path=Path;expose.ObserverTransform=ObserverTransform})(typeof global!=="undefined"&&global&&typeof module!=="undefined"&&module?global:this||window);</script><script>(function(global){"use strict";var filter=Array.prototype.filter.call.bind(Array.prototype.filter);function getTreeScope(node){while(node.parentNode){node=node.parentNode}return typeof node.getElementById==="function"?node:null}Node.prototype.bind=function(name,observable){console.error("Unhandled binding to Node: ",this,name,observable)};Node.prototype.bindFinished=function(){};function updateBindings(node,name,binding){var bindings=node.bindings_;if(!bindings)bindings=node.bindings_={};if(bindings[name])binding[name].close();return bindings[name]=binding}function returnBinding(node,name,binding){return binding}function sanitizeValue(value){return value==null?"":value}function updateText(node,value){node.data=sanitizeValue(value)}function textBinding(node){return function(value){return updateText(node,value)}}var maybeUpdateBindings=returnBinding;Object.defineProperty(Platform,"enableBindingsReflection",{get:function(){return maybeUpdateBindings===updateBindings},set:function(enable){maybeUpdateBindings=enable?updateBindings:returnBinding;return enable},configurable:true});Text.prototype.bind=function(name,value,oneTime){if(name!=="textContent")return Node.prototype.bind.call(this,name,value,oneTime);if(oneTime)return updateText(this,value);var observable=value;updateText(this,observable.open(textBinding(this)));return maybeUpdateBindings(this,name,observable)};function updateAttribute(el,name,conditional,value){if(conditional){if(value)el.setAttribute(name,"");else el.removeAttribute(name);return}el.setAttribute(name,sanitizeValue(value))}function attributeBinding(el,name,conditional){return function(value){updateAttribute(el,name,conditional,value)}}Element.prototype.bind=function(name,value,oneTime){var conditional=name[name.length-1]=="?";if(conditional){this.removeAttribute(name);name=name.slice(0,-1)}if(oneTime)return updateAttribute(this,name,conditional,value);var observable=value;updateAttribute(this,name,conditional,observable.open(attributeBinding(this,name,conditional)));return maybeUpdateBindings(this,name,observable)};var checkboxEventType;(function(){var div=document.createElement("div");var checkbox=div.appendChild(document.createElement("input"));checkbox.setAttribute("type","checkbox");var first;var count=0;checkbox.addEventListener("click",function(e){count++;first=first||"click"});checkbox.addEventListener("change",function(){count++;first=first||"change"});var event=document.createEvent("MouseEvent");event.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);checkbox.dispatchEvent(event);checkboxEventType=count==1?"change":first})();function getEventForInputType(element){switch(element.type){case"checkbox":return checkboxEventType;case"radio":case"select-multiple":case"select-one":return"change";case"range":if(/Trident|MSIE/.test(navigator.userAgent))return"change";default:return"input"}}function updateInput(input,property,value,santizeFn){input[property]=(santizeFn||sanitizeValue)(value)}function inputBinding(input,property,santizeFn){return function(value){return updateInput(input,property,value,santizeFn)}}function noop(){}function bindInputEvent(input,property,observable,postEventFn){var eventType=getEventForInputType(input);function eventHandler(){observable.setValue(input[property]);observable.discardChanges();(postEventFn||noop)(input);Platform.performMicrotaskCheckpoint()}input.addEventListener(eventType,eventHandler);return{close:function(){input.removeEventListener(eventType,eventHandler);observable.close()},observable_:observable}}function booleanSanitize(value){return Boolean(value)}function getAssociatedRadioButtons(element){if(element.form){return filter(element.form.elements,function(el){return el!=element&&el.tagName=="INPUT"&&el.type=="radio"&&el.name==element.name})}else{var treeScope=getTreeScope(element);if(!treeScope)return[];var radios=treeScope.querySelectorAll('input[type="radio"][name="'+element.name+'"]');return filter(radios,function(el){return el!=element&&!el.form})}}function checkedPostEvent(input){if(input.tagName==="INPUT"&&input.type==="radio"){getAssociatedRadioButtons(input).forEach(function(radio){var checkedBinding=radio.bindings_.checked;if(checkedBinding){checkedBinding.observable_.setValue(false)}})}}HTMLInputElement.prototype.bind=function(name,value,oneTime){if(name!=="value"&&name!=="checked")return HTMLElement.prototype.bind.call(this,name,value,oneTime);this.removeAttribute(name);var sanitizeFn=name=="checked"?booleanSanitize:sanitizeValue;var postEventFn=name=="checked"?checkedPostEvent:noop;if(oneTime)return updateInput(this,name,value,sanitizeFn);var observable=value;var binding=bindInputEvent(this,name,observable,postEventFn);updateInput(this,name,observable.open(inputBinding(this,name,sanitizeFn)),sanitizeFn);return updateBindings(this,name,binding)};HTMLTextAreaElement.prototype.bind=function(name,value,oneTime){if(name!=="value")return HTMLElement.prototype.bind.call(this,name,value,oneTime);this.removeAttribute("value");if(oneTime)return updateInput(this,"value",value);var observable=value;var binding=bindInputEvent(this,"value",observable);updateInput(this,"value",observable.open(inputBinding(this,"value",sanitizeValue)));return maybeUpdateBindings(this,name,binding)};function updateOption(option,value){var parentNode=option.parentNode;var select;var selectBinding;var oldValue;if(parentNode instanceof HTMLSelectElement&&parentNode.bindings_&&parentNode.bindings_.value){select=parentNode;selectBinding=select.bindings_.value;oldValue=select.value}option.value=sanitizeValue(value);if(select&&select.value!=oldValue){selectBinding.observable_.setValue(select.value);selectBinding.observable_.discardChanges();Platform.performMicrotaskCheckpoint()}}function optionBinding(option){return function(value){updateOption(option,value)}}HTMLOptionElement.prototype.bind=function(name,value,oneTime){if(name!=="value")return HTMLElement.prototype.bind.call(this,name,value,oneTime);this.removeAttribute("value");if(oneTime)return updateOption(this,value);var observable=value;var binding=bindInputEvent(this,"value",observable);updateOption(this,observable.open(optionBinding(this)));return maybeUpdateBindings(this,name,binding)};HTMLSelectElement.prototype.bind=function(name,value,oneTime){if(name==="selectedindex")name="selectedIndex";if(name!=="selectedIndex"&&name!=="value")return HTMLElement.prototype.bind.call(this,name,value,oneTime);this.removeAttribute(name);if(oneTime)return updateInput(this,name,value);var observable=value;var binding=bindInputEvent(this,name,observable);updateInput(this,name,observable.open(inputBinding(this,name)));return updateBindings(this,name,binding)}})(this);</script><script>(function(global){"use strict";function assert(v){if(!v)throw new Error("Assertion failed")}var forEach=Array.prototype.forEach.call.bind(Array.prototype.forEach);function getFragmentRoot(node){var p;while(p=node.parentNode){node=p}return node}function searchRefId(node,id){if(!id)return;var ref;var selector="#"+id;while(!ref){node=getFragmentRoot(node);if(node.protoContent_)ref=node.protoContent_.querySelector(selector);else if(node.getElementById)ref=node.getElementById(id);if(ref||!node.templateCreator_)break;node=node.templateCreator_}return ref}function getInstanceRoot(node){while(node.parentNode){node=node.parentNode}return node.templateCreator_?node:null}var Map;if(global.Map&&typeof global.Map.prototype.forEach==="function"){Map=global.Map}else{Map=function(){this.keys=[];this.values=[]};Map.prototype={set:function(key,value){var index=this.keys.indexOf(key);if(index<0){this.keys.push(key);this.values.push(value)}else{this.values[index]=value}},get:function(key){var index=this.keys.indexOf(key);if(index<0)return;return this.values[index]},"delete":function(key,value){var index=this.keys.indexOf(key);if(index<0)return false;this.keys.splice(index,1);this.values.splice(index,1);return true},forEach:function(f,opt_this){for(var i=0;i<this.keys.length;i++)f.call(opt_this||this,this.values[i],this.keys[i],this)}}}var createObject="__proto__"in{}?function(obj){return obj}:function(obj){var proto=obj.__proto__;if(!proto)return obj;var newObject=Object.create(proto);Object.getOwnPropertyNames(obj).forEach(function(name){Object.defineProperty(newObject,name,Object.getOwnPropertyDescriptor(obj,name))});return newObject};if(typeof document.contains!="function"){Document.prototype.contains=function(node){if(node===this||node.parentNode===this)return true;return this.documentElement.contains(node)}}var BIND="bind";var REPEAT="repeat";var IF="if";var templateAttributeDirectives={template:true,repeat:true,bind:true,ref:true};var semanticTemplateElements={THEAD:true,TBODY:true,TFOOT:true,TH:true,TR:true,TD:true,COLGROUP:true,COL:true,CAPTION:true,OPTION:true,OPTGROUP:true};var hasTemplateElement=typeof HTMLTemplateElement!=="undefined";if(hasTemplateElement){(function(){var t=document.createElement("template");var d=t.content.ownerDocument;var html=d.appendChild(d.createElement("html"));var head=html.appendChild(d.createElement("head"));var base=d.createElement("base");base.href=document.baseURI;head.appendChild(base)})()}var allTemplatesSelectors="template, "+Object.keys(semanticTemplateElements).map(function(tagName){return tagName.toLowerCase()+"[template]"}).join(", ");function isSVGTemplate(el){return el.tagName=="template"&&el.namespaceURI=="http://www.w3.org/2000/svg"}function isHTMLTemplate(el){return el.tagName=="TEMPLATE"&&el.namespaceURI=="http://www.w3.org/1999/xhtml"}function isAttributeTemplate(el){return Boolean(semanticTemplateElements[el.tagName]&&el.hasAttribute("template"))}function isTemplate(el){if(el.isTemplate_===undefined)el.isTemplate_=el.tagName=="TEMPLATE"||isAttributeTemplate(el);return el.isTemplate_}document.addEventListener("DOMContentLoaded",function(e){bootstrapTemplatesRecursivelyFrom(document);Platform.performMicrotaskCheckpoint()},false);function forAllTemplatesFrom(node,fn){var subTemplates=node.querySelectorAll(allTemplatesSelectors);if(isTemplate(node))fn(node);forEach(subTemplates,fn)}function bootstrapTemplatesRecursivelyFrom(node){function bootstrap(template){if(!HTMLTemplateElement.decorate(template))bootstrapTemplatesRecursivelyFrom(template.content)}forAllTemplatesFrom(node,bootstrap)}if(!hasTemplateElement){global.HTMLTemplateElement=function(){throw TypeError("Illegal constructor")}}var hasProto="__proto__"in{};function mixin(to,from){Object.getOwnPropertyNames(from).forEach(function(name){Object.defineProperty(to,name,Object.getOwnPropertyDescriptor(from,name))})}function getOrCreateTemplateContentsOwner(template){var doc=template.ownerDocument;if(!doc.defaultView)return doc;var d=doc.templateContentsOwner_;if(!d){d=doc.implementation.createHTMLDocument("");while(d.lastChild){d.removeChild(d.lastChild)}doc.templateContentsOwner_=d}return d}function getTemplateStagingDocument(template){if(!template.stagingDocument_){var owner=template.ownerDocument;if(!owner.stagingDocument_){owner.stagingDocument_=owner.implementation.createHTMLDocument("");owner.stagingDocument_.isStagingDocument=true;var base=owner.stagingDocument_.createElement("base");base.href=document.baseURI;owner.stagingDocument_.head.appendChild(base);owner.stagingDocument_.stagingDocument_=owner.stagingDocument_}template.stagingDocument_=owner.stagingDocument_}return template.stagingDocument_}function extractTemplateFromAttributeTemplate(el){var template=el.ownerDocument.createElement("template");el.parentNode.insertBefore(template,el);var attribs=el.attributes;var count=attribs.length;while(count-->0){var attrib=attribs[count];if(templateAttributeDirectives[attrib.name]){if(attrib.name!=="template")template.setAttribute(attrib.name,attrib.value);el.removeAttribute(attrib.name)}}return template}function extractTemplateFromSVGTemplate(el){var template=el.ownerDocument.createElement("template");el.parentNode.insertBefore(template,el);var attribs=el.attributes;var count=attribs.length;while(count-->0){var attrib=attribs[count];template.setAttribute(attrib.name,attrib.value);el.removeAttribute(attrib.name)}el.parentNode.removeChild(el);return template}function liftNonNativeTemplateChildrenIntoContent(template,el,useRoot){var content=template.content;if(useRoot){content.appendChild(el);return}var child;while(child=el.firstChild){content.appendChild(child)}}var templateObserver;if(typeof MutationObserver=="function"){templateObserver=new MutationObserver(function(records){for(var i=0;i<records.length;i++){records[i].target.refChanged_()}})}HTMLTemplateElement.decorate=function(el,opt_instanceRef){if(el.templateIsDecorated_)return false;var templateElement=el;templateElement.templateIsDecorated_=true;var isNativeHTMLTemplate=isHTMLTemplate(templateElement)&&hasTemplateElement;var bootstrapContents=isNativeHTMLTemplate;var liftContents=!isNativeHTMLTemplate;var liftRoot=false;if(!isNativeHTMLTemplate){if(isAttributeTemplate(templateElement)){assert(!opt_instanceRef);templateElement=extractTemplateFromAttributeTemplate(el);templateElement.templateIsDecorated_=true;isNativeHTMLTemplate=hasTemplateElement;liftRoot=true}else if(isSVGTemplate(templateElement)){templateElement=extractTemplateFromSVGTemplate(el);templateElement.templateIsDecorated_=true;isNativeHTMLTemplate=hasTemplateElement}}if(!isNativeHTMLTemplate){fixTemplateElementPrototype(templateElement);var doc=getOrCreateTemplateContentsOwner(templateElement);templateElement.content_=doc.createDocumentFragment()}if(opt_instanceRef){templateElement.instanceRef_=opt_instanceRef}else if(liftContents){liftNonNativeTemplateChildrenIntoContent(templateElement,el,liftRoot)}else if(bootstrapContents){bootstrapTemplatesRecursivelyFrom(templateElement.content)}return true};HTMLTemplateElement.bootstrap=bootstrapTemplatesRecursivelyFrom;var htmlElement=global.HTMLUnknownElement||HTMLElement;var contentDescriptor={get:function(){return this.content_},enumerable:true,configurable:true};if(!hasTemplateElement){HTMLTemplateElement.prototype=Object.create(htmlElement.prototype);Object.defineProperty(HTMLTemplateElement.prototype,"content",contentDescriptor)}function fixTemplateElementPrototype(el){if(hasProto)el.__proto__=HTMLTemplateElement.prototype;else mixin(el,HTMLTemplateElement.prototype)}function ensureSetModelScheduled(template){if(!template.setModelFn_){template.setModelFn_=function(){template.setModelFnScheduled_=false;var map=getBindings(template,template.delegate_&&template.delegate_.prepareBinding);processBindings(template,map,template.model_)}}if(!template.setModelFnScheduled_){template.setModelFnScheduled_=true;Observer.runEOM_(template.setModelFn_)}}mixin(HTMLTemplateElement.prototype,{bind:function(name,value,oneTime){if(name!="ref")return Element.prototype.bind.call(this,name,value,oneTime);var self=this;var ref=oneTime?value:value.open(function(ref){self.setAttribute("ref",ref);self.refChanged_()});this.setAttribute("ref",ref);this.refChanged_();if(oneTime)return;if(!this.bindings_){this.bindings_={ref:value}}else{this.bindings_.ref=value}return value},processBindingDirectives_:function(directives){if(this.iterator_)this.iterator_.closeDeps();if(!directives.if&&!directives.bind&&!directives.repeat){if(this.iterator_){this.iterator_.close();this.iterator_=undefined}return}if(!this.iterator_){this.iterator_=new TemplateIterator(this)}this.iterator_.updateDependencies(directives,this.model_);if(templateObserver){templateObserver.observe(this,{attributes:true,attributeFilter:["ref"]})}return this.iterator_},createInstance:function(model,bindingDelegate,delegate_){if(bindingDelegate)delegate_=this.newDelegate_(bindingDelegate);else if(!delegate_)delegate_=this.delegate_;if(!this.refContent_)this.refContent_=this.ref_.content;var content=this.refContent_;if(content.firstChild===null)return emptyInstance;var map=getInstanceBindingMap(content,delegate_);var stagingDocument=getTemplateStagingDocument(this);var instance=stagingDocument.createDocumentFragment();instance.templateCreator_=this;instance.protoContent_=content;instance.bindings_=[];instance.terminator_=null;var instanceRecord=instance.templateInstance_={firstNode:null,lastNode:null,model:model};var i=0;var collectTerminator=false;for(var child=content.firstChild;child;child=child.nextSibling){if(child.nextSibling===null)collectTerminator=true;var clone=cloneAndBindInstance(child,instance,stagingDocument,map.children[i++],model,delegate_,instance.bindings_);clone.templateInstance_=instanceRecord;if(collectTerminator)instance.terminator_=clone}instanceRecord.firstNode=instance.firstChild;instanceRecord.lastNode=instance.lastChild;instance.templateCreator_=undefined;instance.protoContent_=undefined;return instance},get model(){return this.model_},set model(model){this.model_=model;ensureSetModelScheduled(this)},get bindingDelegate(){return this.delegate_&&this.delegate_.raw},refChanged_:function(){if(!this.iterator_||this.refContent_===this.ref_.content)return;this.refContent_=undefined;this.iterator_.valueChanged();this.iterator_.updateIteratedValue(this.iterator_.getUpdatedValue())},clear:function(){this.model_=undefined;this.delegate_=undefined;if(this.bindings_&&this.bindings_.ref)this.bindings_.ref.close();this.refContent_=undefined;if(!this.iterator_)return;this.iterator_.valueChanged();this.iterator_.close();this.iterator_=undefined},setDelegate_:function(delegate){this.delegate_=delegate;this.bindingMap_=undefined;if(this.iterator_){this.iterator_.instancePositionChangedFn_=undefined;this.iterator_.instanceModelFn_=undefined}},newDelegate_:function(bindingDelegate){if(!bindingDelegate)return;function delegateFn(name){var fn=bindingDelegate&&bindingDelegate[name];if(typeof fn!="function")return;return function(){return fn.apply(bindingDelegate,arguments)}}return{bindingMaps:{},raw:bindingDelegate,prepareBinding:delegateFn("prepareBinding"),prepareInstanceModel:delegateFn("prepareInstanceModel"),prepareInstancePositionChanged:delegateFn("prepareInstancePositionChanged")}},set bindingDelegate(bindingDelegate){if(this.delegate_){throw Error("Template must be cleared before a new bindingDelegate "+"can be assigned")}this.setDelegate_(this.newDelegate_(bindingDelegate))},get ref_(){var ref=searchRefId(this,this.getAttribute("ref"));if(!ref)ref=this.instanceRef_;if(!ref)return this;var nextRef=ref.ref_;return nextRef?nextRef:ref}});function parseMustaches(s,name,node,prepareBindingFn){if(!s||!s.length)return;var tokens;var length=s.length;var startIndex=0,lastIndex=0,endIndex=0;var onlyOneTime=true;while(lastIndex<length){var startIndex=s.indexOf("{{",lastIndex);var oneTimeStart=s.indexOf("[[",lastIndex);var oneTime=false;var terminator="}}";if(oneTimeStart>=0&&(startIndex<0||oneTimeStart<startIndex)){startIndex=oneTimeStart;oneTime=true;terminator="]]"}endIndex=startIndex<0?-1:s.indexOf(terminator,startIndex+2);if(endIndex<0){if(!tokens)return;tokens.push(s.slice(lastIndex));break}tokens=tokens||[];tokens.push(s.slice(lastIndex,startIndex));var pathString=s.slice(startIndex+2,endIndex).trim();tokens.push(oneTime);onlyOneTime=onlyOneTime&&oneTime;var delegateFn=prepareBindingFn&&prepareBindingFn(pathString,name,node);if(delegateFn==null){tokens.push(Path.get(pathString))}else{tokens.push(null)}tokens.push(delegateFn);lastIndex=endIndex+2}if(lastIndex===length)tokens.push("");tokens.hasOnePath=tokens.length===5;tokens.isSimplePath=tokens.hasOnePath&&tokens[0]==""&&tokens[4]=="";tokens.onlyOneTime=onlyOneTime;tokens.combinator=function(values){var newValue=tokens[0];for(var i=1;i<tokens.length;i+=4){var value=tokens.hasOnePath?values:values[(i-1)/4];if(value!==undefined)newValue+=value;newValue+=tokens[i+3]}return newValue};return tokens}function processOneTimeBinding(name,tokens,node,model){if(tokens.hasOnePath){var delegateFn=tokens[3];var value=delegateFn?delegateFn(model,node,true):tokens[2].getValueFrom(model);return tokens.isSimplePath?value:tokens.combinator(value)}var values=[];for(var i=1;i<tokens.length;i+=4){var delegateFn=tokens[i+2];values[(i-1)/4]=delegateFn?delegateFn(model,node):tokens[i+1].getValueFrom(model)}return tokens.combinator(values)}function processSinglePathBinding(name,tokens,node,model){var delegateFn=tokens[3];var observer=delegateFn?delegateFn(model,node,false):new PathObserver(model,tokens[2]);return tokens.isSimplePath?observer:new ObserverTransform(observer,tokens.combinator)}function processBinding(name,tokens,node,model){if(tokens.onlyOneTime)return processOneTimeBinding(name,tokens,node,model);if(tokens.hasOnePath)return processSinglePathBinding(name,tokens,node,model);var observer=new CompoundObserver;for(var i=1;i<tokens.length;i+=4){var oneTime=tokens[i];var delegateFn=tokens[i+2];if(delegateFn){var value=delegateFn(model,node,oneTime);if(oneTime)observer.addPath(value);else observer.addObserver(value);continue}var path=tokens[i+1];if(oneTime)observer.addPath(path.getValueFrom(model));else observer.addPath(model,path)}return new ObserverTransform(observer,tokens.combinator)}function processBindings(node,bindings,model,instanceBindings){for(var i=0;i<bindings.length;i+=2){var name=bindings[i];var tokens=bindings[i+1];var value=processBinding(name,tokens,node,model);var binding=node.bind(name,value,tokens.onlyOneTime);if(binding&&instanceBindings)instanceBindings.push(binding)}node.bindFinished();if(!bindings.isTemplate)return;node.model_=model;var iter=node.processBindingDirectives_(bindings);if(instanceBindings&&iter)instanceBindings.push(iter)}function parseWithDefault(el,name,prepareBindingFn){var v=el.getAttribute(name);return parseMustaches(v==""?"{{}}":v,name,el,prepareBindingFn)}function parseAttributeBindings(element,prepareBindingFn){assert(element);var bindings=[];var ifFound=false;var bindFound=false;for(var i=0;i<element.attributes.length;i++){var attr=element.attributes[i];var name=attr.name;var value=attr.value;while(name[0]==="_"){name=name.substring(1)}if(isTemplate(element)&&(name===IF||name===BIND||name===REPEAT)){continue}var tokens=parseMustaches(value,name,element,prepareBindingFn);if(!tokens)continue;bindings.push(name,tokens)}if(isTemplate(element)){bindings.isTemplate=true;bindings.if=parseWithDefault(element,IF,prepareBindingFn);bindings.bind=parseWithDefault(element,BIND,prepareBindingFn);bindings.repeat=parseWithDefault(element,REPEAT,prepareBindingFn);if(bindings.if&&!bindings.bind&&!bindings.repeat)bindings.bind=parseMustaches("{{}}",BIND,element,prepareBindingFn)}return bindings}function getBindings(node,prepareBindingFn){if(node.nodeType===Node.ELEMENT_NODE)return parseAttributeBindings(node,prepareBindingFn);if(node.nodeType===Node.TEXT_NODE){var tokens=parseMustaches(node.data,"textContent",node,prepareBindingFn);if(tokens)return["textContent",tokens]}return[]}function cloneAndBindInstance(node,parent,stagingDocument,bindings,model,delegate,instanceBindings,instanceRecord){var clone=parent.appendChild(stagingDocument.importNode(node,false));var i=0;for(var child=node.firstChild;child;child=child.nextSibling){cloneAndBindInstance(child,clone,stagingDocument,bindings.children[i++],model,delegate,instanceBindings)}if(bindings.isTemplate){HTMLTemplateElement.decorate(clone,node);if(delegate)clone.setDelegate_(delegate)}processBindings(clone,bindings,model,instanceBindings);return clone}function createInstanceBindingMap(node,prepareBindingFn){var map=getBindings(node,prepareBindingFn);map.children={};var index=0;for(var child=node.firstChild;child;child=child.nextSibling){map.children[index++]=createInstanceBindingMap(child,prepareBindingFn)}return map}var contentUidCounter=1;function getContentUid(content){var id=content.id_;if(!id)id=content.id_=contentUidCounter++;return id}function getInstanceBindingMap(content,delegate_){var contentId=getContentUid(content);if(delegate_){var map=delegate_.bindingMaps[contentId];if(!map){map=delegate_.bindingMaps[contentId]=createInstanceBindingMap(content,delegate_.prepareBinding)||[]}return map}var map=content.bindingMap_;if(!map){map=content.bindingMap_=createInstanceBindingMap(content,undefined)||[]}return map}Object.defineProperty(Node.prototype,"templateInstance",{get:function(){var instance=this.templateInstance_;return instance?instance:this.parentNode?this.parentNode.templateInstance:undefined}});var emptyInstance=document.createDocumentFragment();emptyInstance.bindings_=[];emptyInstance.terminator_=null;function TemplateIterator(templateElement){this.closed=false;this.templateElement_=templateElement;this.instances=[];this.deps=undefined;this.iteratedValue=[];this.presentValue=undefined;this.arrayObserver=undefined}TemplateIterator.prototype={closeDeps:function(){var deps=this.deps;if(deps){if(deps.ifOneTime===false)deps.ifValue.close();if(deps.oneTime===false)deps.value.close()}},updateDependencies:function(directives,model){this.closeDeps();var deps=this.deps={};var template=this.templateElement_;var ifValue=true;if(directives.if){deps.hasIf=true;deps.ifOneTime=directives.if.onlyOneTime;deps.ifValue=processBinding(IF,directives.if,template,model);ifValue=deps.ifValue;if(deps.ifOneTime&&!ifValue){this.valueChanged();return}if(!deps.ifOneTime)ifValue=ifValue.open(this.updateIfValue,this)}if(directives.repeat){deps.repeat=true;deps.oneTime=directives.repeat.onlyOneTime;deps.value=processBinding(REPEAT,directives.repeat,template,model)}else{deps.repeat=false;deps.oneTime=directives.bind.onlyOneTime;deps.value=processBinding(BIND,directives.bind,template,model)}var value=deps.value;if(!deps.oneTime)value=value.open(this.updateIteratedValue,this);if(!ifValue){this.valueChanged();return}this.updateValue(value)},getUpdatedValue:function(){var value=this.deps.value;if(!this.deps.oneTime)value=value.discardChanges();return value},updateIfValue:function(ifValue){if(!ifValue){this.valueChanged();return}this.updateValue(this.getUpdatedValue())},updateIteratedValue:function(value){if(this.deps.hasIf){var ifValue=this.deps.ifValue;if(!this.deps.ifOneTime)ifValue=ifValue.discardChanges();if(!ifValue){this.valueChanged();return}}this.updateValue(value)},updateValue:function(value){if(!this.deps.repeat)value=[value];var observe=this.deps.repeat&&!this.deps.oneTime&&Array.isArray(value);this.valueChanged(value,observe)},valueChanged:function(value,observeValue){if(!Array.isArray(value))value=[];if(value===this.iteratedValue)return;this.unobserve();this.presentValue=value;if(observeValue){this.arrayObserver=new ArrayObserver(this.presentValue);this.arrayObserver.open(this.handleSplices,this)}this.handleSplices(ArrayObserver.calculateSplices(this.presentValue,this.iteratedValue))},getLastInstanceNode:function(index){if(index==-1)return this.templateElement_;var instance=this.instances[index];var terminator=instance.terminator_;if(!terminator)return this.getLastInstanceNode(index-1);if(terminator.nodeType!==Node.ELEMENT_NODE||this.templateElement_===terminator){return terminator}var subtemplateIterator=terminator.iterator_;if(!subtemplateIterator)return terminator;return subtemplateIterator.getLastTemplateNode()},getLastTemplateNode:function(){return this.getLastInstanceNode(this.instances.length-1)},insertInstanceAt:function(index,fragment){var previousInstanceLast=this.getLastInstanceNode(index-1);var parent=this.templateElement_.parentNode;this.instances.splice(index,0,fragment);parent.insertBefore(fragment,previousInstanceLast.nextSibling)},extractInstanceAt:function(index){var previousInstanceLast=this.getLastInstanceNode(index-1);var lastNode=this.getLastInstanceNode(index);var parent=this.templateElement_.parentNode;var instance=this.instances.splice(index,1)[0];while(lastNode!==previousInstanceLast){var node=previousInstanceLast.nextSibling;if(node==lastNode)lastNode=previousInstanceLast;instance.appendChild(parent.removeChild(node))}return instance},getDelegateFn:function(fn){fn=fn&&fn(this.templateElement_);return typeof fn==="function"?fn:null},handleSplices:function(splices){if(this.closed||!splices.length)return;var template=this.templateElement_;if(!template.parentNode){this.close();return}ArrayObserver.applySplices(this.iteratedValue,this.presentValue,splices);var delegate=template.delegate_;if(this.instanceModelFn_===undefined){this.instanceModelFn_=this.getDelegateFn(delegate&&delegate.prepareInstanceModel)}if(this.instancePositionChangedFn_===undefined){this.instancePositionChangedFn_=this.getDelegateFn(delegate&&delegate.prepareInstancePositionChanged)}var instanceCache=new Map;var removeDelta=0;for(var i=0;i<splices.length;i++){var splice=splices[i];var removed=splice.removed;for(var j=0;j<removed.length;j++){var model=removed[j];var instance=this.extractInstanceAt(splice.index+removeDelta);if(instance!==emptyInstance){instanceCache.set(model,instance)}}removeDelta-=splice.addedCount}for(var i=0;i<splices.length;i++){var splice=splices[i];var addIndex=splice.index;for(;addIndex<splice.index+splice.addedCount;addIndex++){var model=this.iteratedValue[addIndex];var instance=instanceCache.get(model);if(instance){instanceCache.delete(model)}else{if(this.instanceModelFn_){model=this.instanceModelFn_(model)}if(model===undefined){instance=emptyInstance}else{instance=template.createInstance(model,undefined,delegate)}}this.insertInstanceAt(addIndex,instance)}}instanceCache.forEach(function(instance){this.closeInstanceBindings(instance)},this);if(this.instancePositionChangedFn_)this.reportInstancesMoved(splices)},reportInstanceMoved:function(index){var instance=this.instances[index];if(instance===emptyInstance)return;this.instancePositionChangedFn_(instance.templateInstance_,index)},reportInstancesMoved:function(splices){var index=0;var offset=0;for(var i=0;i<splices.length;i++){var splice=splices[i];if(offset!=0){while(index<splice.index){this.reportInstanceMoved(index);index++}}else{index=splice.index}while(index<splice.index+splice.addedCount){this.reportInstanceMoved(index);index++}offset+=splice.addedCount-splice.removed.length}if(offset==0)return;var length=this.instances.length;while(index<length){this.reportInstanceMoved(index);index++}},closeInstanceBindings:function(instance){var bindings=instance.bindings_;for(var i=0;i<bindings.length;i++){bindings[i].close()}},unobserve:function(){if(!this.arrayObserver)return;this.arrayObserver.close();this.arrayObserver=undefined},close:function(){if(this.closed)return;this.unobserve();for(var i=0;i<this.instances.length;i++){this.closeInstanceBindings(this.instances[i])}this.instances.length=0;this.closeDeps();this.templateElement_.iterator_=undefined;this.closed=true}};HTMLTemplateElement.forAllTemplatesFrom_=forAllTemplatesFrom})(this);</script><script>(function(scope){"use strict";var hasWorkingUrl=false;if(!scope.forceJURL){try{var u=new URL("b","http://a");hasWorkingUrl=u.href==="http://a/b"}catch(e){}}if(hasWorkingUrl)return;var relative=Object.create(null);relative["ftp"]=21;relative["file"]=0;relative["gopher"]=70;relative["http"]=80;relative["https"]=443;relative["ws"]=80;relative["wss"]=443;var relativePathDotMapping=Object.create(null);relativePathDotMapping["%2e"]=".";relativePathDotMapping[".%2e"]="..";relativePathDotMapping["%2e."]="..";relativePathDotMapping["%2e%2e"]="..";function isRelativeScheme(scheme){return relative[scheme]!==undefined}function invalid(){clear.call(this);this._isInvalid=true}function IDNAToASCII(h){if(""==h){invalid.call(this)}return h.toLowerCase()}function percentEscape(c){var unicode=c.charCodeAt(0);if(unicode>32&&unicode<127&&[34,35,60,62,63,96].indexOf(unicode)==-1){return c}return encodeURIComponent(c)}function percentEscapeQuery(c){var unicode=c.charCodeAt(0);if(unicode>32&&unicode<127&&[34,35,60,62,96].indexOf(unicode)==-1){return c}return encodeURIComponent(c)}var EOF=undefined,ALPHA=/[a-zA-Z]/,ALPHANUMERIC=/[a-zA-Z0-9\+\-\.]/;function parse(input,stateOverride,base){function err(message){errors.push(message)}var state=stateOverride||"scheme start",cursor=0,buffer="",seenAt=false,seenBracket=false,errors=[];loop:while((input[cursor-1]!=EOF||cursor==0)&&!this._isInvalid){var c=input[cursor];switch(state){case"scheme start":if(c&&ALPHA.test(c)){buffer+=c.toLowerCase();state="scheme"}else if(!stateOverride){buffer="";state="no scheme";continue}else{err("Invalid scheme.");break loop}break;case"scheme":if(c&&ALPHANUMERIC.test(c)){buffer+=c.toLowerCase()}else if(":"==c){this._scheme=buffer;buffer="";if(stateOverride){break loop}if(isRelativeScheme(this._scheme)){this._isRelative=true}if("file"==this._scheme){state="relative"}else if(this._isRelative&&base&&base._scheme==this._scheme){state="relative or authority"}else if(this._isRelative){state="authority first slash"}else{state="scheme data"}}else if(!stateOverride){buffer="";cursor=0;state="no scheme";continue}else if(EOF==c){break loop}else{err("Code point not allowed in scheme: "+c);break loop}break;case"scheme data":if("?"==c){query="?";state="query"}else if("#"==c){this._fragment="#";state="fragment"}else{if(EOF!=c&&"	"!=c&&"\n"!=c&&"\r"!=c){this._schemeData+=percentEscape(c)}}break;case"no scheme":if(!base||!isRelativeScheme(base._scheme)){err("Missing scheme.");invalid.call(this)}else{state="relative";continue}break;case"relative or authority":if("/"==c&&"/"==input[cursor+1]){state="authority ignore slashes"}else{err("Expected /, got: "+c);state="relative";continue}break;case"relative":this._isRelative=true;if("file"!=this._scheme)this._scheme=base._scheme;if(EOF==c){this._host=base._host;this._port=base._port;this._path=base._path.slice();this._query=base._query;break loop}else if("/"==c||"\\"==c){if("\\"==c)err("\\ is an invalid code point.");state="relative slash"}else if("?"==c){this._host=base._host;this._port=base._port;this._path=base._path.slice();this._query="?";state="query"}else if("#"==c){this._host=base._host;this._port=base._port;this._path=base._path.slice();this._query=base._query;this._fragment="#";state="fragment"}else{var nextC=input[cursor+1];var nextNextC=input[cursor+2];if("file"!=this._scheme||!ALPHA.test(c)||nextC!=":"&&nextC!="|"||EOF!=nextNextC&&"/"!=nextNextC&&"\\"!=nextNextC&&"?"!=nextNextC&&"#"!=nextNextC){this._host=base._host;this._port=base._port;this._path=base._path.slice();this._path.pop()}state="relative path";continue}break;case"relative slash":if("/"==c||"\\"==c){if("\\"==c){err("\\ is an invalid code point.")}if("file"==this._scheme){state="file host"}else{state="authority ignore slashes"}}else{if("file"!=this._scheme){this._host=base._host;this._port=base._port}state="relative path";continue}break;case"authority first slash":if("/"==c){state="authority second slash"}else{err("Expected '/', got: "+c);state="authority ignore slashes";continue}break;case"authority second slash":state="authority ignore slashes";if("/"!=c){err("Expected '/', got: "+c);continue}break;case"authority ignore slashes":if("/"!=c&&"\\"!=c){state="authority";continue}else{err("Expected authority, got: "+c)}break;case"authority":if("@"==c){if(seenAt){err("@ already seen.");buffer+="%40"}seenAt=true;for(var i=0;i<buffer.length;i++){var cp=buffer[i];if("	"==cp||"\n"==cp||"\r"==cp){err("Invalid whitespace in authority.");continue}if(":"==cp&&null===this._password){this._password="";continue}var tempC=percentEscape(cp);null!==this._password?this._password+=tempC:this._username+=tempC}buffer=""}else if(EOF==c||"/"==c||"\\"==c||"?"==c||"#"==c){cursor-=buffer.length;buffer="";state="host";continue}else{buffer+=c}break;case"file host":if(EOF==c||"/"==c||"\\"==c||"?"==c||"#"==c){if(buffer.length==2&&ALPHA.test(buffer[0])&&(buffer[1]==":"||buffer[1]=="|")){state="relative path"}else if(buffer.length==0){state="relative path start"}else{this._host=IDNAToASCII.call(this,buffer);buffer="";state="relative path start"}continue}else if("	"==c||"\n"==c||"\r"==c){err("Invalid whitespace in file host.")}else{buffer+=c}break;case"host":case"hostname":if(":"==c&&!seenBracket){this._host=IDNAToASCII.call(this,buffer);buffer="";state="port";if("hostname"==stateOverride){break loop}}else if(EOF==c||"/"==c||"\\"==c||"?"==c||"#"==c){this._host=IDNAToASCII.call(this,buffer);buffer="";state="relative path start";if(stateOverride){break loop}continue}else if("	"!=c&&"\n"!=c&&"\r"!=c){if("["==c){seenBracket=true}else if("]"==c){seenBracket=false}buffer+=c}else{err("Invalid code point in host/hostname: "+c)}break;case"port":if(/[0-9]/.test(c)){buffer+=c}else if(EOF==c||"/"==c||"\\"==c||"?"==c||"#"==c||stateOverride){if(""!=buffer){var temp=parseInt(buffer,10);if(temp!=relative[this._scheme]){this._port=temp+""}buffer=""}if(stateOverride){break loop}state="relative path start";continue}else if("	"==c||"\n"==c||"\r"==c){err("Invalid code point in port: "+c)}else{invalid.call(this)}break;case"relative path start":if("\\"==c)err("'\\' not allowed in path.");state="relative path";if("/"!=c&&"\\"!=c){continue}break;case"relative path":if(EOF==c||"/"==c||"\\"==c||!stateOverride&&("?"==c||"#"==c)){if("\\"==c){err("\\ not allowed in relative path.")}var tmp;if(tmp=relativePathDotMapping[buffer.toLowerCase()]){buffer=tmp}if(".."==buffer){this._path.pop();if("/"!=c&&"\\"!=c){this._path.push("")}}else if("."==buffer&&"/"!=c&&"\\"!=c){this._path.push("")}else if("."!=buffer){if("file"==this._scheme&&this._path.length==0&&buffer.length==2&&ALPHA.test(buffer[0])&&buffer[1]=="|"){buffer=buffer[0]+":"}this._path.push(buffer)}buffer="";if("?"==c){this._query="?";state="query"}else if("#"==c){this._fragment="#";state="fragment"}}else if("	"!=c&&"\n"!=c&&"\r"!=c){buffer+=percentEscape(c)}break;case"query":if(!stateOverride&&"#"==c){this._fragment="#";state="fragment"}else if(EOF!=c&&"	"!=c&&"\n"!=c&&"\r"!=c){this._query+=percentEscapeQuery(c)}break;case"fragment":if(EOF!=c&&"	"!=c&&"\n"!=c&&"\r"!=c){this._fragment+=c}break}cursor++}}function clear(){this._scheme="";this._schemeData="";this._username="";this._password=null;this._host="";this._port="";this._path=[];this._query="";this._fragment="";this._isInvalid=false;this._isRelative=false}function jURL(url,base){if(base!==undefined&&!(base instanceof jURL))base=new jURL(String(base));this._url=url;clear.call(this);var input=url.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");parse.call(this,input,null,base)}jURL.prototype={get href(){if(this._isInvalid)return this._url;var authority="";if(""!=this._username||null!=this._password){authority=this._username+(null!=this._password?":"+this._password:"")+"@"}return this.protocol+(this._isRelative?"//"+authority+this.host:"")+this.pathname+this._query+this._fragment},set href(href){clear.call(this);parse.call(this,href)},get protocol(){return this._scheme+":"},set protocol(protocol){if(this._isInvalid)return;parse.call(this,protocol+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(host){if(this._isInvalid||!this._isRelative)return;parse.call(this,host,"host")},get hostname(){return this._host},set hostname(hostname){if(this._isInvalid||!this._isRelative)return;parse.call(this,hostname,"hostname")},get port(){return this._port},set port(port){if(this._isInvalid||!this._isRelative)return;parse.call(this,port,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(pathname){if(this._isInvalid||!this._isRelative)return;this._path=[];parse.call(this,pathname,"relative path start")},get search(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set search(search){if(this._isInvalid||!this._isRelative)return;this._query="?";if("?"==search[0])search=search.slice(1);parse.call(this,search,"query")},get hash(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set hash(hash){if(this._isInvalid)return;this._fragment="#";if("#"==hash[0])hash=hash.slice(1);parse.call(this,hash,"fragment")},get origin(){var host;if(this._isInvalid||!this._scheme){return""}switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}host=this.host;if(!host){return""}return this._scheme+"://"+host}};var OriginalURL=scope.URL;if(OriginalURL){jURL.createObjectURL=function(blob){return OriginalURL.createObjectURL.apply(OriginalURL,arguments)};jURL.revokeObjectURL=function(url){OriginalURL.revokeObjectURL(url)}}scope.URL=jURL})(this);</script><script>(function(scope){var iterations=0;var callbacks=[];var twiddle=document.createTextNode("");function endOfMicrotask(callback){twiddle.textContent=iterations++;callbacks.push(callback)}function atEndOfMicrotask(){while(callbacks.length){callbacks.shift()()}}new(window.MutationObserver||JsMutationObserver)(atEndOfMicrotask).observe(twiddle,{characterData:true});scope.endOfMicrotask=endOfMicrotask;Platform.endOfMicrotask=endOfMicrotask})(Polymer);</script><script>(function(scope){var endOfMicrotask=scope.endOfMicrotask;var log=window.WebComponents?WebComponents.flags.log:{};var style=document.createElement("style");style.textContent="template {display: none !important;} /* injected by platform.js */";var head=document.querySelector("head");head.insertBefore(style,head.firstChild);var flushing;function flush(){if(!flushing){flushing=true;endOfMicrotask(function(){flushing=false;log.data&&console.group("flush");Platform.performMicrotaskCheckpoint();log.data&&console.groupEnd()})}}if(!Observer.hasObjectObserve){var FLUSH_POLL_INTERVAL=125;window.addEventListener("WebComponentsReady",function(){flush();var visibilityHandler=function(){if(document.visibilityState==="hidden"){if(scope.flushPoll){clearInterval(scope.flushPoll)}}else{scope.flushPoll=setInterval(flush,FLUSH_POLL_INTERVAL)}};if(typeof document.visibilityState==="string"){document.addEventListener("visibilitychange",visibilityHandler)}visibilityHandler()})}else{flush=function(){}}if(window.CustomElements&&!CustomElements.useNative){var originalImportNode=Document.prototype.importNode;Document.prototype.importNode=function(node,deep){var imported=originalImportNode.call(this,node,deep);CustomElements.upgradeAll(imported);return imported}}scope.flush=flush;Platform.flush=flush})(window.Polymer);</script><script>(function(scope){var urlResolver={resolveDom:function(root,url){url=url||baseUrl(root);this.resolveAttributes(root,url);this.resolveStyles(root,url);var templates=root.querySelectorAll("template");if(templates){for(var i=0,l=templates.length,t;i<l&&(t=templates[i]);i++){if(t.content){this.resolveDom(t.content,url)}}}},resolveTemplate:function(template){this.resolveDom(template.content,baseUrl(template))},resolveStyles:function(root,url){var styles=root.querySelectorAll("style");if(styles){for(var i=0,l=styles.length,s;i<l&&(s=styles[i]);i++){this.resolveStyle(s,url)}}},resolveStyle:function(style,url){url=url||baseUrl(style);style.textContent=this.resolveCssText(style.textContent,url)},resolveCssText:function(cssText,baseUrl,keepAbsolute){cssText=replaceUrlsInCssText(cssText,baseUrl,keepAbsolute,CSS_URL_REGEXP);return replaceUrlsInCssText(cssText,baseUrl,keepAbsolute,CSS_IMPORT_REGEXP)},resolveAttributes:function(root,url){if(root.hasAttributes&&root.hasAttributes()){this.resolveElementAttributes(root,url)}var nodes=root&&root.querySelectorAll(URL_ATTRS_SELECTOR);if(nodes){for(var i=0,l=nodes.length,n;i<l&&(n=nodes[i]);i++){this.resolveElementAttributes(n,url)}}},resolveElementAttributes:function(node,url){url=url||baseUrl(node);URL_ATTRS.forEach(function(v){var attr=node.attributes[v];var value=attr&&attr.value;var replacement;if(value&&value.search(URL_TEMPLATE_SEARCH)<0){if(v==="style"){replacement=replaceUrlsInCssText(value,url,false,CSS_URL_REGEXP)}else{replacement=resolveRelativeUrl(url,value)}attr.value=replacement}})}};var CSS_URL_REGEXP=/(url\()([^)]*)(\))/g;var CSS_IMPORT_REGEXP=/(@import[\s]+(?!url\())([^;]*)(;)/g;var URL_ATTRS=["href","src","action","style","url"];var URL_ATTRS_SELECTOR="["+URL_ATTRS.join("],[")+"]";var URL_TEMPLATE_SEARCH="{{.*}}";var URL_HASH="#";function baseUrl(node){var u=new URL(node.ownerDocument.baseURI);u.search="";u.hash="";return u}function replaceUrlsInCssText(cssText,baseUrl,keepAbsolute,regexp){return cssText.replace(regexp,function(m,pre,url,post){var urlPath=url.replace(/["']/g,"");urlPath=resolveRelativeUrl(baseUrl,urlPath,keepAbsolute);return pre+"'"+urlPath+"'"+post})}function resolveRelativeUrl(baseUrl,url,keepAbsolute){if(url&&url[0]==="/"){return url}var u=new URL(url,baseUrl);return keepAbsolute?u.href:makeDocumentRelPath(u.href)}function makeDocumentRelPath(url){var root=baseUrl(document.documentElement);var u=new URL(url,root);if(u.host===root.host&&u.port===root.port&&u.protocol===root.protocol){return makeRelPath(root,u)}else{return url}}function makeRelPath(sourceUrl,targetUrl){var source=sourceUrl.pathname;var target=targetUrl.pathname;var s=source.split("/");var t=target.split("/");while(s.length&&s[0]===t[0]){s.shift();t.shift()}for(var i=0,l=s.length-1;i<l;i++){t.unshift("..")}var hash=targetUrl.href.slice(-1)===URL_HASH?URL_HASH:targetUrl.hash;return t.join("/")+targetUrl.search+hash}scope.urlResolver=urlResolver})(Polymer);</script><script>(function(scope){var endOfMicrotask=Polymer.endOfMicrotask;function Loader(regex){this.cache=Object.create(null);this.map=Object.create(null);this.requests=0;this.regex=regex}Loader.prototype={extractUrls:function(text,base){var matches=[];var matched,u;while(matched=this.regex.exec(text)){u=new URL(matched[1],base);matches.push({matched:matched[0],url:u.href})}return matches},process:function(text,root,callback){var matches=this.extractUrls(text,root);var done=callback.bind(null,this.map);this.fetch(matches,done)},fetch:function(matches,callback){var inflight=matches.length;if(!inflight){return callback()}var done=function(){if(--inflight===0){callback()}};var m,req,url;for(var i=0;i<inflight;i++){m=matches[i];url=m.url;req=this.cache[url];if(!req){req=this.xhr(url);req.match=m;this.cache[url]=req}req.wait(done)}},handleXhr:function(request){var match=request.match;var url=match.url;var response=request.response||request.responseText||"";this.map[url]=response;this.fetch(this.extractUrls(response,url),request.resolve)},xhr:function(url){this.requests++;var request=new XMLHttpRequest;request.open("GET",url,true);request.send();request.onerror=request.onload=this.handleXhr.bind(this,request);request.pending=[];request.resolve=function(){var pending=request.pending;for(var i=0;i<pending.length;i++){pending[i]()}request.pending=null};request.wait=function(fn){if(request.pending){request.pending.push(fn)}else{endOfMicrotask(fn)}};return request}};scope.Loader=Loader})(Polymer);</script><script>(function(scope){var urlResolver=scope.urlResolver;var Loader=scope.Loader;function StyleResolver(){this.loader=new Loader(this.regex)}StyleResolver.prototype={regex:/@import\s+(?:url)?["'\(]*([^'"\)]*)['"\)]*;/g,resolve:function(text,url,callback){var done=function(map){callback(this.flatten(text,url,map))}.bind(this);this.loader.process(text,url,done)},resolveNode:function(style,url,callback){var text=style.textContent;var done=function(text){style.textContent=text;callback(style)};this.resolve(text,url,done)},flatten:function(text,base,map){var matches=this.loader.extractUrls(text,base);var match,url,intermediate;for(var i=0;i<matches.length;i++){match=matches[i];url=match.url;intermediate=urlResolver.resolveCssText(map[url],url,true);intermediate=this.flatten(intermediate,base,map);text=text.replace(match.matched,intermediate)}return text},loadStyles:function(styles,base,callback){var loaded=0,l=styles.length;function loadedStyle(style){loaded++;if(loaded===l&&callback){callback()}}for(var i=0,s;i<l&&(s=styles[i]);i++){this.resolveNode(s,base,loadedStyle)}}};var styleResolver=new StyleResolver;scope.styleResolver=styleResolver})(Polymer);</script><script>(function(scope){function extend(prototype,api){if(prototype&&api){Object.getOwnPropertyNames(api).forEach(function(n){var pd=Object.getOwnPropertyDescriptor(api,n);if(pd){Object.defineProperty(prototype,n,pd);if(typeof pd.value=="function"){pd.value.nom=n}}})}return prototype}function mixin(inObj){var obj=inObj||{};for(var i=1;i<arguments.length;i++){var p=arguments[i];try{for(var n in p){copyProperty(n,p,obj)}}catch(x){}}return obj}function copyProperty(inName,inSource,inTarget){var pd=getPropertyDescriptor(inSource,inName);Object.defineProperty(inTarget,inName,pd)}function getPropertyDescriptor(inObject,inName){if(inObject){var pd=Object.getOwnPropertyDescriptor(inObject,inName);return pd||getPropertyDescriptor(Object.getPrototypeOf(inObject),inName)}}scope.extend=extend;scope.mixin=mixin;Platform.mixin=mixin})(Polymer);</script><script>(function(scope){var Job=function(inContext){this.context=inContext;this.boundComplete=this.complete.bind(this)};Job.prototype={go:function(callback,wait){this.callback=callback;var h;if(!wait){h=requestAnimationFrame(this.boundComplete);this.handle=function(){cancelAnimationFrame(h)}}else{h=setTimeout(this.boundComplete,wait);this.handle=function(){clearTimeout(h)}}},stop:function(){if(this.handle){this.handle();this.handle=null}},complete:function(){if(this.handle){this.stop();this.callback.call(this.context)}}};function job(job,callback,wait){if(job){job.stop()}else{job=new Job(this)}job.go(callback,wait);return job}scope.job=job})(Polymer);</script><script>(function(scope){var registry={};HTMLElement.register=function(tag,prototype){registry[tag]=prototype};HTMLElement.getPrototypeForTag=function(tag){var prototype=!tag?HTMLElement.prototype:registry[tag];return prototype||Object.getPrototypeOf(document.createElement(tag))};var originalStopPropagation=Event.prototype.stopPropagation;Event.prototype.stopPropagation=function(){this.cancelBubble=true;originalStopPropagation.apply(this,arguments)};var add=DOMTokenList.prototype.add;var remove=DOMTokenList.prototype.remove;DOMTokenList.prototype.add=function(){for(var i=0;i<arguments.length;i++){add.call(this,arguments[i])}};DOMTokenList.prototype.remove=function(){for(var i=0;i<arguments.length;i++){remove.call(this,arguments[i])}};DOMTokenList.prototype.toggle=function(name,bool){if(arguments.length==1){bool=!this.contains(name)}bool?this.add(name):this.remove(name)};DOMTokenList.prototype.switch=function(oldName,newName){oldName&&this.remove(oldName);newName&&this.add(newName)};var ArraySlice=function(){return Array.prototype.slice.call(this)};var namedNodeMap=window.NamedNodeMap||window.MozNamedAttrMap||{};NodeList.prototype.array=ArraySlice;namedNodeMap.prototype.array=ArraySlice;HTMLCollection.prototype.array=ArraySlice;function createDOM(inTagOrNode,inHTML,inAttrs){var dom=typeof inTagOrNode=="string"?document.createElement(inTagOrNode):inTagOrNode.cloneNode(true);dom.innerHTML=inHTML;if(inAttrs){for(var n in inAttrs){dom.setAttribute(n,inAttrs[n])}}return dom}scope.createDOM=createDOM})(Polymer);</script><script>(function(scope){function $super(arrayOfArgs){var caller=$super.caller;var nom=caller.nom;var _super=caller._super;if(!_super){if(!nom){nom=caller.nom=nameInThis.call(this,caller)}if(!nom){console.warn("called super() on a method not installed declaratively (has no .nom property)")}_super=memoizeSuper(caller,nom,getPrototypeOf(this))}var fn=_super[nom];if(fn){if(!fn._super){memoizeSuper(fn,nom,_super)}return fn.apply(this,arrayOfArgs||[])}}function nameInThis(value){var p=this.__proto__;while(p&&p!==HTMLElement.prototype){var n$=Object.getOwnPropertyNames(p);for(var i=0,l=n$.length,n;i<l&&(n=n$[i]);i++){var d=Object.getOwnPropertyDescriptor(p,n);if(typeof d.value==="function"&&d.value===value){return n}}p=p.__proto__}}function memoizeSuper(method,name,proto){var s=nextSuper(proto,name,method);if(s[name]){s[name].nom=name}return method._super=s}function nextSuper(proto,name,caller){while(proto){if(proto[name]!==caller&&proto[name]){return proto}proto=getPrototypeOf(proto)}return Object}function getPrototypeOf(prototype){return prototype.__proto__}function hintSuper(prototype){for(var n in prototype){var pd=Object.getOwnPropertyDescriptor(prototype,n);if(pd&&typeof pd.value==="function"){pd.value.nom=n}}}scope.super=$super})(Polymer);</script><script>(function(scope){function noopHandler(value){return value}var typeHandlers={string:noopHandler,undefined:noopHandler,date:function(value){return new Date(Date.parse(value)||Date.now())},"boolean":function(value){if(value===""){return true}return value==="false"?false:!!value},number:function(value){var n=parseFloat(value);if(n===0){n=parseInt(value)}return isNaN(n)?value:n},object:function(value,currentValue){if(currentValue===null){return value}try{return JSON.parse(value.replace(/'/g,'"'))}catch(e){return value}},"function":function(value,currentValue){return currentValue}};function deserializeValue(value,currentValue){var inferredType=typeof currentValue;if(currentValue instanceof Date){inferredType="date"}return typeHandlers[inferredType](value,currentValue)}scope.deserializeValue=deserializeValue})(Polymer);</script><script>(function(scope){var extend=scope.extend;var api={};api.declaration={};api.instance={};api.publish=function(apis,prototype){for(var n in apis){extend(prototype,apis[n])}};scope.api=api})(Polymer);</script><script>(function(scope){var utils={async:function(method,args,timeout){Polymer.flush();args=args&&args.length?args:[args];var fn=function(){(this[method]||method).apply(this,args)}.bind(this);var handle=timeout?setTimeout(fn,timeout):requestAnimationFrame(fn);return timeout?handle:~handle},cancelAsync:function(handle){if(handle<0){cancelAnimationFrame(~handle)}else{clearTimeout(handle)}},fire:function(type,detail,onNode,bubbles,cancelable){var node=onNode||this;var detail=detail===null||detail===undefined?{}:detail;var event=new CustomEvent(type,{bubbles:bubbles!==undefined?bubbles:true,cancelable:cancelable!==undefined?cancelable:true,detail:detail});node.dispatchEvent(event);return event},asyncFire:function(){this.async("fire",arguments)},classFollows:function(anew,old,className){if(old){old.classList.remove(className)}if(anew){anew.classList.add(className)}},injectBoundHTML:function(html,element){var template=document.createElement("template");template.innerHTML=html;var fragment=this.instanceTemplate(template);if(element){element.textContent="";element.appendChild(fragment)}return fragment}};var nop=function(){};var nob={};utils.asyncMethod=utils.async;scope.api.instance.utils=utils;scope.nop=nop;scope.nob=nob})(Polymer);</script><script>(function(scope){var log=window.WebComponents?WebComponents.flags.log:{};var EVENT_PREFIX="on-";var events={EVENT_PREFIX:EVENT_PREFIX,addHostListeners:function(){var events=this.eventDelegates;log.events&&Object.keys(events).length>0&&console.log("[%s] addHostListeners:",this.localName,events);for(var type in events){var methodName=events[type];PolymerGestures.addEventListener(this,type,this.element.getEventHandler(this,this,methodName))}},dispatchMethod:function(obj,method,args){if(obj){log.events&&console.group("[%s] dispatch [%s]",obj.localName,method);var fn=typeof method==="function"?method:obj[method];if(fn){fn[args?"apply":"call"](obj,args)}log.events&&console.groupEnd();Polymer.flush()}}};scope.api.instance.events=events;scope.addEventListener=function(node,eventType,handlerFn,capture){PolymerGestures.addEventListener(wrap(node),eventType,handlerFn,capture)};scope.removeEventListener=function(node,eventType,handlerFn,capture){PolymerGestures.removeEventListener(wrap(node),eventType,handlerFn,capture)}})(Polymer);</script><script>(function(scope){var attributes={copyInstanceAttributes:function(){var a$=this._instanceAttributes;for(var k in a$){if(!this.hasAttribute(k)){this.setAttribute(k,a$[k])}}},takeAttributes:function(){if(this._publishLC){for(var i=0,a$=this.attributes,l=a$.length,a;(a=a$[i])&&i<l;i++){this.attributeToProperty(a.name,a.value)}}},attributeToProperty:function(name,value){var name=this.propertyForAttribute(name);if(name){if(value&&value.search(scope.bindPattern)>=0){return}var currentValue=this[name];var value=this.deserializeValue(value,currentValue);if(value!==currentValue){this[name]=value}}},propertyForAttribute:function(name){var match=this._publishLC&&this._publishLC[name];return match},deserializeValue:function(stringValue,currentValue){return scope.deserializeValue(stringValue,currentValue)},serializeValue:function(value,inferredType){if(inferredType==="boolean"){return value?"":undefined}else if(inferredType!=="object"&&inferredType!=="function"&&value!==undefined){return value}},reflectPropertyToAttribute:function(name){var inferredType=typeof this[name];var serializedValue=this.serializeValue(this[name],inferredType);if(serializedValue!==undefined){this.setAttribute(name,serializedValue)}else if(inferredType==="boolean"){this.removeAttribute(name)}}};scope.api.instance.attributes=attributes})(Polymer);</script><script>(function(scope){var log=window.WebComponents?WebComponents.flags.log:{};var OBSERVE_SUFFIX="Changed";var empty=[];var updateRecord={object:undefined,type:"update",name:undefined,oldValue:undefined};var numberIsNaN=Number.isNaN||function(value){return typeof value==="number"&&isNaN(value)};function areSameValue(left,right){if(left===right)return left!==0||1/left===1/right;if(numberIsNaN(left)&&numberIsNaN(right))return true;return left!==left&&right!==right}function resolveBindingValue(oldValue,value){if(value===undefined&&oldValue===null){return value}return value===null||value===undefined?oldValue:value}var properties={createPropertyObserver:function(){var n$=this._observeNames;if(n$&&n$.length){var o=this._propertyObserver=new CompoundObserver(true);this.registerObserver(o);for(var i=0,l=n$.length,n;i<l&&(n=n$[i]);i++){o.addPath(this,n);this.observeArrayValue(n,this[n],null)}}},openPropertyObserver:function(){if(this._propertyObserver){this._propertyObserver.open(this.notifyPropertyChanges,this)}},notifyPropertyChanges:function(newValues,oldValues,paths){var name,method,called={};for(var i in oldValues){name=paths[2*i+1];method=this.observe[name];if(method){var ov=oldValues[i],nv=newValues[i];this.observeArrayValue(name,nv,ov);if(!called[method]){if(ov!==undefined&&ov!==null||nv!==undefined&&nv!==null){called[method]=true;this.invokeMethod(method,[ov,nv,arguments])}}}}},invokeMethod:function(method,args){var fn=this[method]||method;if(typeof fn==="function"){fn.apply(this,args)}},deliverChanges:function(){if(this._propertyObserver){this._propertyObserver.deliver()}},observeArrayValue:function(name,value,old){var callbackName=this.observe[name];if(callbackName){if(Array.isArray(old)){log.observe&&console.log("[%s] observeArrayValue: unregister observer [%s]",this.localName,name);this.closeNamedObserver(name+"__array")}if(Array.isArray(value)){log.observe&&console.log("[%s] observeArrayValue: register observer [%s]",this.localName,name,value);var observer=new ArrayObserver(value);observer.open(function(splices){this.invokeMethod(callbackName,[splices])},this);this.registerNamedObserver(name+"__array",observer)}}},emitPropertyChangeRecord:function(name,value,oldValue){var object=this;if(areSameValue(value,oldValue)){return}this._propertyChanged(name,value,oldValue);if(!Observer.hasObjectObserve){return}var notifier=this._objectNotifier;if(!notifier){notifier=this._objectNotifier=Object.getNotifier(this)}updateRecord.object=this;updateRecord.name=name;updateRecord.oldValue=oldValue;notifier.notify(updateRecord)},_propertyChanged:function(name,value,oldValue){if(this.reflect[name]){this.reflectPropertyToAttribute(name)}},bindProperty:function(property,observable,oneTime){if(oneTime){this[property]=observable;return}var computed=this.element.prototype.computed;if(computed&&computed[property]){var privateComputedBoundValue=property+"ComputedBoundObservable_";this[privateComputedBoundValue]=observable;return}return this.bindToAccessor(property,observable,resolveBindingValue)},bindToAccessor:function(name,observable,resolveFn){var privateName=name+"_";var privateObservable=name+"Observable_";var privateComputedBoundValue=name+"ComputedBoundObservable_";this[privateObservable]=observable;var oldValue=this[privateName];var self=this;function updateValue(value,oldValue){self[privateName]=value;var setObserveable=self[privateComputedBoundValue];if(setObserveable&&typeof setObserveable.setValue=="function"){setObserveable.setValue(value)}self.emitPropertyChangeRecord(name,value,oldValue)}var value=observable.open(updateValue);if(resolveFn&&!areSameValue(oldValue,value)){var resolvedValue=resolveFn(oldValue,value);if(!areSameValue(value,resolvedValue)){value=resolvedValue;if(observable.setValue){observable.setValue(value)}}}updateValue(value,oldValue);var observer={close:function(){observable.close();self[privateObservable]=undefined;self[privateComputedBoundValue]=undefined}};this.registerObserver(observer);return observer},createComputedProperties:function(){if(!this._computedNames){return}for(var i=0;i<this._computedNames.length;i++){var name=this._computedNames[i];var expressionText=this.computed[name];try{var expression=PolymerExpressions.getExpression(expressionText);var observable=expression.getBinding(this,this.element.syntax);this.bindToAccessor(name,observable)}catch(ex){console.error("Failed to create computed property",ex)}}},registerObserver:function(observer){if(!this._observers){this._observers=[observer];return}this._observers.push(observer)},closeObservers:function(){if(!this._observers){return}var observers=this._observers;for(var i=0;i<observers.length;i++){var observer=observers[i];if(observer&&typeof observer.close=="function"){observer.close()}}this._observers=[]},registerNamedObserver:function(name,observer){var o$=this._namedObservers||(this._namedObservers={});o$[name]=observer},closeNamedObserver:function(name){var o$=this._namedObservers;if(o$&&o$[name]){o$[name].close();o$[name]=null;return true}},closeNamedObservers:function(){if(this._namedObservers){for(var i in this._namedObservers){this.closeNamedObserver(i)}this._namedObservers={}}}};var LOG_OBSERVE="[%s] watching [%s]";var LOG_OBSERVED="[%s#%s] watch: [%s] now [%s] was [%s]";var LOG_CHANGED="[%s#%s] propertyChanged: [%s] now [%s] was [%s]";scope.api.instance.properties=properties})(Polymer);</script><script>(function(scope){var log=window.WebComponents?WebComponents.flags.log:{};var mdv={instanceTemplate:function(template){HTMLTemplateElement.decorate(template);var syntax=this.syntax||!template.bindingDelegate&&this.element.syntax;var dom=template.createInstance(this,syntax);var observers=dom.bindings_;for(var i=0;i<observers.length;i++){this.registerObserver(observers[i])}return dom},bind:function(name,observable,oneTime){var property=this.propertyForAttribute(name);if(!property){return this.mixinSuper(arguments)}else{var observer=this.bindProperty(property,observable,oneTime);if(Platform.enableBindingsReflection&&observer){observer.path=observable.path_;this._recordBinding(property,observer)}if(this.reflect[property]){this.reflectPropertyToAttribute(property)}return observer}},_recordBinding:function(name,observer){this.bindings_=this.bindings_||{};this.bindings_[name]=observer},bindFinished:function(){this.makeElementReady()},asyncUnbindAll:function(){if(!this._unbound){log.unbind&&console.log("[%s] asyncUnbindAll",this.localName);this._unbindAllJob=this.job(this._unbindAllJob,this.unbindAll,0)}},unbindAll:function(){if(!this._unbound){this.closeObservers();this.closeNamedObservers();this._unbound=true}},cancelUnbindAll:function(){if(this._unbound){log.unbind&&console.warn("[%s] already unbound, cannot cancel unbindAll",this.localName);return}log.unbind&&console.log("[%s] cancelUnbindAll",this.localName);if(this._unbindAllJob){this._unbindAllJob=this._unbindAllJob.stop()}}};function unbindNodeTree(node){forNodeTree(node,_nodeUnbindAll)}function _nodeUnbindAll(node){node.unbindAll()}function forNodeTree(node,callback){if(node){callback(node);for(var child=node.firstChild;child;child=child.nextSibling){forNodeTree(child,callback)}}}var mustachePattern=/\{\{([^{}]*)}}/;scope.bindPattern=mustachePattern;scope.api.instance.mdv=mdv})(Polymer);</script><script>(function(scope){var base={PolymerBase:true,job:function(job,callback,wait){if(typeof job==="string"){var n="___"+job;this[n]=Polymer.job.call(this,this[n],callback,wait)}else{return Polymer.job.call(this,job,callback,wait)}},"super":Polymer.super,created:function(){},ready:function(){},createdCallback:function(){if(this.templateInstance&&this.templateInstance.model){console.warn("Attributes on "+this.localName+" were data bound "+"prior to Polymer upgrading the element. This may result in "+"incorrect binding types.")}this.created();this.prepareElement();if(!this.ownerDocument.isStagingDocument){this.makeElementReady()}},prepareElement:function(){if(this._elementPrepared){console.warn("Element already prepared",this.localName);return}this._elementPrepared=true;this.shadowRoots={};this.createPropertyObserver();this.openPropertyObserver();this.copyInstanceAttributes();this.takeAttributes();this.addHostListeners()},makeElementReady:function(){if(this._readied){return}this._readied=true;this.createComputedProperties();this.parseDeclarations(this.__proto__);this.removeAttribute("unresolved");this.ready()},attributeChangedCallback:function(name,oldValue){if(name!=="class"&&name!=="style"){this.attributeToProperty(name,this.getAttribute(name))}if(this.attributeChanged){this.attributeChanged.apply(this,arguments)}},attachedCallback:function(){this.cancelUnbindAll();if(this.attached){this.attached()}if(!this.hasBeenAttached){this.hasBeenAttached=true;if(this.domReady){this.async("domReady")}}},detachedCallback:function(){if(!this.preventDispose){this.asyncUnbindAll()}if(this.detached){this.detached()}if(this.leftView){this.leftView()}},parseDeclarations:function(p){if(p&&p.element){this.parseDeclarations(p.__proto__);p.parseDeclaration.call(this,p.element)}},parseDeclaration:function(elementElement){var template=this.fetchTemplate(elementElement);if(template){var root=this.shadowFromTemplate(template);this.shadowRoots[elementElement.name]=root}},fetchTemplate:function(elementElement){return elementElement.querySelector("template")},shadowFromTemplate:function(template){if(template){var root=this.createShadowRoot();var dom=this.instanceTemplate(template);root.appendChild(dom);this.shadowRootReady(root,template);return root}},lightFromTemplate:function(template,refNode){if(template){this.eventController=this;var dom=this.instanceTemplate(template);if(refNode){this.insertBefore(dom,refNode)}else{this.appendChild(dom)}this.shadowRootReady(this);return dom}},shadowRootReady:function(root){this.marshalNodeReferences(root)},marshalNodeReferences:function(root){var $=this.$=this.$||{};if(root){var n$=root.querySelectorAll("[id]");for(var i=0,l=n$.length,n;i<l&&(n=n$[i]);i++){$[n.id]=n}}},onMutation:function(node,listener){var observer=new MutationObserver(function(mutations){listener.call(this,observer,mutations);observer.disconnect()}.bind(this));observer.observe(node,{childList:true,subtree:true})}};function isBase(object){return object.hasOwnProperty("PolymerBase")}function PolymerBase(){}PolymerBase.prototype=base;base.constructor=PolymerBase;scope.Base=PolymerBase;scope.isBase=isBase;scope.api.instance.base=base})(Polymer);</script><script>(function(scope){var log=window.WebComponents?WebComponents.flags.log:{};var hasShadowDOMPolyfill=window.ShadowDOMPolyfill;var STYLE_SCOPE_ATTRIBUTE="element";var STYLE_CONTROLLER_SCOPE="controller";var styles={STYLE_SCOPE_ATTRIBUTE:STYLE_SCOPE_ATTRIBUTE,installControllerStyles:function(){var scope=this.findStyleScope();if(scope&&!this.scopeHasNamedStyle(scope,this.localName)){var proto=getPrototypeOf(this),cssText="";while(proto&&proto.element){cssText+=proto.element.cssTextForScope(STYLE_CONTROLLER_SCOPE);proto=getPrototypeOf(proto)}if(cssText){this.installScopeCssText(cssText,scope)}}},installScopeStyle:function(style,name,scope){var scope=scope||this.findStyleScope(),name=name||"";if(scope&&!this.scopeHasNamedStyle(scope,this.localName+name)){var cssText="";if(style instanceof Array){for(var i=0,l=style.length,s;i<l&&(s=style[i]);i++){cssText+=s.textContent+"\n\n"}}else{cssText=style.textContent}this.installScopeCssText(cssText,scope,name)}},installScopeCssText:function(cssText,scope,name){scope=scope||this.findStyleScope();name=name||"";if(!scope){return}if(hasShadowDOMPolyfill){cssText=shimCssText(cssText,scope.host)}var style=this.element.cssTextToScopeStyle(cssText,STYLE_CONTROLLER_SCOPE);Polymer.applyStyleToScope(style,scope);this.styleCacheForScope(scope)[this.localName+name]=true},findStyleScope:function(node){var n=node||this;while(n.parentNode){n=n.parentNode}return n},scopeHasNamedStyle:function(scope,name){var cache=this.styleCacheForScope(scope);return cache[name]},styleCacheForScope:function(scope){if(hasShadowDOMPolyfill){var scopeName=scope.host?scope.host.localName:scope.localName;return polyfillScopeStyleCache[scopeName]||(polyfillScopeStyleCache[scopeName]={})}else{return scope._scopeStyles=scope._scopeStyles||{}}}};var polyfillScopeStyleCache={};function getPrototypeOf(prototype){return prototype.__proto__}function shimCssText(cssText,host){var name="",is=false;if(host){name=host.localName;is=host.hasAttribute("is")}var selector=WebComponents.ShadowCSS.makeScopeSelector(name,is);return WebComponents.ShadowCSS.shimCssText(cssText,selector)}scope.api.instance.styles=styles})(Polymer);</script><script>(function(scope){var extend=scope.extend;var api=scope.api;function element(name,prototype){if(typeof name!=="string"){var script=prototype||document._currentScript;prototype=name;name=script&&script.parentNode&&script.parentNode.getAttribute?script.parentNode.getAttribute("name"):"";if(!name){throw"Element name could not be inferred."}}if(getRegisteredPrototype(name)){throw"Already registered (Polymer) prototype for element "+name}registerPrototype(name,prototype);notifyPrototype(name)}function waitingForPrototype(name,client){waitPrototype[name]=client}var waitPrototype={};function notifyPrototype(name){if(waitPrototype[name]){waitPrototype[name].registerWhenReady();delete waitPrototype[name]}}var prototypesByName={};function registerPrototype(name,prototype){return prototypesByName[name]=prototype||{}}function getRegisteredPrototype(name){return prototypesByName[name]}function instanceOfType(element,type){if(typeof type!=="string"){return false}var proto=HTMLElement.getPrototypeForTag(type);var ctor=proto&&proto.constructor;if(!ctor){return false}if(CustomElements.instanceof){return CustomElements.instanceof(element,ctor)}return element instanceof ctor}scope.getRegisteredPrototype=getRegisteredPrototype;scope.waitingForPrototype=waitingForPrototype;scope.instanceOfType=instanceOfType;window.Polymer=element;extend(Polymer,scope);if(WebComponents.consumeDeclarations){WebComponents.consumeDeclarations(function(declarations){if(declarations){for(var i=0,l=declarations.length,d;i<l&&(d=declarations[i]);i++){element.apply(null,d)}}})}})(Polymer);</script><script>(function(scope){var path={resolveElementPaths:function(node){Polymer.urlResolver.resolveDom(node)},addResolvePathApi:function(){var assetPath=this.getAttribute("assetpath")||"";var root=new URL(assetPath,this.ownerDocument.baseURI);this.prototype.resolvePath=function(urlPath,base){var u=new URL(urlPath,base||root);return u.href}}};scope.api.declaration.path=path})(Polymer);</script><script>(function(scope){var log=window.WebComponents?WebComponents.flags.log:{};var api=scope.api.instance.styles;var STYLE_SCOPE_ATTRIBUTE=api.STYLE_SCOPE_ATTRIBUTE;var hasShadowDOMPolyfill=window.ShadowDOMPolyfill;var STYLE_SELECTOR="style";var STYLE_LOADABLE_MATCH="@import";var SHEET_SELECTOR="link[rel=stylesheet]";var STYLE_GLOBAL_SCOPE="global";var SCOPE_ATTR="polymer-scope";var styles={loadStyles:function(callback){var template=this.fetchTemplate();var content=template&&this.templateContent();if(content){this.convertSheetsToStyles(content);var styles=this.findLoadableStyles(content);if(styles.length){var templateUrl=template.ownerDocument.baseURI;return Polymer.styleResolver.loadStyles(styles,templateUrl,callback)}}if(callback){callback()}},convertSheetsToStyles:function(root){var s$=root.querySelectorAll(SHEET_SELECTOR);for(var i=0,l=s$.length,s,c;i<l&&(s=s$[i]);i++){c=createStyleElement(importRuleForSheet(s,this.ownerDocument.baseURI),this.ownerDocument);this.copySheetAttributes(c,s);s.parentNode.replaceChild(c,s)}},copySheetAttributes:function(style,link){for(var i=0,a$=link.attributes,l=a$.length,a;(a=a$[i])&&i<l;i++){if(a.name!=="rel"&&a.name!=="href"){style.setAttribute(a.name,a.value)}}},findLoadableStyles:function(root){var loadables=[];if(root){var s$=root.querySelectorAll(STYLE_SELECTOR);for(var i=0,l=s$.length,s;i<l&&(s=s$[i]);i++){if(s.textContent.match(STYLE_LOADABLE_MATCH)){loadables.push(s)}}}return loadables},installSheets:function(){this.cacheSheets();this.cacheStyles();this.installLocalSheets();this.installGlobalStyles()},cacheSheets:function(){this.sheets=this.findNodes(SHEET_SELECTOR);this.sheets.forEach(function(s){if(s.parentNode){s.parentNode.removeChild(s)}})},cacheStyles:function(){this.styles=this.findNodes(STYLE_SELECTOR+"["+SCOPE_ATTR+"]");this.styles.forEach(function(s){if(s.parentNode){s.parentNode.removeChild(s)}})},installLocalSheets:function(){var sheets=this.sheets.filter(function(s){return!s.hasAttribute(SCOPE_ATTR)});var content=this.templateContent();if(content){var cssText="";sheets.forEach(function(sheet){cssText+=cssTextFromSheet(sheet)+"\n"});if(cssText){var style=createStyleElement(cssText,this.ownerDocument);content.insertBefore(style,content.firstChild)}}},findNodes:function(selector,matcher){var nodes=this.querySelectorAll(selector).array();var content=this.templateContent();if(content){var templateNodes=content.querySelectorAll(selector).array();nodes=nodes.concat(templateNodes)}return matcher?nodes.filter(matcher):nodes},installGlobalStyles:function(){var style=this.styleForScope(STYLE_GLOBAL_SCOPE);applyStyleToScope(style,document.head)},cssTextForScope:function(scopeDescriptor){var cssText="";var selector="["+SCOPE_ATTR+"="+scopeDescriptor+"]";var matcher=function(s){return matchesSelector(s,selector)};var sheets=this.sheets.filter(matcher);sheets.forEach(function(sheet){cssText+=cssTextFromSheet(sheet)+"\n\n"});var styles=this.styles.filter(matcher);styles.forEach(function(style){cssText+=style.textContent+"\n\n"});return cssText},styleForScope:function(scopeDescriptor){var cssText=this.cssTextForScope(scopeDescriptor);return this.cssTextToScopeStyle(cssText,scopeDescriptor)},cssTextToScopeStyle:function(cssText,scopeDescriptor){if(cssText){var style=createStyleElement(cssText);style.setAttribute(STYLE_SCOPE_ATTRIBUTE,this.getAttribute("name")+"-"+scopeDescriptor);return style}}};function importRuleForSheet(sheet,baseUrl){var href=new URL(sheet.getAttribute("href"),baseUrl).href;return"@import '"+href+"';"}function applyStyleToScope(style,scope){if(style){if(scope===document){scope=document.head}if(hasShadowDOMPolyfill){scope=document.head}var clone=createStyleElement(style.textContent);var attr=style.getAttribute(STYLE_SCOPE_ATTRIBUTE);if(attr){clone.setAttribute(STYLE_SCOPE_ATTRIBUTE,attr)}var refNode=scope.firstElementChild;if(scope===document.head){var selector="style["+STYLE_SCOPE_ATTRIBUTE+"]";var s$=document.head.querySelectorAll(selector);if(s$.length){refNode=s$[s$.length-1].nextElementSibling}}scope.insertBefore(clone,refNode)}}function createStyleElement(cssText,scope){scope=scope||document;scope=scope.createElement?scope:scope.ownerDocument;var style=scope.createElement("style");style.textContent=cssText;return style}function cssTextFromSheet(sheet){return sheet&&sheet.__resource||""}function matchesSelector(node,inSelector){if(matches){return matches.call(node,inSelector)}}var p=HTMLElement.prototype;var matches=p.matches||p.matchesSelector||p.webkitMatchesSelector||p.mozMatchesSelector;scope.api.declaration.styles=styles;scope.applyStyleToScope=applyStyleToScope})(Polymer);</script><script>(function(scope){var log=window.WebComponents?WebComponents.flags.log:{};var api=scope.api.instance.events;var EVENT_PREFIX=api.EVENT_PREFIX;var mixedCaseEventTypes={};["webkitAnimationStart","webkitAnimationEnd","webkitTransitionEnd","DOMFocusOut","DOMFocusIn","DOMMouseScroll"].forEach(function(e){mixedCaseEventTypes[e.toLowerCase()]=e});var events={parseHostEvents:function(){var delegates=this.prototype.eventDelegates;this.addAttributeDelegates(delegates)},addAttributeDelegates:function(delegates){for(var i=0,a;a=this.attributes[i];i++){if(this.hasEventPrefix(a.name)){delegates[this.removeEventPrefix(a.name)]=a.value.replace("{{","").replace("}}","").trim()}}},hasEventPrefix:function(n){return n&&n[0]==="o"&&n[1]==="n"&&n[2]==="-"},removeEventPrefix:function(n){return n.slice(prefixLength)},findController:function(node){while(node.parentNode){if(node.eventController){return node.eventController}node=node.parentNode}return node.host},getEventHandler:function(controller,target,method){var events=this;return function(e){if(!controller||!controller.PolymerBase){controller=events.findController(target)}var args=[e,e.detail,e.currentTarget];controller.dispatchMethod(controller,method,args)}},prepareEventBinding:function(pathString,name,node){if(!this.hasEventPrefix(name))return;var eventType=this.removeEventPrefix(name);eventType=mixedCaseEventTypes[eventType]||eventType;var events=this;return function(model,node,oneTime){var handler=events.getEventHandler(undefined,node,pathString);PolymerGestures.addEventListener(node,eventType,handler);if(oneTime)return;function bindingValue(){return"{{ "+pathString+" }}"}return{open:bindingValue,discardChanges:bindingValue,close:function(){PolymerGestures.removeEventListener(node,eventType,handler)}}}}};var prefixLength=EVENT_PREFIX.length;scope.api.declaration.events=events})(Polymer);</script><script>(function(scope){var observationBlacklist=["attribute"];var properties={inferObservers:function(prototype){var observe=prototype.observe,property;for(var n in prototype){if(n.slice(-7)==="Changed"){property=n.slice(0,-7);if(this.canObserveProperty(property)){if(!observe){observe=prototype.observe={}}observe[property]=observe[property]||n}}}},canObserveProperty:function(property){return observationBlacklist.indexOf(property)<0},explodeObservers:function(prototype){var o=prototype.observe;if(o){var exploded={};for(var n in o){var names=n.split(" ");for(var i=0,ni;ni=names[i];i++){exploded[ni]=o[n]}}prototype.observe=exploded}},optimizePropertyMaps:function(prototype){if(prototype.observe){var a=prototype._observeNames=[];for(var n in prototype.observe){var names=n.split(" ");for(var i=0,ni;ni=names[i];i++){a.push(ni)}}}if(prototype.publish){var a=prototype._publishNames=[];for(var n in prototype.publish){a.push(n)}}if(prototype.computed){var a=prototype._computedNames=[];for(var n in prototype.computed){a.push(n)}}},publishProperties:function(prototype,base){var publish=prototype.publish;if(publish){this.requireProperties(publish,prototype,base);this.filterInvalidAccessorNames(publish);prototype._publishLC=this.lowerCaseMap(publish)}var computed=prototype.computed;if(computed){this.filterInvalidAccessorNames(computed)}},filterInvalidAccessorNames:function(propertyNames){for(var name in propertyNames){if(this.propertyNameBlacklist[name]){console.warn('Cannot define property "'+name+'" for element "'+this.name+'" because it has the same name as an HTMLElement '+"property, and not all browsers support overriding that. "+"Consider giving it a different name.");delete propertyNames[name]}}},requireProperties:function(propertyInfos,prototype,base){prototype.reflect=prototype.reflect||{};for(var n in propertyInfos){var value=propertyInfos[n];if(value&&value.reflect!==undefined){prototype.reflect[n]=Boolean(value.reflect);value=value.value}if(value!==undefined){prototype[n]=value}}},lowerCaseMap:function(properties){var map={};for(var n in properties){map[n.toLowerCase()]=n}return map},createPropertyAccessor:function(name,ignoreWrites){var proto=this.prototype;var privateName=name+"_";var privateObservable=name+"Observable_";proto[privateName]=proto[name];Object.defineProperty(proto,name,{get:function(){var observable=this[privateObservable];if(observable)observable.deliver();return this[privateName]},set:function(value){if(ignoreWrites){return this[privateName]}var observable=this[privateObservable];if(observable){observable.setValue(value);return}var oldValue=this[privateName];this[privateName]=value;this.emitPropertyChangeRecord(name,value,oldValue);return value},configurable:true})},createPropertyAccessors:function(prototype){var n$=prototype._computedNames;if(n$&&n$.length){for(var i=0,l=n$.length,n,fn;i<l&&(n=n$[i]);i++){this.createPropertyAccessor(n,true)}}var n$=prototype._publishNames;if(n$&&n$.length){for(var i=0,l=n$.length,n,fn;i<l&&(n=n$[i]);i++){if(!prototype.computed||!prototype.computed[n]){this.createPropertyAccessor(n)}}}},propertyNameBlacklist:{children:1,"class":1,id:1,hidden:1,style:1,title:1}};scope.api.declaration.properties=properties})(Polymer);</script><script>(function(scope){var ATTRIBUTES_ATTRIBUTE="attributes";var ATTRIBUTES_REGEX=/\s|,/;var attributes={inheritAttributesObjects:function(prototype){this.inheritObject(prototype,"publishLC");this.inheritObject(prototype,"_instanceAttributes")},publishAttributes:function(prototype,base){var attributes=this.getAttribute(ATTRIBUTES_ATTRIBUTE);if(attributes){var publish=prototype.publish||(prototype.publish={});var names=attributes.split(ATTRIBUTES_REGEX);for(var i=0,l=names.length,n;i<l;i++){n=names[i].trim();if(n&&publish[n]===undefined){publish[n]=undefined}}}},accumulateInstanceAttributes:function(){var clonable=this.prototype._instanceAttributes;var a$=this.attributes;for(var i=0,l=a$.length,a;i<l&&(a=a$[i]);i++){if(this.isInstanceAttribute(a.name)){clonable[a.name]=a.value}}},isInstanceAttribute:function(name){return!this.blackList[name]&&name.slice(0,3)!=="on-"},blackList:{name:1,"extends":1,constructor:1,noscript:1,assetpath:1,"cache-csstext":1}};attributes.blackList[ATTRIBUTES_ATTRIBUTE]=1;scope.api.declaration.attributes=attributes})(Polymer);</script><script>(function(scope){var events=scope.api.declaration.events;var syntax=new PolymerExpressions;var prepareBinding=syntax.prepareBinding;syntax.prepareBinding=function(pathString,name,node){return events.prepareEventBinding(pathString,name,node)||prepareBinding.call(syntax,pathString,name,node)};var mdv={syntax:syntax,fetchTemplate:function(){return this.querySelector("template")},templateContent:function(){var template=this.fetchTemplate();return template&&template.content},installBindingDelegate:function(template){if(template){template.bindingDelegate=this.syntax}}};scope.api.declaration.mdv=mdv})(Polymer);</script><script>(function(scope){var api=scope.api;var isBase=scope.isBase;var extend=scope.extend;var hasShadowDOMPolyfill=window.ShadowDOMPolyfill;var prototype={register:function(name,extendeeName){this.buildPrototype(name,extendeeName);this.registerPrototype(name,extendeeName);this.publishConstructor()},buildPrototype:function(name,extendeeName){var extension=scope.getRegisteredPrototype(name);var base=this.generateBasePrototype(extendeeName);this.desugarBeforeChaining(extension,base);this.prototype=this.chainPrototypes(extension,base);this.desugarAfterChaining(name,extendeeName)},desugarBeforeChaining:function(prototype,base){prototype.element=this;this.publishAttributes(prototype,base);this.publishProperties(prototype,base);this.inferObservers(prototype);this.explodeObservers(prototype)},chainPrototypes:function(prototype,base){this.inheritMetaData(prototype,base);var chained=this.chainObject(prototype,base);ensurePrototypeTraversal(chained);return chained},inheritMetaData:function(prototype,base){this.inheritObject("observe",prototype,base);this.inheritObject("publish",prototype,base);this.inheritObject("reflect",prototype,base);this.inheritObject("_publishLC",prototype,base);this.inheritObject("_instanceAttributes",prototype,base);this.inheritObject("eventDelegates",prototype,base)},desugarAfterChaining:function(name,extendee){this.optimizePropertyMaps(this.prototype);this.createPropertyAccessors(this.prototype);this.installBindingDelegate(this.fetchTemplate());this.installSheets();this.resolveElementPaths(this);this.accumulateInstanceAttributes();this.parseHostEvents();this.addResolvePathApi();if(hasShadowDOMPolyfill){WebComponents.ShadowCSS.shimStyling(this.templateContent(),name,extendee)}if(this.prototype.registerCallback){this.prototype.registerCallback(this)}},publishConstructor:function(){var symbol=this.getAttribute("constructor");if(symbol){window[symbol]=this.ctor}},generateBasePrototype:function(extnds){var prototype=this.findBasePrototype(extnds);if(!prototype){var prototype=HTMLElement.getPrototypeForTag(extnds);prototype=this.ensureBaseApi(prototype);memoizedBases[extnds]=prototype}return prototype},findBasePrototype:function(name){return memoizedBases[name]},ensureBaseApi:function(prototype){if(prototype.PolymerBase){return prototype}var extended=Object.create(prototype);api.publish(api.instance,extended);this.mixinMethod(extended,prototype,api.instance.mdv,"bind");return extended},mixinMethod:function(extended,prototype,api,name){var $super=function(args){return prototype[name].apply(this,args)};extended[name]=function(){this.mixinSuper=$super;return api[name].apply(this,arguments)}},inheritObject:function(name,prototype,base){var source=prototype[name]||{};prototype[name]=this.chainObject(source,base[name])},registerPrototype:function(name,extendee){var info={prototype:this.prototype};var typeExtension=this.findTypeExtension(extendee);if(typeExtension){info.extends=typeExtension}HTMLElement.register(name,this.prototype);this.ctor=document.registerElement(name,info)},findTypeExtension:function(name){if(name&&name.indexOf("-")<0){return name}else{var p=this.findBasePrototype(name);if(p.element){return this.findTypeExtension(p.element.extends)}}}};var memoizedBases={};if(Object.__proto__){prototype.chainObject=function(object,inherited){if(object&&inherited&&object!==inherited){object.__proto__=inherited}return object}}else{prototype.chainObject=function(object,inherited){if(object&&inherited&&object!==inherited){var chained=Object.create(inherited);object=extend(chained,object)}return object}}function ensurePrototypeTraversal(prototype){if(!Object.__proto__){var ancestor=Object.getPrototypeOf(prototype);prototype.__proto__=ancestor;if(isBase(ancestor)){ancestor.__proto__=Object.getPrototypeOf(ancestor)}}}api.declaration.prototype=prototype})(Polymer);</script><script>(function(scope){var queue={wait:function(element){if(!element.__queue){element.__queue={};elements.push(element)}},enqueue:function(element,check,go){var shouldAdd=element.__queue&&!element.__queue.check;if(shouldAdd){queueForElement(element).push(element);element.__queue.check=check;element.__queue.go=go}return this.indexOf(element)!==0},indexOf:function(element){var i=queueForElement(element).indexOf(element);if(i>=0&&document.contains(element)){i+=HTMLImports.useNative||HTMLImports.ready?importQueue.length:1e9}return i},go:function(element){var readied=this.remove(element);if(readied){element.__queue.flushable=true;this.addToFlushQueue(readied);this.check()}},remove:function(element){var i=this.indexOf(element);if(i!==0){return}return queueForElement(element).shift()},check:function(){var element=this.nextElement();if(element){element.__queue.check.call(element)}if(this.canReady()){this.ready();return true}},nextElement:function(){return nextQueued()},canReady:function(){return!this.waitToReady&&this.isEmpty()},isEmpty:function(){for(var i=0,l=elements.length,e;i<l&&(e=elements[i]);i++){if(e.__queue&&!e.__queue.flushable){return}}return true},addToFlushQueue:function(element){flushQueue.push(element)},flush:function(){if(this.flushing){return}this.flushing=true;var element;while(flushQueue.length){element=flushQueue.shift();element.__queue.go.call(element);element.__queue=null}this.flushing=false},ready:function(){var polyfillWasReady=CustomElements.ready;CustomElements.ready=false;this.flush();if(!CustomElements.useNative){CustomElements.upgradeDocumentTree(document)}CustomElements.ready=polyfillWasReady;Polymer.flush();requestAnimationFrame(this.flushReadyCallbacks)},addReadyCallback:function(callback){if(callback){readyCallbacks.push(callback)}},flushReadyCallbacks:function(){if(readyCallbacks){var fn;while(readyCallbacks.length){fn=readyCallbacks.shift();fn()}}},waitingFor:function(){var e$=[];for(var i=0,l=elements.length,e;i<l&&(e=elements[i]);i++){if(e.__queue&&!e.__queue.flushable){e$.push(e)}}return e$},waitToReady:true};var elements=[];var flushQueue=[];var importQueue=[];var mainQueue=[];var readyCallbacks=[];function queueForElement(element){return document.contains(element)?mainQueue:importQueue}function nextQueued(){return importQueue.length?importQueue[0]:mainQueue[0]}function whenReady(callback){queue.waitToReady=true;Polymer.endOfMicrotask(function(){HTMLImports.whenReady(function(){queue.addReadyCallback(callback);queue.waitToReady=false;queue.check()})})}function forceReady(timeout){if(timeout===undefined){queue.ready();return}var handle=setTimeout(function(){queue.ready()},timeout);Polymer.whenReady(function(){clearTimeout(handle)})}scope.elements=elements;scope.waitingFor=queue.waitingFor.bind(queue);scope.forceReady=forceReady;scope.queue=queue;scope.whenReady=scope.whenPolymerReady=whenReady})(Polymer);</script><script>(function(scope){var extend=scope.extend;var api=scope.api;var queue=scope.queue;var whenReady=scope.whenReady;var getRegisteredPrototype=scope.getRegisteredPrototype;var waitingForPrototype=scope.waitingForPrototype;var prototype=extend(Object.create(HTMLElement.prototype),{createdCallback:function(){if(this.getAttribute("name")){this.init()}},init:function(){this.name=this.getAttribute("name");this.extends=this.getAttribute("extends");queue.wait(this);this.loadResources();this.registerWhenReady()},registerWhenReady:function(){if(this.registered||this.waitingForPrototype(this.name)||this.waitingForQueue()||this.waitingForResources()){return}queue.go(this)},_register:function(){if(isCustomTag(this.extends)&&!isRegistered(this.extends)){console.warn("%s is attempting to extend %s, an unregistered element "+"or one that was not registered with Polymer.",this.name,this.extends)}this.register(this.name,this.extends);this.registered=true},waitingForPrototype:function(name){if(!getRegisteredPrototype(name)){waitingForPrototype(name,this);this.handleNoScript(name);return true}},handleNoScript:function(name){if(this.hasAttribute("noscript")&&!this.noscript){this.noscript=true;Polymer(name)}},waitingForResources:function(){return this._needsResources},waitingForQueue:function(){return queue.enqueue(this,this.registerWhenReady,this._register)},loadResources:function(){this._needsResources=true;this.loadStyles(function(){this._needsResources=false;this.registerWhenReady()}.bind(this))}});api.publish(api.declaration,prototype);function isRegistered(name){return Boolean(HTMLElement.getPrototypeForTag(name))}function isCustomTag(name){return name&&name.indexOf("-")>=0}whenReady(function(){document.body.removeAttribute("unresolved");document.dispatchEvent(new CustomEvent("polymer-ready",{bubbles:true}))});document.registerElement("polymer-element",{prototype:prototype})})(Polymer);</script><script>(function(scope){var whenReady=scope.whenReady;function importElements(node,callback){if(node){document.head.appendChild(node);whenReady(callback)}else if(callback){callback()}}function _import(urls,callback){if(urls&&urls.length){var frag=document.createDocumentFragment();for(var i=0,l=urls.length,url,link;i<l&&(url=urls[i]);i++){link=document.createElement("link");link.rel="import";link.href=url;frag.appendChild(link)}importElements(frag,callback)}else if(callback){callback()}}scope.import=_import;scope.importElements=importElements})(Polymer);</script><script>(function(){var element=document.createElement("polymer-element");element.setAttribute("name","auto-binding");element.setAttribute("extends","template");element.init();Polymer("auto-binding",{createdCallback:function(){this.syntax=this.bindingDelegate=this.makeSyntax();Polymer.whenPolymerReady(function(){this.model=this;this.setAttribute("bind","");this.async(function(){this.marshalNodeReferences(this.parentNode);this.fire("template-bound")})}.bind(this))},makeSyntax:function(){var events=Object.create(Polymer.api.declaration.events);var self=this;events.findController=function(){return self.model};var syntax=new PolymerExpressions;var prepareBinding=syntax.prepareBinding;syntax.prepareBinding=function(pathString,name,node){return events.prepareEventBinding(pathString,name,node)||prepareBinding.call(syntax,pathString,name,node)};return syntax}})})();</script><polymer-element name="fin-rectangle" assetpath="../fin-rectangle/"><script>"use strict";(function(){function rectangleContains(rect,x,y){var minX=rect.origin.x;var minY=rect.origin.y;var maxX=minX+rect.extent.x;var maxY=minY+rect.extent.y;if(rect.extent.x<0){minX=maxX;maxX=rect.origin.x}if(rect.extent.y<0){minY=maxY;maxY=rect.origin.y}var result=x>=minX&&y>=minY&&x<=maxX&&y<=maxY;return result}function createPoint(x,y){var that={};Object.defineProperty(that,"x",{value:x||0,writable:false,enumerable:true,configurable:false});Object.defineProperty(that,"y",{value:y||0,writable:false,enumerable:true,configurable:false});that.plus=function(point){var result=createPoint(this.x+point.x,y+point.y);return result};that.minus=function(point){var result=createPoint(x-point.x,y-point.y);return result};that.min=function(point){var result=createPoint(Math.min(x,point.x),Math.min(y,point.y));return result};that.max=function(point){var result=createPoint(Math.max(x,point.x),Math.max(y,point.y));return result};that.distance=function(point){var dx=point.x-x,dy=point.y-y,result=Math.sqrt(dx*dx+dy*dy);return result};that.greaterThan=function(point){var result=this.x>point.x&&y>point.y;return result};that.lessThan=function(point){var result=this.x<point.x&&y<point.y;return result};that.greaterThanEqualTo=function(point){var result=this.x>=point.x&&y>=point.y;return result};that.lessThanEqualTo=function(point){var result=this.x<=point.x&&y<=point.y;return result};that.isContainedWithinRectangle=function(rect){return rectangleContains(rect,this.x,this.y)};return that}function createRectangle(x,y,width,height){var that={};var origin=createPoint(x,y);var extent=createPoint(width,height);var corner=createPoint(x+width,y+height);var center=createPoint(x+width/2,y+height/2);Object.defineProperty(that,"origin",{value:origin,writable:false,enumerable:true,configurable:false});Object.defineProperty(that,"extent",{value:extent,writable:false,enumerable:true,configurable:false});Object.defineProperty(that,"corner",{value:corner,writable:false,enumerable:true,configurable:false});Object.defineProperty(that,"center",{value:center,writable:false,enumerable:true,configurable:false});that.top=function(){return this.origin.y};that.left=function(){return this.origin.x};that.bottom=function(){return this.top()+this.extent.y};that.right=function(){return this.left()+this.extent.x};that.width=function(){return this.extent.x};that.height=function(){return this.extent.y};that.area=function(){return this.extent.x*this.extent.y};that.flattenXAt=function(x){var o=this.origin;var e=this.extent;return createRectangle(x,o.y,0,e.y)};that.flattenYAt=function(y){var o=this.origin;var e=this.extent;return createRectangle(o.x,y,e.x,0)};that.contains=function(pointOrRect){var result=pointOrRect.isContainedWithinRectangle(this);return result};that.isContainedWithinRectangle=function(rect){var result=rect.origin.lessThanEqualTo(this.origin)&&rect.corner.greaterThanEqualTo(this.corner);return result};that.insetBy=function(thickness){var result=createRectangle(this.origin.x+thickness,this.origin.y+thickness,this.extent.x-2*thickness,this.extent.y-2*thickness);return result};that.union=function(rectangle){var anOrigin=this.origin.min(rectangle.origin),aCorner=this.corner.max(rectangle.corner),width=aCorner.x-anOrigin.x,height=aCorner.y-anOrigin.y,result=createRectangle(anOrigin.x,anOrigin.y,width,height);return result};that.forEach=function(func){var xstart=this.origin.x;var xstop=this.origin.x+this.extent.x;var ystart=this.origin.y;var ystop=this.origin.y+this.extent.y;for(var x=xstart;x<xstop;x++){for(var y=ystart;y<ystop;y++){func(x,y)}}};that.intersect=function(rectangle,ifNoneAction){var point=rectangle.origin,myCorner=this.corner,left=null,right=null,top=null,bottom=null,result=null;if(ifNoneAction&&!this.intersects(rectangle)){return ifNoneAction.call(this,rectangle)}if(point.x>this.origin.x){left=point.x}else{left=this.origin.x}if(point.y>this.origin.y){top=point.y}else{top=this.origin.y}point=rectangle.corner;if(point.x<myCorner.x){right=point.x}else{right=myCorner.x}if(point.y<myCorner.y){bottom=point.y}else{bottom=myCorner.y}result=createRectangle(left,top,right-left,bottom-top);return result};that.intersects=function(rectangle){var rOrigin=rectangle.origin,rCorner=rectangle.corner;if(rCorner.x<=this.origin.x){return false}if(rCorner.y<=this.origin.y){return false}if(rOrigin.x>=this.corner.x){return false}if(rOrigin.y>=this.corner.y){return false}return true};return that}Polymer("fin-rectangle",{point:{create:createPoint},rectangle:{create:createRectangle,contains:rectangleContains}})})();</script></polymer-element><polymer-element name="fin-canvas" assetpath="../fin-canvas/"><template><style>:host{overflow:hidden;position:absolute;top:0;right:0;bottom:0;left:0}button{position:fixed;top:0;left:0;height:0;width:0;border:none;color:transparent;background-color:transparent;outline:0}div.container{position:relative;top:0;right:0;bottom:0;left:0}</style><button></button><canvas class="canvas" on-tap="{{fintap}}" on-hold="{{finhold}}" on-holdpulse="{{finholdpulse}}" on-flick="{{finflick}}" on-release="{{finrelease}}" on-trackstart="{{fintrackstart}}" on-track="{{fintrack}}" on-trackend="{{fintrackend}}"></canvas></template><script>"use strict";(function(){var charMap=[];var empty=["",""];for(var i=0;i<256;i++){charMap[i]=empty}charMap[27]=["ESC","ESCSHIFT"];charMap[192]=["`","~"];charMap[49]=["1","!"];charMap[50]=["2","@"];charMap[51]=["3","#"];charMap[52]=["4","$"];charMap[53]=["5","%"];charMap[54]=["6","^"];charMap[55]=["7","&"];charMap[56]=["8","*"];charMap[57]=["9","("];charMap[48]=["0",")"];charMap[189]=["-","_"];charMap[187]=["=","+"];charMap[8]=["DELETE","DELETESHIFT"];charMap[9]=["TAB","TABSHIFT"];charMap[81]=["q","Q"];charMap[87]=["w","W"];charMap[69]=["e","E"];charMap[82]=["r","R"];charMap[84]=["t","T"];charMap[89]=["y","Y"];charMap[85]=["u","U"];charMap[73]=["i","I"];charMap[79]=["o","O"];charMap[80]=["p","P"];charMap[219]=["[","{"];charMap[221]=["]","}"];charMap[220]=["\\","|"];charMap[220]=["CAPSLOCK","CAPSLOCKSHIFT"];charMap[65]=["a","A"];charMap[83]=["s","S"];charMap[68]=["d","D"];charMap[70]=["f","F"];charMap[71]=["g","G"];charMap[72]=["h","H"];charMap[74]=["j","J"];charMap[75]=["k","K"];charMap[76]=["l","L"];charMap[186]=[";",":"];charMap[222]=["'","|"];charMap[13]=["RETURN","RETURNSHIFT"];charMap[16]=["SHIFT","SHIFT"];charMap[90]=["z","Z"];charMap[88]=["x","X"];charMap[67]=["c","C"];charMap[86]=["v","V"];charMap[66]=["b","B"];charMap[78]=["n","N"];charMap[77]=["m","M"];charMap[188]=[",","<"];charMap[190]=[".",">"];charMap[191]=["/","?"];charMap[16]=["SHIFT","SHIFT"];charMap[17]=["CTRL","CTRLSHIFT"];charMap[18]=["ALT","ALTSHIFT"];charMap[91]=["COMMANDLEFT","COMMANDLEFTSHIFT"];charMap[32]=["SPACE","SPACESHIFT"];charMap[93]=["COMMANDRIGHT","COMMANDRIGHTSHIFT"];charMap[18]=["ALT","ALTSHIFT"];charMap[38]=["UP","UPSHIFT"];charMap[37]=["LEFT","LEFTSHIFT"];charMap[40]=["DOWN","DOWNSHIFT"];charMap[39]=["RIGHT","RIGHTSHIFT"];Polymer("fin-canvas",{g:null,canvas:null,cavasCTX:null,focuser:null,buffer:null,ctx:null,fps:null,mouseLocation:null,holdPulseCount:-1,dragstart:null,origin:null,bounds:null,repaintNow:false,size:null,mousedown:false,dragging:false,focused:false,repeatKeyCount:0,repeatKey:null,repeatKeyStartTime:0,currentKeys:[],hasMouse:false,ready:function(){var self=this;this.g=document.createElement("fin-rectangle");this.canvas=this.shadowRoot.querySelector(".canvas");this.focuser=this.shadowRoot.querySelector("button");this.canvasCTX=this.canvas.getContext("2d");this.buffer=document.createElement("canvas");this.bufferCTX=this.buffer.getContext("2d");this.fps=this.getAttribute("fps")||60;this.mouseLocation=this.g.point.create(-1,-1);this.dragstart=this.g.point.create(-1,-1);this.origin=this.g.point.create(0,0);this.bounds=this.g.rectangle.create(0,0,0,0);this.hasMouse=false;this.onmouseover=function(){self.hasMouse=true};document.addEventListener("mousemove",function(e){if(!self.hasMouse&&!self.isDragging()){return}self.finmousemove(e)});document.addEventListener("mouseup",function(e){self.finmouseup(e)});document.addEventListener("wheel",function(e){self.finwheelmoved(e)});this.focuser.addEventListener("focus",function(e){self.finfocusgained(e)});this.focuser.addEventListener("blur",function(e){self.finfocuslost(e)});this.addEventListener("mousedown",function(e){self.finmousedown(e)});this.addEventListener("mouseout",function(e){self.hasMouse=false;self.finmouseout(e)});document.addEventListener("keydown",function(e){self.finkeydown(e)});document.addEventListener("keyup",function(e){self.finkeyup(e)});this.addEventListener("click",function(e){self.finclick(e)});this.addEventListener("dblclick",function(e){self.findblclick(e)});this.resize();this.beginPainting()},isHiDPI:function(){return this.getAttribute("hidpi")!==null},getComponent:function(){var comp=this.children[0];return comp},beginPainting:function(){var self=this;self.repaintNow=true;var interval=1e3/this.fps;var lastRepaintTime=0;var animate=function(now){self.checksize();var delta=now-lastRepaintTime;if(delta>interval&&self.repaintNow){lastRepaintTime=now-delta%interval;self.paintNow()}requestAnimationFrame(animate)};requestAnimationFrame(animate)},checksize:function(){var sizeNow=this.getBoundingClientRect();if(sizeNow.width!==this.size.width||sizeNow.height!==this.size.height){this.sizeChangedNotification()}},sizeChangedNotification:function(){this.resize()},resize:function(){this.size=this.getBoundingClientRect();this.canvas.width=this.clientWidth;this.canvas.height=this.clientHeight;this.buffer.width=this.clientWidth;this.buffer.height=this.clientHeight;var ratio=1;if(window.devicePixelRatio&&this.isHiDPI()){var devicePixelRatio=window.devicePixelRatio||1;var backingStoreRatio=this.canvasCTX.webkitBackingStorePixelRatio||this.canvasCTX.mozBackingStorePixelRatio||this.canvasCTX.msBackingStorePixelRatio||this.canvasCTX.oBackingStorePixelRatio||this.canvasCTX.backingStorePixelRatio||1;ratio=devicePixelRatio/backingStoreRatio}var width=this.canvas.getAttribute("width");var height=this.canvas.getAttribute("height");this.canvas.width=width*ratio;this.canvas.height=height*ratio;this.buffer.width=width*ratio;this.buffer.height=height*ratio;this.canvas.style.width=width+"px";this.canvas.style.height=height+"px";this.buffer.style.width=width+"px";this.buffer.style.height=height+"px";this.bufferCTX.scale(ratio,ratio);this.origin=this.g.point.create(Math.round(this.size.left),Math.round(this.size.top));this.bounds=this.g.rectangle.create(0,0,this.size.width,this.size.height);var comp=this.getComponent();if(comp){comp.setBounds(this.bounds)}this.resizeNotification();this.paintNow()},resizeNotification:function(){},getBounds:function(){return this.bounds},paintNow:function(){var gc=this.bufferCTX;try{gc.save();gc.clearRect(0,0,this.canvas.width,this.canvas.height);this.paint(gc)}finally{gc.restore()}this.flushBuffer();this.repaintNow=false},flushBuffer:function(){if(this.buffer.width>0&&this.buffer.height>0){this.canvasCTX.drawImage(this.buffer,0,0)}},paint:function(gc){var comp=this.getComponent();if(comp){comp._paint(gc)}},finmousemove:function(e){var o=this.getOrigin();if(!this.isDragging()&&this.mousedown){this.beDragging();this.dispatchEvent(new CustomEvent("fin-dragstart",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}));this.dragstart=this.g.point.create(this.mouseLocation.x,this.mouseLocation.y)}this.mouseLocation=this.g.point.create(e.clientX-o.x,e.clientY-o.y);if(this.isDragging()){this.dispatchEvent(new CustomEvent("fin-drag",{detail:{mouse:this.mouseLocation,dragstart:this.dragstart,keys:this.currentKeys}}))}if(this.bounds.contains(this.mouseLocation)){this.dispatchEvent(new CustomEvent("fin-mousemove",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))}},finmousedown:function(e){var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.clientX-o.x,e.clientY-o.y);this.mousedown=true;this.dispatchEvent(new CustomEvent("fin-mousedown",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}));this.takeFocus()},finmouseup:function(){if(this.isDragging()){this.dispatchEvent(new CustomEvent("fin-dragend",{detail:{mouse:this.mouseLocation,dragstart:this.dragstart,keys:this.currentKeys}}));this.beNotDragging()}this.mousedown=false;this.mouseLocation=this.g.point.create(-1,-1);this.dispatchEvent(new CustomEvent("fin-mouseup",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},finmouseout:function(){if(!this.mousedown){this.mouseLocation=this.g.point.create(-1,-1)}this.dispatchEvent(new CustomEvent("fin-mouseout",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},finwheelmoved:function(e){if(this.isDragging()||!this.hasFocus()){return}e.preventDefault();this.dispatchEvent(new CustomEvent("fin-wheelmoved",{detail:{mouse:this.mouseLocation,keys:this.currentKeys,primitiveEvent:e}}))},finclick:function(e){this.mouseLocation=this.g.point.create(e.offsetX||e.layerX,e.offsetY||e.layerY);this.dispatchEvent(new CustomEvent("fin-click",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},finrelease:function(e){this.holdPulseCount=0;var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.x-o.x,e.y-o.y);this.dispatchEvent(new CustomEvent("fin-release",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},finflick:function(e){if(!this.hasFocus()){return}var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.x-o.x,e.y-o.y);this.dispatchEvent(new CustomEvent("fin-flick",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},fintap:function(e){var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.x-o.x,e.y-o.y);this.dispatchEvent(new CustomEvent("fin-tap",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},fintrackstart:function(e){if(!this.hasFocus()){return}var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.clientX-o.x,e.clientY-o.y);this.dispatchEvent(new CustomEvent("fin-trackstart",{detail:{mouse:this.mouseLocation,keys:this.currentKeys,primitiveEvent:e}}))},fintrack:function(e){if(!this.hasFocus()){return}var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.clientX-o.x,e.clientY-o.y);this.dispatchEvent(new CustomEvent("fin-track",{detail:{mouse:this.mouseLocation,keys:this.currentKeys,primitiveEvent:e}}))},fintrackend:function(e){var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.clientX-o.x,e.clientY-o.y);this.dispatchEvent(new CustomEvent("fin-trackend",{detail:{mouse:this.mouseLocation,keys:this.currentKeys,primitiveEvent:e}}))},finhold:function(e){var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.x-o.x,e.y-o.y);this.dispatchEvent(new CustomEvent("fin-hold",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},finholdpulse:function(e){var o=this.getOrigin();this.mouseLocation=this.g.point.create(e.x-o.x,e.y-o.y);this.dispatchEvent(new CustomEvent("fin-holdpulse",{detail:{mouse:this.mouseLocation,keys:this.currentKeys,count:this.holdPulseCount++}}))},findblclick:function(e){this.mouseLocation=this.g.point.create(e.offsetX||e.layerX,e.offsetY||e.layerY);this.dispatchEvent(new CustomEvent("fin-dblclick",{detail:{mouse:this.mouseLocation,keys:this.currentKeys}}))},finkeydown:function(e){if(!this.hasFocus()){return}var keyChar=e.shiftKey?charMap[e.keyCode][1]:charMap[e.keyCode][0];if(e.repeat){if(this.repeatKey===keyChar){this.repeatKeyCount++}else{this.repeatKey=keyChar;this.repeatKeyStartTime=Date.now()}}else{this.repeatKey=null;this.repeatKeyCount=0;this.repeatKeyStartTime=0}if(this.currentKeys.indexOf(keyChar)===-1){this.currentKeys.push(keyChar)}this.dispatchEvent(new CustomEvent("fin-keydown",{detail:{alt:e.altKey,ctrl:e.ctrlKey,"char":keyChar,code:e.charCode,key:e.keyCode,meta:e.metaKey,repeatCount:this.repeatKeyCount,repeatStartTime:this.repeatKeyStartTime,shift:e.shiftKey,identifier:e.keyIdentifier}}))},finkeyup:function(e){var keyChar=e.shiftKey?charMap[e.keyCode][1]:charMap[e.keyCode][0];this.currentKeys.splice(this.currentKeys.indexOf(keyChar),1);if(!this.hasFocus()){return}this.repeatKeyCount=0;this.repeatKey=null;this.repeatKeyStartTime=0;this.dispatchEvent(new CustomEvent("fin-keyup",{detail:{alt:e.altKey,ctrl:e.ctrlKey,"char":keyChar,code:e.charCode,key:e.keyCode,meta:e.metaKey,repeat:e.repeat,shift:e.shiftKey,identifier:e.keyIdentifier}}))},finfocusgained:function(e){this.focused=true;this.dispatchEvent(new CustomEvent("fin-focus-gained",{detail:{e:e}}))},finfocuslost:function(e){this.focused=false;this.dispatchEvent(new CustomEvent("fin-focus-lost",{detail:{e:e}}))},repaint:function(){this.repaintNow=true},getMouseLocation:function(){return this.mouseLocation},getOrigin:function(){return this.origin},hasFocus:function(){return this.focused},takeFocus:function(){var self=this;if(document.activeElement!==this.focuser){setTimeout(function(){self.focuser.focus()},10)}},beDragging:function(){this.dragging=true;this.disableDocumentElementSelection()},beNotDragging:function(){this.dragging=false;this.enableDocumentElementSelection()},isDragging:function(){return this.dragging},disableDocumentElementSelection:function(){var style=document.body.style;style.cssText=style.cssText+"-webkit-user-select: none"},enableDocumentElementSelection:function(){var style=document.body.style;style.cssText=style.cssText.replace("-webkit-user-select: none","")}})})();</script></polymer-element><polymer-element name="fin-vampire-bar" attributes="" assetpath="../fin-vampire-bar/"><template><style>.scroll-bar{width:13px;position:absolute;top:0;bottom:0;background-color:#E7E7E7;border:1px solid #DDD}.scroll-bar-gutter{position:absolute;top:0;bottom:0;right:0;left:0;margin-top:15px;margin-bottom:35px;border-radius:4px}.scroll-bar.horizontal{height:13px;width:100%;position:absolute;left:0;right:100%;top:100%}.horizontal .scroll-bar-gutter{position:absolute;top:0;bottom:0;right:0;left:0;margin-top:0;margin-bottom:0;margin-left:15px;margin-right:34px}.scroll-bar-up{position:absolute;top:1px;left:1px;width:12px;height:12px;background-color:#B6B6B6;border-radius:4px;-o-transition:background-color .1s ease-in;-ms-transition:background-color .1s ease-in;-moz-transition:background-color .1s ease-in;-webkit-transition:background-color .1s ease-in;transition:background-color .1s ease-in}.scroll-bar.horizontal .scroll-bar-up{position:absolute;top:1px;right:1px;left:auto;width:12px;height:12px}.scroll-bar-thumb{background-color:#B6B6B6;width:8px;height:20px;top:0;left:3px;position:absolute;border-radius:6px;-o-transition:background-color .1s ease-in;-ms-transition:background-color .1s ease-in;-moz-transition:background-color .1s ease-in;-webkit-transition:background-color .1s ease-in;transition:background-color .1s ease-in}.scroll-bar-thumb:hover,.scroll-bar-up:hover,.scroll-bar-down:hover{background-color:#4E4E4E}.scroll-bar.horizontal .scroll-bar-thumb{height:8px;width:20px;left:0;top:3px;position:absolute}.scroll-bar-down{position:absolute;bottom:1px;left:1px;width:12px;height:12px;background-color:#B6B6B6;border-radius:4px;-o-transition:background-color .1s ease-in;-ms-transition:background-color .1s ease-in;-moz-transition:background-color .1s ease-in;-webkit-transition:background-color .1s ease-in;transition:background-color .1s ease-in}.scroll-bar.horizontal .scroll-bar-down{position:absolute;top:1px;left:1px;width:12px;height:12px}</style><div class="scroll-bar"><div on-holdpulse="{{onUpHold}}" on-tap="{{onUpClick}}" class="scroll-bar-up"></div><div on-holdpulse="{{onGutterHold}}" on-tap="{{onGutterClick}}" class="scroll-bar-gutter"><div class="scroll-bar-thumb" draggable="false"></div></div><div on-holdpulse="{{onDownHold}}" on-tap="{{onDownClick}}" class="scroll-bar-down"></div></div></template><script>"use strict";(function(){var throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options){options={}}var later=function(){previous=options.leading===false?0:Date.now();timeout=null;result=func.apply(context,args);if(!timeout){context=args=null}};return function(){var now=Date.now();if(!previous&&options.leading===false){previous=now}var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);if(!timeout){context=args=null}}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result}};Polymer("fin-vampire-bar",{setRangeAdapter:function(rangeAdapter){var that=this;that.rangeAdapter=rangeAdapter;if(that.thumb){that.thumb.rangeAdapter=rangeAdapter}rangeAdapter.valueChanged=function(){var value=rangeAdapter.getValue();if(value||value===0){try{that.supressUpdates=true;that.moveToPercent(value)}finally{that.supressUpdates=false}}}},offset:0,attached:function(){var that=this;this.bar=this.shadowRoot.querySelector(".scroll-bar");this.thumb=this.shadowRoot.querySelector(".scroll-bar-thumb");this.gutter=this.shadowRoot.querySelector(".scroll-bar-gutter");this.stepUp=this.shadowRoot.querySelector(".scroll-bar-up");this.stepDown=this.shadowRoot.querySelector(".scroll-bar-down");this.configureOrientation();that.isScrolling=false;that.attachThumbMouseDown().attachThumbMouseMove().attachThumbMouseUp()},throttledWheelEvent:throttle(function(event){var that=this;var directionXY=that.orientation.toUpperCase(),styleProperty=directionXY==="Y"?"top":"left",rangeStop=that.rangeAdapter.rangeStop(),currentPercent=that.thumb.style&&that.thumb.style[styleProperty]&&parseFloat(that.thumb.style[styleProperty])||0,direction=event["delta"+directionXY]>0?1:-1,currentPercentAsRows=Math.round(that.rangeAdapter.rangeStop()*currentPercent),oneMoreRow=Math.round(currentPercentAsRows+1*direction),ranged=oneMoreRow/rangeStop/100;ranged=ranged>1?1:ranged;ranged=ranged<0?0:ranged;that.rangeAdapter.setValue(ranged)},30),attachWheelEvent:function(){var that=this;document.addEventListener("wheel",function(event){event.preventDefault();that.throttledWheelEvent(event)});return that},attachThumbMouseDown:function(){var that=this;that.thumb.addEventListener("mousedown",function(event){that.isScrolling=true;var direction=that.orientation==="y"?"top":"left";var distanceFromEdge=that.gutter.getBoundingClientRect()[direction];var offset=typeof event["offset"+that.orientation.toUpperCase()]==="undefined"?"layer":"offset";that.offset=event[offset+that.orientation.toUpperCase()]+distanceFromEdge});return that},attachThumbMouseMove:function(){var that=this;document.addEventListener("mousemove",function(event){if(that.isScrolling){that.moveThumb(event["page"+that.orientation.toUpperCase()])}});return that},attachThumbMouseUp:function(){var that=this;document.addEventListener("mouseup",function(){if(that.isScrolling){that.offset=0;that.isScrolling=false}});return that},onUpClick:function(){console.log("up click")},onUpHold:function(event){event.preventTap();console.log("hold me up..",Date.now())},onDownClick:function(){console.log("down click")},onDownHold:function(event){event.preventTap();console.log("hold me down ..",Date.now())},onGutterClick:function(){console.log("click")},onGutterHold:function(event){event.preventTap();console.log("hold me in the gutter..",Date.now())},moveThumb:function(pageLocation){var that=this,direction=this.orientation==="y"?"top":"left",maxScroll=that.getMaxScroll(),offBy=pageLocation-that.offset;offBy=offBy<0?0:offBy;offBy=offBy/maxScroll;offBy=offBy>1?1:offBy;offBy=offBy*100;that.thumb.style[direction]=offBy+"%";if(that.rangeAdapter){if(that.supressUpdates){return}that.rangeAdapter.setValue(offBy/100)}},moveToPercent:function(percent){var that=this;if(!that.isScrolling){that.moveThumb(percent*this.getMaxScroll())}},setValueUpdatedCallback:function(callback){this.valueUpdatedCallback=callback},setOrientation:function(orientation){this.orientation=orientation},getMaxScroll:function(){var direction=this.orientation==="y"?"clientHeight":"clientWidth";return this.gutter[direction]},configureOrientation:function(){var orientation="y";if("horizontal"in this.attributes){orientation="x";this.bar.classList.add("horizontal")}this.setOrientation(orientation)},tickle:function(){this.rangeAdapter.setValue(this.lastPercent)},lastPercent:0,createRangeAdapter:function(subject,userConfig){var config=userConfig||{step:1,page:40,rangeStart:0,rangeStop:100},that={};that.valueObj={value:null};that.subjectChanged=function(){that.valueObj.value=that.computeNormalizedValue();that.valueChanged()};that.rangeStart=function(value){if(value===undefined){return config.rangeStart}};that.rangeStop=function(value){if(value===undefined){return config.rangeStop}};that.page=function(value){if(value===undefined){return config.page}};that.setValue=function(newValue){if(typeof newValue!=="number"){return}var deNormalized=Math.floor(newValue*(config.rangeStop-config.rangeStart)+config.rangeStart);subject.setValue(deNormalized);that.valueObj.value=newValue;that.valueChanged()};that.computeNormalizedValue=function(){var value=(subject.getValue()-config.rangeStart)/(config.rangeStop-config.rangeStart);return value};that.getValue=function(){return that.valueObj.value};that.valueChanged=function(){};return that}})})();</script></polymer-element><polymer-element name="fin-canvas-component" class="fin-canvas-component" attributes="layoutProperties" assetpath="../fin-canvas/"><template></template><script>"use strict";(function(){Polymer("fin-canvas-component",{ready:function(){this.readyInit()},readyInit:function(){this.g=document.createElement("fin-rectangle");this.parent=null;this.bounds=this.g.rectangle.create(0,0,0,0);this.color=this.color||"black";this.backgroundColor=null;this.layoutProperties=this.layoutProperties||[0,0,1,0,1,0,0,0];if(typeof this.layoutProperties==="string"){this.layoutProperties=JSON.parse(this.layoutProperties)}},setBounds:function(rectangle){this.bounds=rectangle},getBounds:function(){return this.bounds},_paint:function(gc){try{gc.save();gc.translate(this.bounds.left(),this.bounds.top());var bgColor=this.getBackgroundColor();if(bgColor){var rect=this.getBounds();gc.beginPath();gc.fillStyle=bgColor;gc.fillRect(0,0,rect.width(),rect.height());gc.stroke()}this.paint(gc)}finally{gc.restore()}},paint:function(){},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(colorValue){this.backgroundColor=colorValue},repaint:function(){if(this.parent){this.parent.repaint()}},setParent:function(newParent){this.parent=newParent},getLayoutProperties:function(){return this.layoutProperties},setLayoutProperties:function(properties){this.layoutProperties=properties},getComponent:function(){var comp=this.children[0];return comp}})})();</script></polymer-element><polymer-element name="fin-hypergrid-renderer" extends="fin-canvas-component" assetpath=""><template></template><script>"use strict";(function(){var constants;var config={};var cellConfig=function(x,y,value,fgColor,bgColor,fgSelColor,bgSelColor,font,isSelected,halign){config.x=x;config.y=y;config.value=value;config.fgColor=fgColor;config.bgColor=constants.backgroundColor===bgColor?null:bgColor;config.fgSelColor=fgSelColor;config.bgSelColor=bgSelColor;config.font=font;config.isSelected=isSelected;config.halign=halign||"center";return config};Polymer("fin-hypergrid-renderer",{ready:function(){this.readyInit();if(!constants){constants=document.createElement("fin-hypergrid-constants").values}this.renderedColWidths=[0];this.renderedRowHeights=[0];this.renderedCols=[];this.renderedRows=[];this.insertionBounds=[];this.setBackgroundColor(constants.gridBackgroundColor)},getGrid:function(){return this.hypergrid},setGrid:function(grid){this.hypergrid=grid},paint:function(gc){if(!this.hypergrid){return}this.renderGrid(gc);this.getGrid().gridRenderedNotification()},getViewableRows:function(){return this.renderedRows.length},getViewableCols:function(){return this.renderedCols.length},overColumnDivider:function(x){var whichCol=this.renderedColWidths.indexOf(x+1);if(whichCol<0){whichCol=this.renderedColWidths.indexOf(x)}if(whichCol<0){whichCol=this.renderedColWidths.indexOf(x-1)}return whichCol},getBoundsOfCell:function(cell){var ox=this.renderedColWidths[cell.x],oy=this.renderedRowHeights[cell.y],cx=this.renderedColWidths[cell.x+1],cy=this.renderedRowHeights[cell.y+1],ex=cx-ox,ey=cy-oy;var bounds=this.g.rectangle.create(ox,oy,ex,ey);return bounds},getColumnFromPixelX:function(pixelX){pixelX=pixelX-this.getBehavior().getFixedColsWidth();var width=0;var c;for(c=0;c<this.insertionBounds.length;c++){width=this.insertionBounds[c];if(pixelX<width){return c}}return-1},getGridCellFromMousePoint:function(point){var width=0;var height=0;var x,y;var c,r;var previous=0;for(c=1;c<this.renderedColWidths.length;c++){width=this.renderedColWidths[c];if(point.x<width){x=Math.max(0,point.x-previous-2);break}previous=width}c--;previous=0;for(r=1;r<this.renderedRowHeights.length;r++){height=this.renderedRowHeights[r];if(point.y<height){y=Math.max(0,point.y-previous-2);break}previous=height}r--;if(point.x<0){c=-1}if(point.y<0){r=-1}return{gridCell:this.g.point.create(c,r),mousePoint:this.g.point.create(x,y)}},isColVisible:function(c){var isVisible=this.renderedCols.indexOf(c)!==-1;return isVisible},getFinalVisableColumnBoundry:function(){return this.getBounds().width()-200},isRowVisible:function(r){var isVisible=this.renderedRows.indexOf(r)!==-1;return isVisible},isSelected:function(x,y){return this.getGrid().isSelected(x,y)},renderGrid:function(gc){var offsetX=this.getBehavior().getFixedColsWidth();var offsetY=this.getBehavior().getFixedRowsHeight();this.paintHeaders(gc,0,0);this.paintCells(gc,offsetX,offsetY);this.paintGridlines(gc,offsetX,offsetY);this.renderOverrides(gc)},renderOverrides:function(gc){var grid=this.getGrid();var dragger=grid.columnRenderOverridesCache.dragger;if(dragger){this.renderOverride(gc,dragger)}var floater=grid.columnRenderOverridesCache.floater;if(floater){this.renderOverride(gc,floater)}},renderOverride:function(gc,override){var startX=override.startX;var hdpiRatio=override.hdpiratio;var width=override.width;var height=override.height;var targetCTX=override.ctx;var imgData=gc.getImageData(startX,0,width*hdpiRatio,height*hdpiRatio);targetCTX.putImageData(imgData,0,0);gc.strokeStyle=constants.backgroundColor;gc.fillRect(Math.round(startX/hdpiRatio),0,width,height)},paintGridlines:function(gc,offsetX,offsetY){var behavior=this.getBehavior();var lineColor=constants.lineColor;var numCols=behavior.getColCount();var numRows=behavior.getRowCount();var numFixedCols=behavior.getFixedColCount();var numFixedRows=behavior.getFixedRowCount();var fixedColsWidth=behavior.getFixedColsWidth();var fixedRowsHeight=behavior.getFixedRowsHeight();this.renderedColWidths=[0];this.renderedRowHeights=[0];this.renderedCols=[];this.renderedRows=[];this.insertionBounds=[];var insertionBoundsCursor=0;var scrollTop=this.getScrollTop();var scrollLeft=this.getScrollLeft();var viewWidth=this.getBounds().width()-200;var viewHeight=this.getBounds().height();gc.strokeStyle=lineColor;gc.lineWidth=1;var c,r,x,y,width,height;gc.beginPath();gc.moveTo(0,0);y=0;for(r=0;r<numFixedRows;r++){height=this.getFixedRowHeight(r);y=y+height;this.renderedRowHeights.push(y);gc.moveTo(fixedColsWidth,y);gc.lineTo(viewWidth,y);gc.stroke()}gc.beginPath();gc.moveTo(0,0);x=0;for(c=0;c<numFixedCols;c++){width=this.getFixedColWidth(c);x=x+width;this.renderedColWidths.push(x);gc.moveTo(x,fixedRowsHeight);gc.lineTo(x,viewHeight);gc.stroke()}gc.beginPath();gc.moveTo(0,0);x=offsetX;var previousInsertionBoundsCursorValue=0;for(c=0;c<numCols;c++){width=this.getColWidth(c+scrollLeft);this.renderedCols.push(c+scrollLeft);if(x>viewWidth||numCols<scrollLeft+c){this.renderedCols.length=Math.max(0,this.renderedCols.length-2);break}gc.moveTo(x,0);gc.lineTo(x,viewHeight);gc.stroke();x=x+width;this.renderedColWidths.push(x);insertionBoundsCursor=insertionBoundsCursor+Math.round(width/2)+previousInsertionBoundsCursorValue;this.insertionBounds.push(insertionBoundsCursor);previousInsertionBoundsCursorValue=Math.round(width/2)}gc.beginPath();gc.moveTo(0,0);y=offsetY;for(r=0;r<numRows;r++){height=this.getRowHeight(r+scrollTop);this.renderedRows.push(r+scrollTop);if(y>viewHeight||numRows<scrollTop+r){this.renderedRows.length=Math.max(0,this.renderedRows.length-2);break}gc.moveTo(0,y);gc.lineTo(viewWidth,y);gc.stroke();y=y+height;this.renderedRowHeights.push(y)}},paintHeaders:function(ctx,offsetX,offsetY){this.paintFixedRows(ctx,offsetX+this.getBehavior().getFixedColsWidth(),offsetY,this.getBehavior().getColCount(),this.getBehavior().getFixedRowCount());this.paintFixedCols(ctx,offsetX,offsetY+this.getBehavior().getFixedRowsHeight(),this.getBehavior().getFixedColCount(),this.getBehavior().getRowCount());this.paintTopLeft(ctx,0,0)},paintFixedRows:function(ctx,offsetX,offsetY,numCols,numRows){var behavior=this.getBehavior();var x=offsetX;var scrollLeft=this.getScrollLeft();var font=constants.defaultFont;var fgColor=constants.foregroundColor;var bgColor=constants.backgroundColor;var fgSelColor=constants.fixedRowFGSelColor;var bgSelColor=constants.fixedRowBGSelColor;var fixedRowBGColor=constants.fixedRowBGColor;var halign=constants.fixedRowAlign;var cellProvider=this.getGrid().getCellProvider();var viewWidth=this.getBounds().width()-200;var viewHeight=this.getBehavior().getFixedRowsHeight();for(var c=0;c<numCols;c++){var width=this.getColWidth(c+scrollLeft);if(x>viewWidth||numCols<=scrollLeft+c){return}var isSelected=this.isFixedRowCellSelected(c+scrollLeft);var y=offsetY;ctx.fillStyle=fixedRowBGColor;ctx.fillRect(x,y,x+width,viewHeight-y);for(var r=0;r<numRows;r++){var height=this.getFixedRowHeight(r);var value=behavior.getFixedRowValue(c+scrollLeft,r);var translatedX=behavior.translateColumnIndex(c+scrollLeft);var cell=cellProvider.getFixedRowCell(cellConfig(translatedX,r,value,fgColor,bgColor,fgSelColor,bgSelColor,font,isSelected,halign));cell.paint(ctx,x,y,width,height);y=y+height}x=x+width}},paintFixedCols:function(ctx,offsetX,offsetY,numCols,numRows){var behavior=this.getBehavior();var x=offsetX;var font=constants.defaultFont;var fgColor=constants.foregroundColor;var bgColor=constants.backgroundColor;var fixedColBGColor=constants.fixedColBGColor;var fgSelColor=constants.fixedColFGSelColor;var bgSelColor=constants.fixedColBGSelColor;var halign=constants.fixedColAlign;var scrollTop=this.getScrollTop();var cellProvider=this.getGrid().getCellProvider();var viewHeight=this.getBounds().height();for(var c=0;c<numCols;c++){var width=this.getFixedColWidth(c);var y=offsetY;ctx.fillStyle=fixedColBGColor;ctx.fillRect(x,y,width,viewHeight-y);for(var r=0;r<numRows;r++){var height=this.getRowHeight(r+scrollTop);var isSelected=this.isFixedColCellSelected(r+scrollTop);if(y>viewHeight||numRows<=scrollTop+r){break}var value=behavior.getFixedColValue(c,r+scrollTop);var cell=cellProvider.getFixedColCell(cellConfig(c,r+scrollTop,value,fgColor,bgColor,fgSelColor,bgSelColor,font,isSelected,halign));cell.paint(ctx,x,y,width,height);y=y+height}x=x+width}},paintCells:function(ctx,offsetX,offsetY){try{ctx.save();this._paintCells(ctx,offsetX,offsetY)}finally{ctx.restore()}},_paintCells:function(ctx,offsetX,offsetY){var behavior=this.getBehavior();var numCols=behavior.getColCount();var numRows=behavior.getRowCount();var x=offsetX;var startY=offsetY;var scrollTop=this.getScrollTop();var scrollLeft=this.getScrollLeft();var cellProvider=this.getGrid().getCellProvider();var font=constants.defaultFont;var fgColor=constants.foregroundColor;var bgColor=constants.backgroundColor;var fgSelColor=constants.foregroundSelColor;var bgSelColor=constants.backgroundSelColor;var viewWidth=this.getBounds().width()-200;var viewHeight=this.getBounds().height();for(var c=0;c<numCols;c++){var width=this.getColWidth(c+scrollLeft);if(x>viewWidth||numCols<=scrollLeft+c){return}var y=startY;var colAlign=behavior.getColAlignment(c+scrollLeft);ctx.fillStyle=bgColor;ctx.fillRect(x,y,x+width,viewHeight-y);for(var r=0;r<numRows;r++){var isSelected=this.isSelected(c+scrollLeft,r+scrollTop);var height=this.getRowHeight(r+scrollTop);if(y>viewHeight||numRows<=scrollTop+r){break}var value=behavior.getValue(c+scrollLeft,r+scrollTop);var translatedX=behavior.translateColumnIndex(c+scrollLeft);var cell=cellProvider.getCell(cellConfig(translatedX,r+scrollTop,value,fgColor,bgColor,fgSelColor,bgSelColor,font,isSelected,colAlign));cell.paint(ctx,x,y,width,height);y=y+height}x=x+width}},paintTopLeft:function(ctx,offsetX,offsetY){ctx.beginPath();var fixedRowHeight=this.getBehavior().getFixedRowsHeight();var fixedColWidth=this.getBehavior().getFixedColsWidth();ctx.fillStyle=constants.topLeftHeaderBGColor;ctx.fillRect(offsetX,offsetY,fixedColWidth,fixedRowHeight);ctx.stroke()},isFixedRowCellSelected:function(col){return this.getGrid().isFixedRowCellSelected(col)},isFixedColCellSelected:function(row){return this.getGrid().isFixedColCellSelected(row)},getScrollTop:function(){var st=this.getGrid().getVScrollValue();return st},getScrollLeft:function(){var st=this.getGrid().getHScrollValue();return st},getBehavior:function(){return this.getGrid().getBehavior()},getConstants:function(){return this.getGrid().constants},getFixedRowHeight:function(rowIndex){var height=this.getBehavior().getFixedRowHeight(rowIndex);return height},getRowHeight:function(rowIndex){var height=this.getBehavior().getRowHeight(rowIndex);return height},getColWidth:function(colIndex){var width=this.getBehavior().getColWidth(colIndex);return width},getFixedColWidth:function(rowIndex){var height=this.getBehavior().getFixedColWidth(rowIndex);return height}})})();</script></polymer-element><polymer-element name="fin-hypergrid-selection-model" assetpath=""><template></template><script>"use strict";(function(){Polymer("fin-hypergrid-selection-model",{ready:function(){this.rectangles=document.createElement("fin-rectangle");this.selections=[];this.flattenedX=[];this.flattenedY=[]},getGrid:function(){return null},select:function(ox,oy,ex,ey){var newSelection=this.rectangles.rectangle.create(ox,oy,ex,ey);this.selections.push(newSelection);this.flattenedX.push(newSelection.flattenXAt(0));this.flattenedY.push(newSelection.flattenYAt(0))},clearMostRecentSelection:function(){this.selections.length=Math.max(0,this.selections.length-1);this.flattenedX.length=Math.max(0,this.flattenedX.length-1);this.flattenedY.length=Math.max(0,this.flattenedY.length-1)},getSelections:function(){return this.selections},hasSelections:function(){return this.selections.length!==0},isSelected:function(x,y){return this._isSelected(this.selections,x,y)},isFixedRowCellSelected:function(col){return this._isSelected(this.flattenedY,col,0)},isFixedColCellSelected:function(row){return this._isSelected(this.flattenedX,0,row)},_isSelected:function(selections,x,y){for(var i=0;i<selections.length;i++){var each=selections[i];if(this.rectangles.rectangle.contains(each,x,y)){return true}}return false},clear:function(){this.selections.length=0;this.flattenedX.length=0;this.flattenedY.length=0}})})();</script></polymer-element><polymer-element name="fin-hypergrid-feature-base" assetpath="features/"><template></template><script>(function(){"use strict";Polymer("fin-hypergrid-feature-base",{next:null,detached:null,cursor:null,created:function(){this.createdInit()},createdInit:function(){},setNext:function(nextFeature){if(this.next){this.next.setNext(nextFeature)}else{this.next=nextFeature;this.detached=nextFeature}},detachChain:function(){this.next=null},attachChain:function(){this.next=this.detached},handleMouseMove:function(grid,event){if(this.next){this.next.handleMouseMove(grid,event)}},handleMouseDown:function(grid,event){if(this.next){this.next.handleMouseDown(grid,event)}},handleMouseUp:function(grid,event){if(this.next){this.next.handleMouseUp(grid,event)}},handleKeyDown:function(grid,event){if(this.next){this.next.handleKeyDown(grid,event)}},handleWheelMoved:function(grid,event){if(this.next){this.next.handleWheelMoved(grid,event)}},handleDoubleClick:function(grid,event){if(this.next){this.next.handleDoubleClick(grid,event)}},handleHoldPulse:function(grid,event){if(this.next){this.next.handleHoldPulse(grid,event)}},handleTap:function(grid,event){if(this.next){this.next.handleTap(grid,event)}},handleMouseDrag:function(grid,event){if(this.next){this.next.handleMouseDrag(grid,event)}},isFixedRow:function(grid,event){var gridCell=event.gridCell;var isFixed=gridCell.y<grid.getFixedRowCount();return isFixed},isFixedCol:function(grid,event){var gridCell=event.gridCell;var isFixed=gridCell.x<grid.getFixedColCount();return isFixed},setCursor:function(grid){if(this.next){this.next.setCursor(grid)}if(this.cursor){grid.beCursor(this.cursor)}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-constants" assetpath=""><template></template><script>"use strict";(function(){var values={defaultFont:"13px Tahoma, Geneva, sans-serif",foregroundColor:"#010126",backgroundColor:"#FFFFFF",foregroundSelColor:"#010126",backgroundSelColor:"#B7DBFF",fixedColBGColor:"#DFE3E8",fixedRowBGColor:"#DFE3E8",fixedColFGSelColor:"#010126",fixedRowFGSelColor:"#010126",fixedColBGSelColor:"#FFDC61",fixedRowBGSelColor:"#FFDC61",lineColor:"#C7C7C7",fixedRowAlign:"center",fixedColAlign:"center",cellPadding:5,rowHeight:20,colWidth:100,topLeftHeaderBGColor:"#DFE3E8",repaintIntervalRate:15};Polymer("fin-hypergrid-constants",{values:values})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-provider" assetpath=""><template></template><script>"use strict";(function(){var constants;var roundRect=function(ctx,x,y,width,height,radius,fill,stroke){if(!stroke){stroke=true}if(!radius){radius=5}ctx.beginPath();ctx.moveTo(x+radius,y);ctx.lineTo(x+width-radius,y);ctx.quadraticCurveTo(x+width,y,x+width,y+radius);ctx.lineTo(x+width,y+height-radius);ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height);ctx.lineTo(x+radius,y+height);ctx.quadraticCurveTo(x,y+height,x,y+height-radius);ctx.lineTo(x,y+radius);ctx.quadraticCurveTo(x,y,x+radius,y);ctx.closePath();if(stroke){ctx.stroke()}if(fill){ctx.fill()}};Polymer("fin-hypergrid-cell-provider",{created:function(){if(!constants){constants=document.createElement("fin-hypergrid-constants").values}this.cellCache={};this.initializeCells()},getCell:function(config){var cell=this.cellCache.simpleCellRenderer;cell.config=config;return cell},getFixedColCell:function(config){var cell=this.cellCache.simpleCellRenderer;cell.config=config;return cell},getFixedRowCell:function(config){var cell=this.cellCache.simpleCellRenderer;cell.config=config;return cell},defaultCellPaint:function(gc,x,y,width,height){var colHEdgeOffset=constants.cellPadding,halignOffset=0,valignOffset=0,halign=this.config.halign,size,textWidth;if(gc.font!==this.config.font){gc.font=this.config.font}if(gc.textAlign!=="left"){gc.textAlign="left"}if(gc.textBasline!=="middle"){gc.textBaseline="middle"}if(halign==="right"){size=gc.measureText(this.config.value);textWidth=size.width;halignOffset=width-colHEdgeOffset-textWidth}else if(halign==="center"){size=gc.measureText(this.config.value);textWidth=size.width;halignOffset=(width-textWidth)/2}else if(halign==="left"){halignOffset=colHEdgeOffset}halignOffset=Math.max(0,halignOffset);valignOffset=height/2;if(this.config.bgColor||this.config.isSelected){gc.fillStyle=this.config.isSelected?this.config.bgSelColor:this.config.bgColor;gc.fillRect(x,y,width,height)}gc.fillStyle=this.config.fgColor;gc.fillText(this.config.value,x+halignOffset,y+valignOffset)},paintSlider:function(ctx,x,y,width,height){ctx.strokeStyle="white";var val=this.config.value;var radius=height/2;var offset=width*val;var bgColor=this.config.isSelected?this.config.bgSelColor:"#333333";var btnGradient=ctx.createLinearGradient(x,y,x,y+height);btnGradient.addColorStop(0,bgColor);btnGradient.addColorStop(1,"#666666");var arcGradient=ctx.createLinearGradient(x,y,x,y+height);arcGradient.addColorStop(0,"#aaaaaa");arcGradient.addColorStop(1,"#777777");ctx.fillStyle=btnGradient;roundRect(ctx,x,y,width,height,radius,btnGradient);if(val<1){ctx.fillStyle=arcGradient}else{ctx.fillStyle="#eeeeee"}ctx.beginPath();ctx.arc(x+Math.max(offset-radius,radius),y+radius,radius,0,2*Math.PI);ctx.fill()},paintSparkbar:function(ctx,x,y,width,height){var val=this.config.value;if(!val||!val.length){return}var count=val.length;var eWidth=width/count;var bgColor=this.config.isSelected?this.config.bgSelColor:"white";ctx.fillStyle=bgColor;ctx.fillRect(x,y,width,height);ctx.fillStyle="#010167";for(var i=0;i<val.length;i++){var barheight=val[i]/110*height;ctx.fillRect(x+5,y+height-barheight,eWidth*.6666,barheight);x=x+eWidth}},paintSparkline:function(ctx,x,y,width,height){var val=this.config.value;if(!val||!val.length){return}var count=val.length;var eWidth=width/count;var bgColor=this.config.isSelected?this.config.bgSelColor:"white";ctx.fillStyle=bgColor;ctx.fillRect(x,y,width,height);ctx.strokeStyle="#010167";ctx.fillStyle="#010167";ctx.beginPath();var prev;for(var i=0;i<val.length;i++){var barheight=val[i]/110*height;if(!prev){prev=barheight}ctx.lineTo(x+5,y+height-barheight);ctx.arc(x+5,y+height-barheight,1,0,2*Math.PI,false);x=x+eWidth}ctx.stroke()},initializeCells:function(){this.cellCache.simpleCellRenderer={paint:this.defaultCellPaint};this.cellCache.sliderCellRenderer={paint:this.paintSlider};this.cellCache.sparkbarCellRenderer={paint:this.paintSparkbar};this.cellCache.sparklineCellRenderer={paint:this.paintSparkline}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-feature-cell-selection" extends="fin-hypergrid-feature-base" assetpath="features/"><template></template><script>(function(){"use strict";Polymer("fin-hypergrid-feature-cell-selection",{currentDrag:null,lastDragCell:null,sbLastAuto:0,sbAutoStart:0,rectangles:{},createdInit:function(){this.rectangles=document.createElement("fin-rectangle")},handleMouseUp:function(grid,event){this.dragging=false;if(this.next){this.next.handleMouseUp(grid,event)}},handleMouseDown:function(grid,event){var gridCell=event.gridCell;if(gridCell.y<grid.getFixedRowCount()){grid.clearSelections();this.dragging=false;if(this.next){this.next.handleMouseDown(grid,event)}return}else if(gridCell.x<grid.getFixedColCount()){grid.clearSelections();this.dragging=false;return}else{var primEvent=event.primitiveEvent;var keys=primEvent.detail.keys;this.dragging=true;this.extendSelection(grid,gridCell,keys)}},handleMouseDrag:function(grid,event){var mouseDown=grid.getMouseDown();if(!this.dragging){if(this.next){this.next.handleMouseDrag(grid,event)}}if(mouseDown.x<0||mouseDown.y<0){return}var gridCell=event.gridCell;var primEvent=event.primitiveEvent;this.currentDrag=primEvent.detail.mouse;this.lastDragCell=gridCell;this.checkDragScroll(grid,this.currentDrag);this.handleMouseDragCellSelection(grid,gridCell,primEvent.detail.keys)},handleKeyDown:function(grid,event){var command="handle"+event.detail.char;if(this[command]){this[command].call(this,grid,event.detail)}},handleMouseDragCellSelection:function(grid,mouse){var scrollTop=grid.getVScrollValue();var scrollLeft=grid.getHScrollValue();var numFixedCols=grid.getFixedColCount();var numFixedRows=grid.getFixedRowCount();var x=mouse.x-numFixedCols;var y=mouse.y-numFixedRows;x=Math.max(0,x);y=Math.max(0,y);var previousDragExtent=grid.getDragExtent();var mouseDown=grid.getMouseDown();var newX=x+scrollLeft-mouseDown.x;var newY=y+scrollTop-mouseDown.y;if(previousDragExtent.x===newX&&previousDragExtent.y===newY){return}grid.clearMostRecentSelection();grid.select(mouseDown.x,mouseDown.y,newX,newY);var newDragExtent=this.rectangles.point.create(newX,newY);grid.setDragExtent(newDragExtent);grid.repaint()},checkDragScroll:function(grid,mouse){var b=grid.getDataBounds();var inside=b.contains(mouse);if(inside){if(grid.scrollingNow){grid.scrollingNow=false}}else if(!grid.scrollingNow){grid.scrollingNow=true;this.scrollDrag(grid)}},scrollDrag:function(grid){if(!grid.scrollingNow){return}var b=grid.getDataBounds();var xOffset=0;var yOffset=0;if(this.currentDrag.x<b.origin.x){xOffset=-1}if(this.currentDrag.x>b.origin.x+b.extent.x){xOffset=1}if(this.currentDrag.y<b.origin.y){yOffset=-1}if(this.currentDrag.y>b.origin.y+b.extent.y){yOffset=1}grid.scrollBy(xOffset,yOffset);this.handleMouseDragCellSelection(grid,this.lastDragCell,[]);grid.repaint();setTimeout(this.scrollDrag.bind(this,grid),25)},extendSelection:function(grid,gridCell,keys){var hasCTRL=keys.indexOf("CTRL")!==-1;var hasSHIFT=keys.indexOf("SHIFT")!==-1;var scrollTop=grid.getVScrollValue();var scrollLeft=grid.getHScrollValue();var numFixedCols=grid.getFixedColCount();var numFixedRows=grid.getFixedRowCount();var mousePoint=grid.getMouseDown();var x=gridCell.x-numFixedCols+scrollLeft;var y=gridCell.y-numFixedRows+scrollTop;if(x<0||y<0){return}if(x===mousePoint.x&&y===mousePoint.y){grid.clearMostRecentSelection();grid.popMouseDown();grid.repaint();return}if(!hasCTRL&&!hasSHIFT){grid.clearSelections()}if(hasSHIFT){grid.clearMostRecentSelection();grid.select(mousePoint.x,mousePoint.y,x-mousePoint.x,y-mousePoint.y);grid.setDragExtent(this.rectangles.point.create(x-mousePoint.x,y-mousePoint.y))}else{grid.select(x,y,0,0);grid.setMouseDown(this.rectangles.point.create(x,y));grid.setDragExtent(this.rectangles.point.create(0,0))}grid.repaint()},handleDOWNSHIFT:function(grid){var count=this.getAutoScrollAcceleration();this.moveShiftSelect(grid,0,count)},handleUPSHIFT:function(grid){var count=this.getAutoScrollAcceleration();this.moveShiftSelect(grid,0,-count)},handleLEFTSHIFT:function(grid){this.moveShiftSelect(grid,-1,0)},handleRIGHTSHIFT:function(grid){this.moveShiftSelect(grid,1,0)},handleDOWN:function(grid){var count=this.getAutoScrollAcceleration();this.moveSingleSelect(grid,0,count)},handleUP:function(grid){var count=this.getAutoScrollAcceleration();this.moveSingleSelect(grid,0,-count)},handleLEFT:function(grid){this.moveSingleSelect(grid,-1,0)},handleRIGHT:function(grid){this.moveSingleSelect(grid,1,0)},getAutoScrollAcceleration:function(){var count=1;var elapsed=this.getAutoScrollDuration()/2e3;count=Math.max(1,Math.floor(elapsed*elapsed*elapsed*elapsed));return count},setAutoScrollStartTime:function(){this.sbAutoStart=Date.now()},pingAutoScroll:function(){var now=Date.now();if(now-this.sbLastAuto>500){this.setAutoScrollStartTime()}this.sbLastAuto=Date.now()},getAutoScrollDuration:function(){if(Date.now()-this.sbLastAuto>500){return 0}return Date.now()-this.sbAutoStart},moveShiftSelect:function(grid,offsetX,offsetY){var maxCols=grid.getColCount()-1;var maxRows=grid.getRowCount()-1;var origin=grid.getMouseDown();var extent=grid.getDragExtent();var newX=extent.x+offsetX;var newY=extent.y+offsetY;newX=Math.min(maxCols-origin.x,Math.max(-origin.x,newX));newY=Math.min(maxRows-origin.y,Math.max(-origin.y,newY));grid.clearMostRecentSelection();grid.select(origin.x,origin.y,newX,newY);grid.setDragExtent(this.rectangles.point.create(newX,newY));if(grid.insureModelColIsViewable(newX+origin.x,offsetX)){this.pingAutoScroll()}if(grid.insureModelRowIsViewable(newY+origin.y,offsetY)){this.pingAutoScroll()}grid.repaint()},moveSingleSelect:function(grid,offsetX,offsetY){var maxCols=grid.getColCount()-1;var maxRows=grid.getRowCount()-1;var mouseCorner=grid.getMouseDown().plus(grid.getDragExtent());var newX=mouseCorner.x+offsetX;var newY=mouseCorner.y+offsetY;newX=Math.min(maxCols,Math.max(0,newX));newY=Math.min(maxRows,Math.max(0,newY));grid.clearSelections();grid.select(newX,newY,0,0);grid.setMouseDown(this.rectangles.point.create(newX,newY));grid.setDragExtent(this.rectangles.point.create(0,0));if(grid.insureModelColIsViewable(newX,offsetX)){this.pingAutoScroll()}if(grid.insureModelRowIsViewable(newY,offsetY)){this.pingAutoScroll()}grid.repaint()}})})();</script></polymer-element><polymer-element name="fin-hypergrid-feature-thumbwheel-scrolling" extends="fin-hypergrid-feature-base" assetpath="features/"><template></template><script>(function(){"use strict";Polymer("fin-hypergrid-feature-thumbwheel-scrolling",{handleWheelMoved:function(grid,e){var primEvent=e.primitiveEvent;if(primEvent.wheelDeltaY>0){grid.scrollBy(0,-1)}else if(primEvent.wheelDeltaY<-0){grid.scrollBy(0,1)}else if(primEvent.wheelDeltaX>0){grid.scrollBy(-1,0)}else if(primEvent.wheelDeltaX<-0){grid.scrollBy(1,0)}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-feature-cell-editing" extends="fin-hypergrid-feature-base" assetpath="features/"><template></template><script>(function(){"use strict";Polymer("fin-hypergrid-feature-cell-editing",{handleDoubleClick:function(grid,mouseEvent){grid.activateEditor(mouseEvent)},handleHoldPulse:function(grid,mouseEvent){var primEvent=mouseEvent.primitiveEvent;if(primEvent.detail.count<2){return}grid.activateEditor(mouseEvent)}})})();</script></polymer-element><polymer-element name="fin-hypergrid-feature-column-sorting" extends="fin-hypergrid-feature-base" assetpath="features/"><template></template><script>(function(){"use strict";Polymer("fin-hypergrid-feature-column-sorting",{handleTap:function(grid,event){var gridCell=event.gridCell;if(gridCell.y<grid.getFixedRowCount()){grid.fixedRowClicked(event)}else if(gridCell.x<grid.getFixedColCount()){grid.fixedColClicked(event)}},handleMouseMove:function(grid,event){if(this.isFixedRow(grid,event)&&!this.isFixedCol(grid,event)){this.cursor="pointer"}else{this.cursor=null}if(this.next){this.next.handleMouseMove(grid,event)}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-feature-column-resizing" extends="fin-hypergrid-feature-base" assetpath="features/"><template></template><script>(function(){"use strict";Polymer("fin-hypergrid-feature-column-resizing",{dragColumn:-1,dragStart:-1,dragColStartingWidth:-1,handleMouseDrag:function(grid,event){if(this.dragColumn>-1){var fixedColCount=grid.getFixedColCount();var distance=event.primitiveEvent.detail.mouse.x-this.dragStart+this.dragColStartingWidth;this.setColumnWidth(grid,this.dragColumn-fixedColCount-1,distance)}else if(this.next){this.next.handleMouseDrag(grid,event)}},setColumnWidth:function(grid,colIndex,width){var fixedColCount=grid.getFixedColCount();var scrollLeft=grid.getHScrollValue();if(colIndex<0){grid.setFixedColumnWidth(fixedColCount+colIndex,width)}else{grid.setColumnWidth(colIndex+scrollLeft,width)}},getColumnWidth:function(grid,colIndex){var fixedColCount=grid.getFixedColCount();if(colIndex<0){return grid.getFixedColumnWidth(fixedColCount+colIndex)}else{return grid.getColumnWidth(colIndex)}},handleMouseDown:function(grid,event){var gridCell=event.gridCell;var overCol=grid.overColumnDivider(event);if(overCol>-1&&gridCell.y<grid.getFixedRowCount()){var scrollLeft=grid.getHScrollValue();var fixedColCount=grid.getFixedColCount();this.dragColumn=overCol;this.dragStart=event.primitiveEvent.detail.mouse.x;if(overCol<2){scrollLeft=0}this.dragColStartingWidth=this.getColumnWidth(grid,overCol-fixedColCount-1+scrollLeft);this.detachChain()}else if(this.next){this.next.handleMouseDown(grid,event)}},handleMouseUp:function(grid,event){if(this.dragColumn>-1){this.cursor=null;this.dragColumn=-1;var self=this;setTimeout(function(){self.attachChain()},200)}else if(this.next){this.next.handleMouseUp(grid,event)}},handleMouseMove:function(grid,event){if(this.dragColumn>-1){return}this.cursor=null;if(this.next){this.next.handleMouseMove(grid,event)}this.checkForColumnResizeCursorChange(grid,event)},checkForColumnResizeCursorChange:function(grid,event){var gridCell=event.gridCell;if(this.isFixedRow(grid,event)&&grid.overColumnDivider(event)>-1){this.cursor="col-resize"}else{this.cursor=null}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-feature-column-moving" extends="fin-hypergrid-feature-base" assetpath="features/"><template></template><script>(function(){"use strict";Polymer("fin-hypergrid-feature-column-moving",{dragArmed:false,dragging:false,dragCol:-1,dragOffset:0,handleMouseDrag:function(grid,event){var gridCell=event.gridCell;var x,y;if(this.isFixedCol(grid,event)){return}if(this.isFixedRow(grid,event)&&this.dragArmed&&!this.dragging){this.dragging=true;this.dragCol=gridCell.x-grid.getFixedColCount();this.dragOffset=event.mousePoint.x;this.detachChain();x=event.primitiveEvent.detail.mouse.x-this.dragOffset;y=event.primitiveEvent.detail.mouse.y;grid.createDragColumn(x,this.dragCol)}else if(this.next){this.next.handleMouseDrag(grid,event)}if(this.dragging){x=event.primitiveEvent.detail.mouse.x-this.dragOffset;y=event.primitiveEvent.detail.mouse.y;grid.dragColumn(x)}},handleMouseDown:function(grid,event){if(this.isFixedRow(grid,event)){this.dragArmed=true}if(this.next){this.next.handleMouseDown(grid,event)}},handleMouseUp:function(grid,event){if(this.dragging){this.cursor=null;var self=this;grid.endDragColumn();setTimeout(function(){self.attachChain()},200)}this.dragCol=-1;this.dragging=false;this.dragArmed=false;grid.repaint();if(this.next){this.next.handleMouseUp(grid,event)}},handleMouseMove:function(grid,event){this.cursor=null;if(this.next){this.next.handleMouseMove(grid,event)}if(this.isFixedRow(grid,event)&&this.dragging){this.cursor="none"}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-behavior-default" assetpath="behaviors/"><template></template><script>"use strict";(function(){var noop=function(){};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZ";Polymer("fin-hypergrid-behavior-default",{ready:function(){this.readyInit()},colIndexes:null,fixedColIndexes:null,colWidths:null,fixedColWidths:null,grid:null,editorTypes:["choice","textfield","color","slider","spinner","date"],featureChain:null,readyInit:function(){this.constants=document.createElement("fin-hypergrid-constants").values;this.cellProvider=this.createCellProvider();this.scrollPositionX=0;this.scrollPositionY=0;this.renderedWidth=30;this.renderedHeight=60;this.colWidths=this.colWidths||[],this.fixedColWidths=this.fixedColWidths||[],this.colIndexes=this.colIndexes||[],this.fixedColIndexes=this.fixedColIndexes||[],this.values={};this.setNextFeature(document.createElement("fin-hypergrid-feature-column-resizing"));this.setNextFeature(document.createElement("fin-hypergrid-feature-cell-selection"));this.setNextFeature(document.createElement("fin-hypergrid-feature-column-moving"));this.setNextFeature(document.createElement("fin-hypergrid-feature-thumbwheel-scrolling"));this.setNextFeature(document.createElement("fin-hypergrid-feature-cell-editing"));this.setNextFeature(document.createElement("fin-hypergrid-feature-column-sorting"));this.initColIndexes()},initColIndexes:function(){var colCount=this.getColCount();var fixedColCount=this.getFixedColCount();var i;for(i=0;i<colCount;i++){this.colIndexes[i]=i}for(i=0;i<fixedColCount;i++){this.fixedColIndexes[i]=i}},swapColumns:function(src,tar){var tmp=this.colIndexes[src];this.colIndexes[src]=this.colIndexes[tar];this.colIndexes[tar]=tmp},translateColumnIndex:function(x){return this.colIndexes[x]},setNextFeature:function(nextFeature){if(this.featureChain){this.featureChain.setNext(nextFeature)}else{this.featureChain=nextFeature}},installOn:function(grid){grid.setBehavior(this)},getCellProvider:function(){return this.cellProvider},setGrid:function(finGrid){this.grid=finGrid},getGrid:function(){return this.grid},createCellProvider:function(){var provider=document.createElement("fin-hypergrid-cell-provider");return provider},getValue:function(x,y){x=this.translateColumnIndex(x);var override=this.values["p_"+x+"_"+y];if(override){return override}return x+", "+a[y%26]},setValue:function(x,y,value){x=this.translateColumnIndex(x);this.values["p_"+x+"_"+y]=value},getFixedRowValue:function(x){x=this.translateColumnIndex(x);return this.alphaFor(x)},getFixedColValue:function(x,y){return y+1},getRowCount:function(){return 1e15},getColCount:function(){return 300},getFixedRowCount:function(){return 1},getFixedRowsHeight:function(){var count=this.getFixedRowCount();var total=0;for(var i=0;i<count;i++){total=total+this.getFixedRowHeight(i)}return total},getFixedRowHeight:function(rowNum){return this.getRowHeight(rowNum)},getFixedRowsMaxHeight:function(){var height=(0+this.getFixedRowCount())*this.constants.rowHeight;return height},getFixedColCount:function(){return 1},getFixedColsWidth:function(){var count=this.getFixedColCount();var total=0;for(var i=0;i<count;i++){total=total+this.getFixedColWidth(i)}return total},getFixedColsMaxWidth:function(){var width=(0+this.getFixedColCount())*this.constants.colWidth;return width},getFixedColWidth:function(colNumber){var override=this.fixedColWidths[colNumber];if(override){return override}return 120},setFixedColumnWidth:function(colNumber,width){this.fixedColWidths[colNumber]=Math.max(5,width);this.changed()},getRowHeight:function(){return this.constants.rowHeight},getColWidth:function(colNumber){colNumber=this.colIndexes[colNumber];var override=this.colWidths[colNumber];if(override){return override}return this.constants.colWidth},setColumnWidth:function(colNumber,width){colNumber=this.colIndexes[colNumber];this.colWidths[colNumber]=Math.max(5,width);this.changed()},setScrollPositionY:function(y){this.scrollPositionY=y;this.changed()},setScrollPositionX:function(x){this.scrollPositionX=x;this.changed()},setRenderedWidth:function(width){this.renderedWidth=width},setRenderedHeight:function(height){this.renderedHeight=height},getColAlignment:function(){return"center"},fixedRowClicked:function(grid,mouse){console.log("fixed row clicked: "+mouse.gridCell.x,mouse)},fixedColClicked:function(grid,mouse){console.log("fixed col clicked: "+mouse.gridCell.y,mouse)},setCursor:function(grid){grid.beCursor("default");this.featureChain.setCursor(grid)},onMouseMove:function(grid,event){if(this.featureChain){this.featureChain.handleMouseMove(grid,event);this.setCursor(grid)}},onTap:function(grid,event){if(this.featureChain){this.featureChain.handleTap(grid,event);this.setCursor(grid)}},onWheelMoved:function(grid,event){if(this.featureChain){this.featureChain.handleWheelMoved(grid,event);this.setCursor(grid)}},onMouseUp:function(grid,event){if(this.featureChain){this.featureChain.handleMouseUp(grid,event);this.setCursor(grid)}},onMouseDrag:function(grid,event){if(this.featureChain){this.featureChain.handleMouseDrag(grid,event);this.setCursor(grid)}},onKeyDown:function(grid,event){if(this.featureChain){this.featureChain.handleKeyDown(grid,event);this.setCursor(grid)}},onDoubleClick:function(grid,event){if(this.featureChain){this.featureChain.handleDoubleClick(grid,event);this.setCursor(grid)}},onHoldPulse:function(grid,event){if(this.featureChain){this.featureChain.handleHoldPulse(grid,event);this.setCursor(grid)}},handleMouseDown:function(grid,event){if(this.featureChain){this.featureChain.handleMouseDown(grid,event);this.setCursor(grid)}},getCellEditorAt:function(x,y){x=this.translateColumnIndex(x);var cellEditor=this.grid.cellEditors["textfield"];return cellEditor},changed:function(){},alphaFor:function(i){var quo=Math.floor(i/26);var rem=i%26;var code="";if(quo>0){code+=String.fromCharCode("A".charCodeAt(0)+quo-1)}code+=String.fromCharCode("A".charCodeAt(0)+rem);return code}})})();</script></polymer-element><polymer-element name="fin-hypergrid-behavior-gol" extends="fin-hypergrid-behavior-default" assetpath="behaviors/"><template></template><script>"use strict";(function(){var patterns=[[[false,true,true,true,false],[true,false,true,false,true],[false,false,true,false,false]],[[false,true,false],[true,false,false],[true,true,true]]];var colors=["#ffffff","#ffffff","#efefef","#00e7e7","#00dfdf","#00d7d7","#00cfcf","#00c7c7"];Polymer("fin-hypergrid-behavior-gol",{rows:45,cols:75,data:[],buffer:[],running:false,ready:function(){this.readyInit();this.rows=this.getAttribute("rows")||this.rows;this.cols=this.getAttribute("cols")||this.cols;this.resetPetriDish();this.running=false},createCellProvider:function(){var provider=document.createElement("fin-hypergrid-cell-provider");provider.cellCache.simpleCellRenderer.paint=function(gc,x,y,width,height){var weight=this.config.value[1];if(weight===0){return}var color=colors[weight];if(this.config.value[0]){color=this.config.fgColor}gc.fillStyle=color;gc.fillRect(x,y,width,height)};return provider},resetPetriDish:function(){this.data=[],this.buffer=[],this.initializeData(this.data);this.initializeData(this.buffer);this.populate();this.changed()},populate:function(){var x=0;var y=0;for(var i=0;i<15;i++){y=Math.round(Math.random()*this.rows*.6);x=Math.round(Math.random()*this.cols*.6);this.applyPatternAt(this.data,x,y,patterns[i%2],i%4)}},initializeData:function(array2D){for(var c=0;c<this.cols;c++){var col=[];array2D.push(col);for(var r=0;r<this.rows;r++){col.push([false,0])}}},toggleRunning:function(){this.running=!this.running;if(this.running){this.startLife()}},startLife:function(){if(!this.running){return}for(var c=1;c<this.cols-2;c++){for(var r=1;r<this.rows-2;r++){this.computeLifeAt(c,r)}}var temp=this.buffer;this.buffer=this.data;this.data=temp;this.changed();setTimeout(this.startLife.bind(this),125)},computeLifeAt:function(x,y){var me=this.getValue(x,y);var total=this.getNeighborCount(x,y);me[1]=total;if(me[0]){if(total<2){this.buffer[x][y]=[false,0]}else if(total<4){this.buffer[x][y]=[true,1]}else{this.buffer[x][y]=[false,0]}}else{this.buffer[x][y]=[total===3,total]}},getNeighborCount:function(x,y){var data=this.data;var total=0;if(data[x-1][y-1][0]){total++}if(data[x-1][y][0]){total++}if(data[x-1][y+1][0]){total++}if(data[x][y-1][0]){total++}if(data[x][y+1][0]){total++}if(data[x+1][y-1][0]){total++}if(data[x+1][y][0]){total++}if(data[x+1][y+1][0]){total++}return total},_getNeighborCount:function(x,y){var data=this.data;var sum=this.count3(data[x-1],y)+this.count2(data[x],y)+this.count3(data[x+1],y);return sum},count3:function(row,offset){var sum=0;for(var i=offset-1;i<=offset+1;i++){if(row[i][0]){sum++}}return sum},count2:function(row,offset){var sum=0;for(var i=offset-1;i<=offset+1;i++){if(i!==offset&&row[i][0]){sum++}}return sum},getValue:function(x,y){return this.data[x][y]},setValue:function(x,y,value){this.data[x][y]=value},getFixedColValue:function(x,y){return y},getFixedRowValue:function(x,y){return""},getFixedColCount:function(){return 0},getFixedRowCount:function(){return 0},getColCount:function(){return this.data.length},getRowCount:function(){return this.data[0].length},getRowHeight:function(y){return 10},getColWidth:function(x){return 10},getNextState:function(){if(this.running){return"pause"}else{return"play"}},onTap:function(grid,mouse){var mX=this.scrollPositionX+mouse.gridCell.x;var mY=this.scrollPositionY+mouse.gridCell.y;var v=this.getValue(mX,mY)[0];this.setValue(mX,mY,[!v,1]);this.changed()},applyPatternAt:function(array,c,r,pattern,dir){var w=pattern.length;var h=pattern[0].length;if(dir===0){for(var x=0;x<w;x++){for(var y=0;y<h;y++){array[x+c][y+r]=[pattern[w-x-1][y],1]}}}else if(dir===1){for(var x=0;x<w;x++){for(var y=0;y<h;y++){array[x+c][y+r]=[pattern[x][y],1]}}}else if(dir===2){for(var x=0;x<w;x++){for(var y=0;y<h;y++){array[y+c][x+r]=[pattern[x][y],1]}}}else{for(var x=0;x<w;x++){for(var y=0;y<h;y++){array[y+c][x+r]=[pattern[w-x-1][y],1]}}}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-behavior-in-memory" extends="fin-hypergrid-behavior-default" assetpath="behaviors/"><template></template><script>"use strict";(function(){function rnd(max){return Math.floor(Math.random()*max)}var barRandomOffsets=[];for(var i=0;i<20;i++){barRandomOffsets.push([]);for(var r=0;r<10;r++){barRandomOffsets[i].push(10-rnd(20))}}Polymer("fin-hypergrid-behavior-in-memory",{ready:function(){this.colWidths=[50,150,80,90,80,150,100,80,80,100],this.fixedColWidths=[120],this.rows=5e3;this.cols=100;this.readyInit();this.permuteInterval=50;this.values=new Array(this.rows*this.cols);this.order=[];this.sorts=[];this.sortLookup={};this.sorted={};this.sortStates=[" -"," ^"," v"];this.createSort(0,2);this.createSort(0,14);this.createSort(0,22);this.initOrder();this.initialize();this.permute();this.reorder()},createCellProvider:function(){var self=this;var provider=document.createElement("fin-hypergrid-cell-provider");provider.getCell=function(config){var renderer=provider.cellCache.simpleCellRenderer;config.halign="left";var x=config.x;if(x===41){renderer=provider.cellCache.sliderCellRenderer}else if(x===23){renderer=provider.cellCache.sparkbarCellRenderer}else if(x===3){renderer=provider.cellCache.sparklineCellRenderer}else if(x===2){var hex=Math.floor(config.value*255/100).toString(16);if(hex.length<1){hex="0"+hex}var bgColor="#"+"00"+hex+"00";config.bgColor=bgColor}renderer.config=config;return renderer};return provider},setValues:function(c){var self=this;for(var x=c.xstart;x<c.xstop;x=x+c.xinc){for(var y=c.ystart;y<c.ystop;y=y+c.yinc){this.setRandomValue(x,y,c.cutoff)}}self.changed()},initialize:function(){var config={xstart:0,xstop:this.getColCount(),xinc:1,ystart:0,ystop:this.getRowCount(),yinc:1,cutoff:2};this.setValues(config)},permute:function(){var self=this;var config={xstart:this.scrollPositionX,xstop:this.scrollPositionX+this.renderedWidth,xinc:1,ystart:this.scrollPositionY,ystop:this.scrollPositionY+this.renderedHeight,yinc:1,cutoff:.05};this.setValues(config);setTimeout(function(){self.permute()},self.permuteInterval)},getCellEditorAt:function(x,y){x=this.translateColumnIndex(x);var type=x!==9?"textfield":this.editorTypes[y%this.editorTypes.length];var cellEditor=this.grid.cellEditors[type];return cellEditor},setRandomValue:function(col,row,cutoff){var rand=Math.random();var val=this._getValue(col,row);var rndV;if(rand>cutoff){return}if(col===13){val=rand<.1?true:false;this._setValue(col,row,val)}else if(col===23){if(!val){val=[rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100)]}else{rndV=Math.floor(60*rand);if(rndV>19){return}var rndOffsets=barRandomOffsets[rndV];for(var i=0;i<rndOffsets.length;i++){val[i]=Math.min(Math.max(0,val[i]+rndOffsets[i]),100)}}this._setValue(col,row,val)}else if(col===3){if(!val){val=[rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100),rnd(100)]}else{rndV=Math.floor(8e3*rand);if(rndV>99){return}if(val.shift){val.shift();val.push(rndV)}}this._setValue(col,row,val)}else if(col%10===0){val=[rand<.1?false:true,1];this._setValue(col,row,val)}else if(col===9){if(val){return}var hex=row.toString(16).toUpperCase();while(hex.length<6){hex="0"+hex}val="0x"+hex;this._setValue(col,row,val)}else if(col%6===0){if(val){return}var profound="Quidquid latine dictum sit, altum sonatur.";this._setValue(col,row,profound)}else if(col%4===0){var ipsum="Lorem ipsum dolor sit amet, malis repudiare mei in. Cu munere expetendis mea, affert aliquid definiebas at nam. Te scripta delectus singulis mel, et vidit error legere eum, ea latine feugait ponderum vix. Ius ei electram patrioque, et eum propriae deseruisse necessitatibus. Epicurei adipisci ex duo. Quidam iudicabit ullamcorper ex vel, per quot ipsum ad, libris quaeque iudicabit et usu. Ut postea nominavi cum, id eius porro mundi qui. Nec ex altera dolorum definiebas, consul viderer ex est. ";var index=Math.max(0,rand*ipsum.length-20);val=ipsum.slice(index,index+20).toUpperCase();this._setValue(col,row,val)}else if(col===2||col===14||col===22){var v=Math.min(Math.floor(rand*2e3),100);this._setValue(col,row,Math.max(v))}else if(col===41){this._setValue(col,row,Math.random())}else{this._setValue(col,row,rand)}},indexOf:function(row,col){var index=col*this.rows+row;return index},createSort:function(type,col){var self=this;var that={};that.type=type;that.col=col;that.value=function(array,index){return array[self.indexOf(self.order[index],col)]};that.compare=function(array,first,last){var x=that.value(array,first),y=that.value(array,last);if(typeof x==="number"){if(that.type===1){if(!y){return-1}return x-y}else{if(!y){return 1}return y-x}}else{if(that.type===1){if(!y){return-1}return x<y?-1:1}else{if(!y){return 1}return y<x?-1:1}}return 0};this.sorts.push(that);this.sortLookup[col]=that},swap:function(array,x,y){var tmp=this.order[x];this.order[x]=this.order[y];this.order[y]=tmp},compare:function(array,first,last){var comp=0;for(var i=0;i<this.sorts.length;++i){var sort=this.sorts[i];if(sort.type!==0){comp=sort.compare(array,first,last);if(comp===0){continue}break}}return comp},initOrder:function(){this.order=[];for(var i=0;i<this.rows;++i){this.order[i]=i}},quicksort:function(array,first,last,depth){if(depth>1e3){console.log("sort aborted!");return}var pivot=0;if(depth===0){if(this.sorts.length<=0){return}var sort=this.sorts[0];while(!sort.value(array,last)&&last>first){--last}var sorted=true;for(pivot=first;pivot<last;++pivot){if(this.compare(array,pivot,pivot+1)>0){sorted=false;break}}if(sorted){return}}while(first<last){var right=last;var left=first;pivot=first+last>>1;if(pivot<0||pivot>=last){break}while(right>=left){while(left<=right&&this.compare(array,left,pivot)<=0){++left}while(left<=right&&this.compare(array,right,pivot)>0){--right}if(left>right){break}this.swap(array,left,right);if(pivot===right){pivot=left}left++;right--}this.swap(array,pivot,right);right--;if(Math.abs(right-first)>Math.abs(last-left)){if(left<last){this.quicksort(array,left,last,depth+1)}last=right}else{if(first<right){this.quicksort(array,first,right,depth+1)}first=left}}},reorder:function(){this.initOrder();this.quicksort(this.values,0,this.rows-1,0)},orderOf:function(y){var row=this.order[y];return row},setValue:function(col,y,value){col=this.translateColumnIndex(col);this._setValue(col,y,value)},_setValue:function(col,y,value){var row=this.orderOf(y);var index=this.indexOf(row,col);this.values[index]=value},getValue:function(col,y){col=this.translateColumnIndex(col);return this._getValue(col,y)},_getValue:function(col,y){var row=this.orderOf(y);var index=this.indexOf(row,col);return this.values[index]},getRowCount:function(){return this.rows},getColCount:function(){return this.cols},getFixedRowValue:function(x){x=this.translateColumnIndex(x);var sortIndicator="";if(this.sortLookup[x]&&!this.sorted[x]){this.sorted[x]=0;sortIndicator=this.sortStates[this.sorted[x]]}if(this.sorted[x]){sortIndicator=this.sortStates[this.sorted[x]]}return this.alphaFor(x)+sortIndicator},fixedRowClicked:function(grid,mouse){var x=this.translateColumnIndex(mouse.gridCell.x-this.getFixedColCount());var colIndex=this.scrollPositionX+x;if([2,14,22].indexOf(colIndex)===-1){return}this.toggleSort(colIndex)},toggleSort:function(colIndex){var current=this.sorted[colIndex];var stateCount=this.sortStates.length;var sortStateIndex=(current+1)%stateCount;this.sorted[colIndex]=sortStateIndex;this.sortLookup[colIndex].type=sortStateIndex;this.reorder();this.changed()}})})();</script></polymer-element><polymer-element name="fin-hypergrid-behavior-json" extends="fin-hypergrid-behavior-default" assetpath="behaviors/"><template></template><script>"use strict";window.flashSort=function(a,property){var strVar="(function(a) { ";strVar+="        var n = a.length;";strVar+="";strVar+="        var i = 0, j = 0, k = 0, t;";strVar+="        var m = ~~( n * 0.125 );";strVar+="        var a_nmin = a[0];";strVar+="        var nmax = 0;";strVar+="        var nmove = 0;";strVar+="";strVar+="        var l = new Array(m);";strVar+="        for ( i = 0; i < m; i++ ) {";strVar+="            l[ i ] = 0;";strVar+="        }";strVar+="";strVar+="        for ( i = 1; i < n; ++i ) {";strVar+="            var a_i = a[ i ];";strVar+="            if ( a_i."+property+" < a_nmin."+property+" ) { a_nmin = a_i; }";strVar+="            if ( a_i."+property+" > a[ nmax ]."+property+" ) { nmax = i; }";strVar+="        }";strVar+="";strVar+="        var a_nmax = a[ nmax ];";strVar+="        if ( a_nmin."+property+" === a_nmax."+property+") { return a; }";strVar+="        var c1 = ( m - 1 ) / ( a_nmax."+property+" - a_nmin."+property+" );";strVar+="";strVar+="        for ( i = 0; i < n; ++i ) {";strVar+="            ++l[ ~~( c1 * ( a[ i ]."+property+" - a_nmin."+property+" ) ) ];";strVar+="        }";strVar+="";strVar+="        for ( k = 1; k < m; ++k ) {";strVar+="            l[ k ] += l[ k - 1 ];";strVar+="        }";strVar+="";strVar+="        var hold = a_nmax;";strVar+="        a[ nmax ] = a[ 0 ];";strVar+="        a[ 0 ] = hold;";strVar+="";strVar+="        var flash;";strVar+="        j = 0;";strVar+="        k = m - 1;";strVar+="        i = n - 1;";strVar+="";strVar+="        while ( nmove < i ) {";strVar+="            while ( j > ( l[ k ] - 1 ) ) {";strVar+="                k = ~~( c1 * ( a[ ++j ]."+property+" - a_nmin."+property+" ) );";strVar+="            }";strVar+="            if (k < 0) { break; }";strVar+="";strVar+="            flash = a[ j ];";strVar+="";strVar+="            while ( j !== l[ k ] ) {";strVar+="                k = ~~( c1 * ( flash."+property+" - a_nmin."+property+" ) );";strVar+="                hold = a[ t = --l[ k ] ];";strVar+="                a[ t ] = flash;";strVar+="                flash = hold;";strVar+="                ++nmove;";strVar+="            }";strVar+="        }";strVar+="";strVar+="        for( j = 1; j < n; ++j ) {";strVar+="            hold = a[ j ];";strVar+="            i = j - 1;";strVar+="            while( i >= 0 && a[i]."+property+" > hold."+property+" ) {";strVar+="                a[ i + 1 ] = a[ i-- ];";strVar+="            }";strVar+="            a[ i + 1 ] = hold;";strVar+="        }";strVar+="";strVar+="        return a; })";var sortFunction=eval(strVar);sortFunction(a)};window.dualPivotQuickSort=function(){var dualPivotQS={};dualPivotQS.sort=function(arr,property,fromIndex,toIndex){if(fromIndex===undefined&&toIndex===undefined){dualPivotQS.sort(arr,property,0,arr.length)}else{rangeCheck(arr.length,fromIndex,toIndex);dualPivotQuicksort(property,arr,fromIndex,toIndex-1,3)}return arr};function rangeCheck(length,fromIndex,toIndex){if(fromIndex>toIndex){console.error("fromIndex("+fromIndex+") > toIndex("+toIndex+")")}if(fromIndex<0){console.error(fromIndex)}if(toIndex>length){console.error(toIndex)}}function swap(arr,i,j){var temp=arr[i];arr[i]=arr[j];arr[j]=temp}function dualPivotQuicksort(property,arr,left,right,div){var len=right-left;if(len<27){for(var i=left+1;i<=right;i++){for(var j=i;j>left&&arr[j][property]<arr[j-1][property];j--){swap(arr,j,j-1)}}return}var third=Math.floor(len/div);var m1=left+third;var m2=right-third;if(m1<=left){m1=left+1}if(m2>=right){m2=right-1}if(arr[m1][property]<arr[m2][property]){swap(arr,m1,left);swap(arr,m2,right)}else{swap(arr,m1,right);swap(arr,m2,left)}var pivot1=arr[left];var pivot2=arr[right];var pivot1Val=pivot1[property];var pivot2Val=pivot2[property];var less=left+1;var great=right-1;for(var k=less;k<=great;k++){if(arr[k][property]<pivot1Val){swap(arr,k,less++)}else if(arr[k][property]>pivot2Val){while(k<great&&arr[great][property]>pivot2Val){great--}swap(arr,k,great--);if(arr[k][property]<pivot1Val){swap(arr,k,less++)}}}var dist=great-less;if(dist<13){div++}swap(arr,less-1,left);swap(arr,great+1,right);dualPivotQuicksort(property,arr,left,less-2,div);dualPivotQuicksort(property,arr,great+2,right,div);if(dist>len-13&&pivot1Val!=pivot2Val){for(var k=less;k<=great;k++){if(arr[k][property]==pivot1Val){swap(arr,k,less++)}else if(arr[k][property]==pivot2Val){swap(arr,k,great--);if(arr[k][property]==pivot1Val){swap(arr,k,less++)}}}}if(pivot1Val<pivot2Val){dualPivotQuicksort(property,arr,less,great,div)}}return dualPivotQS.sort}();(function(){Polymer("fin-hypergrid-behavior-json",{sorted:{},sortStates:[" "," ^"," v"],dataIndexes:[],data:[],headers:[],fields:[],setHeaders:function(headerLabels){this.headers=headerLabels},setFields:function(fieldNames){this.fields=fieldNames},setData:function(jsonData){this.data=jsonData;this.initDataIndexes();this.initColIndexes();this.changed()},initDataIndexes:function(){for(var i=0;i<this.data.length;i++){this.data[i].__si=i;this.data[i].__i=i}},getValue:function(x,y){var x=this.translateColumnIndex(x);return this.data[y][this.fields[x]]},setValue:function(x,y,value){var x=this.translateColumnIndex(x);this.data[y][this.fields[x]]=value},getFixedRowValue:function(x,y){x=this.translateColumnIndex(x);var sortIndex=this.sorted[x]||0;return this.headers[x]+this.sortStates[sortIndex]},getFixedColCount:function(){return 1},getRowCount:function(){return this.data.length},getColCount:function(){return this.fields.length},fixedRowClicked:function(grid,mouse){var colIndex=this.scrollPositionX+mouse.gridCell.x-this.getFixedColCount();this.toggleSort(colIndex)},toggleSort:function(colIndex){var colIndex=this.translateColumnIndex(colIndex);this.grid.clearSelections();if(colIndex>=this.fields.length){return}var current=this.sorted[colIndex]||0;var stateCount=this.sortStates.length;var sortStateIndex=(current+1)%stateCount;for(var i=0;i<this.fields.length;i++){this.sorted[i]=0}this.sorted[colIndex]=sortStateIndex;var colName=this.fields[colIndex];if(sortStateIndex===0){var newData=new Array(this.data.length);for(var i=0;i<this.data.length;i++){var each=this.data[i];newData[each.__si]=each}this.data=newData}else if(sortStateIndex===1){var start=Date.now();var theSorter=eval("(function (a, b) {"+"  if (a."+colName+" === b."+colName+")"+"    return a.__i - b.__i;"+"  if (a."+colName+" < b."+colName+")"+"    return -1;"+"  return 1;"+"})");this.data.sort(theSorter)}else{this.data=this.data.reverse()}for(var i=0;i<this.data.length;i++){this.data[i].__i=i}this.changed()}})})();</script></polymer-element><polymer-element name="fin-hypergrid-behavior-q" extends="fin-hypergrid-behavior-default" attributes="url" assetpath="behaviors/"><template></template><script>"use strict";(function(){var typeAlignmentMap={j:"right",s:"left",t:"center",f:"right",d:"center"};var typeRendererMap={J:"sparklineCellRenderer",j:"simpleCellRenderer",s:"simpleCellRenderer",t:"simpleCellRenderer",f:"simpleCellRenderer",d:"simpleCellRenderer"};Polymer("fin-hypergrid-behavior-q",{ready:function(){this.block={data:[],headers:[],rows:0};this.readyInit();this.sorted={};this.sortStates=[""," ^"," v"," |^|"," |v|"];this.ws=null;this.url=this.getAttribute("url")||"ws://localhost:5000/";this.connect();this.scrollPositionY=0;this.scrolled=false},createCellProvider:function(){var provider=document.createElement("fin-hypergrid-cell-provider");var self=this;provider.getCell=function(config){var x=config.x;var renderer=provider.cellCache[typeRendererMap[self.block.headers[x+1][1]]];if(x===11){renderer=provider.cellCache.sliderCellRenderer}else if(x===13){renderer=provider.cellCache.sparkbarCellRenderer}renderer.config=config;return renderer};return provider},getValue:function(x,y){var override=this.values["p_"+(x+1)+"_"+y];if(override){return override}var normalized=Math.floor(y-this.scrollPositionY);if(this.block&&normalized<this.block.data.length){return this.block.data[normalized][x+1]}else{return""}},clearData:function(){this.block.rows=[];this.changed()},getRowCount:function(){return this.block.rows},getColCount:function(){return this.block.headers.length-1},setScrollPositionY:function(y){this.scrollPositionY=y;if(!this.isConnected()){return}this.ws.send(JSON.stringify({cmd:"fetch",data:{start:this.scrollPositionY,num:60}}))},isConnected:function(){if(!this.ws){return false}return this.ws.readyState===this.ws.OPEN},getFixedRowValue:function(x){if(!this.sorted[x+1]){this.sorted[x+1]=0}var sortIndicator=this.sortStates[this.sorted[x+1]];return this.block.headers[x+1][0]+sortIndicator},getFixedColValue:function(x,y){return this.getValue(-1,y)},getCanSort:function(){var canSort=this.block.features.sorting===true;return canSort},fixedRowClicked:function(grid,mouse){this.toggleSort(this.scrollPositionX+mouse.cell.x-this.getFixedColCount())},toggleSort:function(colIndex){if(!this.getCanSort()){return}colIndex++;var current=this.sorted[colIndex];var stateCount=this.sortStates.length;this.sorted={};this.sorted[colIndex]=(current+1)%stateCount;var state=this.sortStates[this.sorted[colIndex]];var message={cmd:"sort",data:{sort:current===stateCount-1?"":this.block.headers[colIndex][0],asc:state.indexOf("^")>0,abs:state.indexOf("|")>0,start:this.scrollPositionY,num:60}};this.ws.send(JSON.stringify(message))},getColAlignment:function(x){var alignment=typeAlignmentMap[this.block.headers[x+1][1]];return alignment},setValue:function(x,y,value){this.values["p_"+(x+1)+"_"+y]=value},connect:function(){var d;var oldSize;var self=this;if("WebSocket"in window){try{this.ws=new WebSocket(this.url)}catch(e){console.log("could not connect to "+this.url+", trying to reconnect in a moment...");return}console.log("connecting...");this.ws.onopen=function(){console.log("connected");self.ws.send(JSON.stringify({cmd:"fetch",data:{start:this.scrollPositionY||0,num:60}}))};this.ws.onclose=function(){self.clearData();console.log("disconnected from "+this.url+", trying to reconnect in a moment...");setTimeout(function(){},2e3)};this.ws.onmessage=function(e){d=JSON.parse(e.data);oldSize=self.block.rows;self.block=d;if(d.rows!==oldSize){self.sizeChanged()}self.changed()};this.ws.onerror=function(e){self.clearData();console.error("problem with connection to q at "+this.url+", trying again in a moment...",e.data);setTimeout(function(){},2e3)}}else{console.error("WebSockets not supported on your browser.")}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-base" assetpath="cell-editors/"><template></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-base",{isEditing:false,editorPoint:null,checkEditorPositionFlag:false,input:null,alias:"base",grid:null,ready:function(){this.readyInit()},readyInit:function(){},installOn:function(grid){this.grid=grid;grid.registerCellEditor(this.alias,this)},getBehavior:function(){return this.grid.getBehavior()},gridRenderedNotification:function(){this.checkEditor()},scrollValueChangedNotification:function(){this.setCheckEditorPositionFlag()},setCheckEditorPositionFlag:function(){this.checkEditorPositionFlag=true},beginEditAt:function(point){this.setEditorPoint(point);var model=this.getBehavior();var value=model.getValue(point.x,point.y);this.setEditorValue(value);this.isEditing=true;this.setCheckEditorPositionFlag();this.checkEditor()},setEditorValue:function(value){},getEditorPoint:function(){return this.editorPoint},setEditorPoint:function(point){this.editorPoint=point},showEditor:function(){},hideEditor:function(){},stopEditing:function(){if(!this.isEditing){return}this.saveEditorValue();this.isEditing=false;this.hideEditor()},saveEditorValue:function(){var point=this.getEditorPoint();var value=this.getEditorValue();this.getBehavior().setValue(point.x,point.y,value)},getEditorValue:function(){},takeFocus:function(){},moveEditor:function(model){var model=this.getBehavior();var numFixedCols=model.getFixedColCount();var numFixedRows=model.getFixedRowCount();var vScroll=this.grid.getVScrollValue();var hScroll=this.grid.getHScrollValue();var editorPoint=this.getEditorPoint();var x=editorPoint.x+numFixedCols-hScroll;var y=editorPoint.y+numFixedRows-vScroll;var eb=this.grid.getBoundsOfCell(this.rectangles.point.create(x,y));var db=this.grid.getDataBounds();var cellBounds=eb.intersect(db);this.setBounds(cellBounds);this.takeFocus()},setBounds:function(rectangle){},checkEditor:function(){if(!this.checkEditorPositionFlag){return}else{this.checkEditorPositionFlag=false}if(!this.isEditing){return}var editorPoint=this.getEditorPoint();if(this.grid.isDataVisible(editorPoint.x,editorPoint.y)){this.moveEditor();this.showEditor()}else{this.hideEditor()}}})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-simple" extends="fin-hypergrid-cell-editor-base" assetpath="cell-editors/"><template><div id="editor"></div></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-simple",{alias:"simple",readyInit:function(){var self=this;this.rectangles=document.createElement("fin-rectangle");this.editorPoint=this.rectangles.point.create(0,0);this.input=this.shadowRoot.querySelector("#editor");this.input.addEventListener("keypress",function(e){if(e&&e.keyCode===13){e.preventDefault();self.stopEditing();self.grid.repaint();self.grid.takeFocus()}});this.input.style.position="absolute";this.input.style.display="none";this.input.style.border="solid 2px black";this.input.style.outline=0;this.input.style.padding=0;this.input.style.zIndex=1e3},getEditorValue:function(){var value=this.input.value;return value},setEditorValue:function(value){this.input.value=value+""},showEditor:function(){this.input.style.display="inline"},hideEditor:function(){this.input.style.display="none"},takeFocus:function(){var self=this;setTimeout(function(){self.input.focus();self.selectAll()},300)},selectAll:function(){},originOffset:function(){return[-2,-2]},setBounds:function(cellBounds){var originOffset=this.originOffset();var translation="translate("+(cellBounds.origin.x+originOffset[0])+"px,"+(cellBounds.origin.y+originOffset[1])+"px)";this.input.style.webkitTransform=translation;this.input.style.MozTransform=translation;this.input.style.msTransform=translation;this.input.style.OTransform=translation;this.input.style.width=cellBounds.extent.x+"px";this.input.style.height=cellBounds.extent.y+"px"}})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-textfield" extends="fin-hypergrid-cell-editor-simple" assetpath="cell-editors/"><template><input id="editor"></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-textfield",{alias:"textfield",selectAll:function(){this.input.setSelectionRange(0,this.input.value.length)}})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-choice" extends="fin-hypergrid-cell-editor-simple" assetpath="cell-editors/"><template><select id="editor"><option template="" repeat="{{item in items}}" value="{{item}}">{{item}}</option></select></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-choice",{alias:"choice",items:["Moe","Larry","Curly","Groucho","Harpo","Zeppo","Chico"],originOffset:function(){return[-1,-1]}})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-color" extends="fin-hypergrid-cell-editor-simple" assetpath="cell-editors/"><template><input id="editor" type="color"></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-color",{alias:"color"})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-date" extends="fin-hypergrid-cell-editor-simple" assetpath="cell-editors/"><template><input id="editor" type="date"></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-date",{alias:"date"})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-slider" extends="fin-hypergrid-cell-editor-simple" assetpath="cell-editors/"><template><input id="editor" type="range"></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-slider",{alias:"slider"})})();</script></polymer-element><polymer-element name="fin-hypergrid-cell-editor-spinner" extends="fin-hypergrid-cell-editor-simple" assetpath="cell-editors/"><template><input id="editor" type="number"></template><script>"use strict";(function(){Polymer("fin-hypergrid-cell-editor-spinner",{alias:"spinner"})})();</script></polymer-element><polymer-element name="fin-hypergrid-excel" assetpath=""><template></template><script>(function(){"use strict";var excelOriginOffset=1;var createExcelDataFromSelections=function(grid){var selectionModel=grid.getSelectionModel();var selections=selectionModel.getSelections();if(selections.length===0){return}var behavior=grid.getBehavior();var collector=[];var obj;for(var i=0;i<selections.length;i++){var each=selections[i];var eachData=[];var xstart=each.origin.x;var xstop=each.origin.x+each.extent.x+1;var ystart=each.origin.y;var ystop=each.origin.y+each.extent.y+1;for(var y=ystart;y<ystop;y++){for(var x=xstart;x<xstop;x++){var data=behavior.getValue(x,y);eachData.push(data+"")}}obj={region:[excelOriginOffset+ystart,excelOriginOffset+xstart,ystop,xstop],values:eachData};collector.push(obj)}obj={now:(new Date).getTime(),selection:collector};return obj};var publish=function(grid){if(!grid.hasSelections()){return}var excelMessage=createExcelDataFromSelections(grid);fin.desktop.InterApplicationBus.publish("onSelect",excelMessage);console.log("push to excel",excelMessage)};var subscribe=function(grid){var sm=grid.getSelectionModel();fin.desktop.InterApplicationBus.subscribe("*","onExcelChange",function(data){console.log(JSON.stringify(data));if(data.cells&&data.cells.length>0){data.cells.forEach(function(cell){if(cell.value&&!sm.isSelected(cell.row,cell.column)){grid.setValue(cell.column-excelOriginOffset,cell.row-excelOriginOffset,cell.value)}})}});fin.desktop.InterApplicationBus.subscribe("*","ExcelError",function(data){console.log(JSON.stringify(data))})};var excel=function(grid){if(!fin){console.error("Excel integration only works within the OpenFin Runtime");return}fin.desktop.main(function(){fin.desktop.Application.getCurrent();setInterval(function(){publish(grid)},1e3/2);subscribe(grid)})};if(!window.fin){excel=function(){}}Polymer("fin-hypergrid-excel",{installOn:excel})})();</script></polymer-element></div><polymer-element name="fin-hypergrid" assetpath=""><template><style>:host{position:relative;display:inline-block;webkit-user-select:none;moz-user-select:none;ms-user-select:none;o-user-select:none;user-select:none}#verticalScroller{position:absolute;top:0;right:0;bottom:0;left:100%;margin-top:0;margin-left:-15px;margin-bottom:15px;margin-right:15px}#horizontalScroller{position:absolute;top:100%;right:0;bottom:0;left:0;margin-top:-15px;margin-left:0;margin-bottom:15px;margin-right:15px}#editor{position:absolute;display:none;border:solid 2px #000;outline:0;padding:0;z-index:1000}#dragger{position:absolute;display:none;opacity:.75}#floatColumn{position:absolute;display:none}fin-vampire-bar{z-index:10}</style><fin-plugins><fin-hypergrid-cell-editor-textfield></fin-hypergrid-cell-editor-textfield><fin-hypergrid-cell-editor-choice></fin-hypergrid-cell-editor-choice><fin-hypergrid-cell-editor-color></fin-hypergrid-cell-editor-color><fin-hypergrid-cell-editor-date></fin-hypergrid-cell-editor-date><fin-hypergrid-cell-editor-slider></fin-hypergrid-cell-editor-slider><fin-hypergrid-cell-editor-spinner></fin-hypergrid-cell-editor-spinner></fin-plugins><fin-vampire-bar id="horizontalScroller" horizontal=""></fin-vampire-bar><fin-vampire-bar id="verticalScroller"></fin-vampire-bar><fin-canvas><fin-hypergrid-renderer></fin-hypergrid-renderer></fin-canvas><input id="editor"><canvas id="dragger"></canvas><canvas id="floatColumn"></canvas><content></content></template><script>"use strict";(function(){var noop=function(){};var colAnimationTime=100;Polymer("fin-hypergrid",{behavior:{setScrollPositionY:noop,setScrollPositionX:noop,getColCount:noop,getFixedColCount:noop,getFixedColsWidth:noop,getFixedColsMaxWidth:noop,setRenderedWidth:noop,getRowCount:noop,getFixedRowCount:noop,getFixedRowsHeight:noop,getFixedRowsMaxHeight:noop,setRenderedHeight:noop,getCellProvider:noop,click:noop,doubleClick:noop},mouseDown:[],dragExtent:null,vScrlValue:0,hScrlValue:0,rectangles:null,constants:null,selectionModel:null,cellEdtr:null,sbMouseIsDown:false,sbHScroller:null,sbVScroller:null,sbHScrlCfg:{},sbVScrlCfg:{},sbPrevVScrlVal:null,sbPrevHScrlVal:null,sbHValueHolder:{},sbVValueHolder:{},cellEditors:null,columnRenderOverridesCache:{},floaterAnimationQueue:[],columnDragAutoScrolling:false,domReady:function(){var self=this;this.rectangles=document.createElement("fin-rectangle");this.constants=document.createElement("fin-hypergrid-constants").values;this.selectionModel=document.createElement("fin-hypergrid-selection-model");this.cellEditors={};this.columnRenderOverridesCache={};this.oncontextmenu=function(event){event.preventDefault();return false};this.clearMouseDown();this.dragExtent=this.rectangles.point.create(0,0);this.columnDragAutoScrolling=false;this.pluginsDo(function(each){if(each.installOn){each.installOn(self)}});this.initCanvas();this.initRenderer();this.initScrollbars();this.dragger=this.shadowRoot.querySelector("#dragger");this.draggerCTX=this.dragger.getContext("2d");this.floatColumn=this.shadowRoot.querySelector("#floatColumn");this.floatColumnCTX=this.floatColumn.getContext("2d");document.body.addEventListener("copy",function(evt){self.checkClipboardCopy(evt)});this.resized()},getMouseDown:function(){var last=this.mouseDown.length-1;if(last<0){return null}return this.mouseDown[last]},popMouseDown:function(){if(this.mouseDown.length===0){return}this.mouseDown.length=this.mouseDown.length-1},clearMouseDown:function(){this.mouseDown=[this.rectangles.point.create(-1,-1)];this.dragExtent=null},setMouseDown:function(point){this.mouseDown.push(point)},getDragExtent:function(){return this.dragExtent},setDragExtent:function(point){this.dragExtent=point},pluginsDo:function(func){var userPlugins=this.children.array();var pluginsTag=this.shadowRoot.querySelector("fin-plugins");var plugins=userPlugins;if(pluginsTag){var systemPlugins=pluginsTag.children.array();plugins=systemPlugins.concat(plugins)}for(var i=0;i<plugins.length;i++){var plugin=plugins[i];func(plugin)}},getCellProvider:function(){var provider=this.getBehavior().getCellProvider();return provider},gridRenderedNotification:function(){this.updateRenderedSizes();this.pluginsDo(function(each){if(each.gridRenderedNotification){each.gridRenderedNotification()}})},updateRenderedSizes:function(){var behavior=this.getBehavior();behavior.setRenderedWidth(this.getViewableCols()+1);behavior.setRenderedHeight(this.getViewableRows()+1)},checkClipboardCopy:function(evt){if(!this.hasFocus()){return}evt.preventDefault();var csvData=this.getSelectionAsTSV();evt.clipboardData.setData("text/plain",csvData)},hasSelections:function(){if(!this.getSelectionModel){return}return this.getSelectionModel().hasSelections()},getSelectionAsTSV:function(){var selectionModel=this.getSelectionModel();var selections=selectionModel.getSelections();if(selections.length===0){return}var last=selections[selections.length-1];var area=last.area();if(area>1e4){alert("selection size is too big to copy to the paste buffer");return""}var behavior=this.getBehavior();var collector=[];var xstart=last.origin.x;var xstop=last.origin.x+last.extent.x+1;var ystart=last.origin.y;var ystop=last.origin.y+last.extent.y+1;for(var y=ystart;y<ystop;y++){for(var x=xstart;x<xstop;x++){var data=behavior.getValue(x,y);collector.push(data);if(x!==xstop-1){collector.push("	")}}if(y!==ystop-1){collector.push("\n")}}var text=collector.join("");return text},hasFocus:function(){return this.getCanvas().hasFocus()},clearSelections:function(){this.getSelectionModel().clear();this.clearMouseDown()},clearMostRecentSelection:function(){this.getSelectionModel().clearMostRecentSelection()},select:function(ox,oy,ex,ey){if(ox<0||oy<0){return}this.getSelectionModel().select(ox,oy,ex,ey)},isSelected:function(x,y){return this.getSelectionModel().isSelected(x,y)},isFixedRowCellSelected:function(col){var selectionModel=this.getSelectionModel();var isSelected=selectionModel.isFixedRowCellSelected(col);return isSelected},isFixedColCellSelected:function(row){var selectionModel=this.getSelectionModel();var isSelected=selectionModel.isFixedColCellSelected(row);return isSelected},getSelectionModel:function(){return this.selectionModel},getBehavior:function(){return this.behavior},setBehavior:function(newBehavior){this.behavior=newBehavior;this.behavior.setGrid(this);var self=this;var numCols=this.behavior.getColCount();var numRows=this.behavior.getRowCount();this.behavior.changed=function(){if(numCols!==self.behavior.getColCount()||numRows!==self.behavior.getRowCount()){numCols=self.behavior.getColCount();numRows=self.behavior.getRowCount();self.behaviorShapeChanged()}self.repaint()};this.behavior.sizeChanged=function(){self.repaint()};if(this.behavior){}},behaviorShapeChanged:function(){this.synchronizeScrollingBoundries()},repaint:function(){this.getCanvas().repaint()},isHiDPI:function(){return this.getAttribute("hidpi")!==null},initCanvas:function(){var self=this;this.canvas=this.shadowRoot.querySelector("fin-canvas");this.canvas.setAttribute("fps",this.constants.repaintIntervalRate||15);this.canvas.isHiDPI=function(){return self.isHiDPI()};this.canvas.style.position="absolute";this.canvas.style.top=0;this.canvas.style.right="-200px";this.canvas.style.marginRight="15px";this.canvas.style.bottom=0;this.canvas.style.marginBottom="15px";this.canvas.style.left=0;this.canvas.resizeNotification=function(){self.resized()};this.canvas.addEventListener("fin-mousemove",function(e){var mouse=e.detail.mouse;var mouseEvent=self.getGridCellFromMousePoint(mouse);mouseEvent.primitiveEvent=e;self.delegateMouseMove(mouseEvent)});this.canvas.addEventListener("fin-mousedown",function(e){self.stopEditing();var mouse=e.detail.mouse;var mouseEvent=self.getGridCellFromMousePoint(mouse);mouseEvent.primitiveEvent=e;self.delegateMouseDown(mouseEvent)});this.canvas.addEventListener("fin-mouseup",function(e){self.dragging=false;if(self.scrollingNow){self.scrollingNow=false}if(self.columnDragAutoScrolling){self.columnDragAutoScrolling=false}var mouse=e.detail.mouse;var mouseEvent=self.getGridCellFromMousePoint(mouse);mouseEvent.primitiveEvent=e;self.delegateMouseUp(mouseEvent)});this.canvas.addEventListener("fin-tap",function(e){var mouse=e.detail.mouse;var tapEvent=self.getGridCellFromMousePoint(mouse);tapEvent.primitiveEvent=e;self.delegateTap(tapEvent)});this.canvas.addEventListener("fin-drag",function(e){self.dragging=true;var mouse=e.detail.mouse;var mouseEvent=self.getGridCellFromMousePoint(mouse);mouseEvent.primitiveEvent=e;self.delegateMouseDrag(mouseEvent)});this.canvas.addEventListener("fin-keydown",function(e){self.delegateKeyDown(e)});this.canvas.addEventListener("fin-track",function(e){if(self.dragging){return}var primEvent=e.detail.primitiveEvent;if(Math.abs(primEvent.dy)>Math.abs(primEvent.dx)){if(primEvent.yDirection>0){self.scrollVBy(-2)}else if(primEvent.yDirection<-0){self.scrollVBy(2)}}else{if(primEvent.xDirection>0){self.scrollHBy(-1)}else if(primEvent.xDirection<-0){self.scrollHBy(1)}}});this.canvas.addEventListener("fin-holdpulse",function(e){var mouse=e.detail.mouse;var mouseEvent=self.getGridCellFromMousePoint(mouse);mouseEvent.primitiveEvent=e;self.delegateHoldPulse(mouseEvent)});this.canvas.addEventListener("fin-dblclick",function(e){var mouse=e.detail.mouse;var mouseEvent=self.getGridCellFromMousePoint(mouse);mouseEvent.primitiveEvent=e;self.delegateDoubleClick(mouseEvent)});this.canvas.addEventListener("fin-wheelmoved",function(e){var mouse=e.detail.mouse;var mouseEvent=self.getGridCellFromMousePoint(mouse);mouseEvent.primitiveEvent=e.detail.primitiveEvent;self.delegateWheelMoved(mouseEvent)})},overColumnDivider:function(mouseEvent){var x=mouseEvent.primitiveEvent.detail.mouse.x;var whichCol=this.getRenderer().overColumnDivider(x);return whichCol},beColumnResizeCursor:function(){this.style.cursor="col-resize"},bePointerCursor:function(){this.style.cursor="pointer"},beMoveCursor:function(){this.style.cursor="move"},beCursor:function(cursorName){this.style.cursor=cursorName},beDefaultCursor:function(){this.style.cursor="default"},delegateWheelMoved:function(event){var behavior=this.getBehavior();behavior.onWheelMoved(this,event)},delegateMouseMove:function(mouseDetails){var behavior=this.getBehavior();behavior.onMouseMove(this,mouseDetails)},delegateMouseDown:function(mouseDetails){var behavior=this.getBehavior();behavior.handleMouseDown(this,mouseDetails)},delegateMouseUp:function(mouseDetails){var behavior=this.getBehavior();behavior.onMouseUp(this,mouseDetails)},delegateTap:function(mouseDetails){var behavior=this.getBehavior();behavior.onTap(this,mouseDetails)},delegateMouseDrag:function(mouseDetails){var behavior=this.getBehavior();behavior.onMouseDrag(this,mouseDetails)},delegateDoubleClick:function(mouseDetails){var behavior=this.getBehavior();behavior.onDoubleClick(this,mouseDetails)},delegateHoldPulse:function(mouseDetails){var behavior=this.getBehavior();behavior.onHoldPulse(this,mouseDetails)},delegateKeyDown:function(e){var behavior=this.getBehavior();behavior.onKeyDown(this,e)},stopEditing:function(){if(this.cellEdtr){this.cellEdtr.stopEditing();this.cellEdtr=null}},registerCellEditor:function(alias,cellEditor){this.cellEditors[alias]=cellEditor},getDataBounds:function(){var behavior=this.getBehavior();var b=this.canvas.bounds;var x=behavior.getFixedColsWidth()+2;var y=behavior.getFixedRowsHeight()+2;var result=this.rectangles.rectangle.create(x,y,b.origin.x+b.extent.x-x,b.origin.y+b.extent.y-y);return result},getCanvas:function(){return this.canvas},editAt:function(cellEditor,coordinates){this.cellEdtr=cellEditor;var cell=coordinates.gridCell;var behavior=this.getBehavior();var scrollTop=this.getVScrollValue();var scrollLeft=this.getHScrollValue();var numFixedCols=behavior.getFixedColCount();var numFixedRows=behavior.getFixedRowCount();var x=cell.x-numFixedCols+scrollLeft;var y=cell.y-numFixedRows+scrollTop;if(x<0||y<0){return}var editPoint=this.rectangles.point.create(x,y);this.setMouseDown(editPoint);this.setDragExtent(this.rectangles.point.create(0,0));cellEditor.beginEditAt(editPoint)},isDataColVisible:function(colIndex){var isVisible=this.getRenderer().isColVisible(colIndex);return isVisible},isDataRowVisible:function(rowIndex){var isVisible=this.getRenderer().isRowVisible(rowIndex);return isVisible},isDataVisible:function(colIndex,rowIndex){var isVisible=this.isDataRowVisible(rowIndex)&&this.isDataColVisible(colIndex);return isVisible},insureModelColIsViewable:function(c,offsetX){var viewableCols=this.getViewableCols()-1;if(!this.isDataColVisible(c)){var newSX=offsetX<0?c:c-viewableCols;this.setHScrollValue(newSX);return true}return false},insureModelRowIsViewable:function(r,offsetY){var viewableRows=this.getViewableRows()-1;if(!this.isDataRowVisible(r)){var newSY=offsetY<0?r:r-viewableRows;this.setVScrollValue(newSY);return true}return false},scrollBy:function(offsetX,offsetY){this.scrollHBy(offsetX);this.scrollVBy(offsetY)},scrollVBy:function(offsetY){var max=this.sbVScrlCfg.rangeStop;var oldValue=this.getVScrollValue();var newValue=Math.min(max,Math.max(0,oldValue+offsetY));if(newValue===oldValue){return}this.setVScrollValue(newValue)},scrollHBy:function(offsetX){var max=this.sbHScrlCfg.rangeStop;var oldValue=this.getHScrollValue();var newValue=Math.min(max,Math.max(0,oldValue+offsetX));if(newValue===oldValue){return}this.setHScrollValue(newValue)},getGridCellFromMousePoint:function(mouse){var cell=this.getRenderer().getGridCellFromMousePoint(mouse);return cell},getBoundsOfCell:function(cell){var bounds=this.getRenderer().getBoundsOfCell(cell);return bounds},resized:function(){this.synchronizeScrollingBoundries()},setVScrollValue:function(y){var self=this;this.getBehavior().setScrollPositionY(y);this.vScrlValue=y;this.scrollValueChangedNotification();setTimeout(function(){self.sbVRangeAdapter.subjectChanged()})},getVScrollValue:function(){return this.vScrlValue},setHScrollValue:function(x){var self=this;this.getBehavior().setScrollPositionX(x);this.hScrlValue=x;this.scrollValueChangedNotification();setTimeout(function(){self.sbHRangeAdapter.subjectChanged()})},getHScrollValue:function(){return this.hScrlValue},takeFocus:function(){if(this.isEditing()){this.editorTakeFocus()}this.getCanvas().takeFocus()},editorTakeFocus:function(){if(this.cellEdtr){return this.cellEdtr.takeFocus()}},isEditing:function(){if(this.cellEdtr){return this.cellEdtr.isEditing}return false},initScrollbars:function(){var self=this;var canvas=this.getCanvas();var scrollbars=this.shadowRoot.querySelectorAll("fin-vampire-bar");this.sbHScroller=scrollbars[0];this.sbVScroller=scrollbars[1];this.sbHScroller.onUpClick=function(){self.scrollHBy(1)};this.sbHScroller.onDownClick=function(){self.scrollHBy(-1)};this.sbHScroller.onUpHold=function(event){event.preventTap();self.scrollHBy(1)};this.sbHScroller.onDownHold=function(event){event.preventTap();self.scrollHBy(-1)};this.addEventListener("mousedown",function(){self.sbMouseIsDown=true});this.sbVScroller.onUpClick=function(){self.scrollVBy(-1)};this.sbVScroller.onDownClick=function(){self.scrollVBy(1)};this.sbVScroller.onUpHold=function(event){event.preventTap();self.scrollVBy(-1)};this.sbVScroller.onDownHold=function(event){event.preventTap();self.scrollVBy(1)};this.addEventListener("mousedown",function(){self.sbMouseIsDown=true});document.addEventListener("mouseup",function(e){if(!self.sbMouseIsDown){return}self.sbMouseIsDown=false;var origin=canvas.getOrigin();var point=self.rectangles.point.create(e.x-origin.x,e.y-origin.y);if(!canvas.bounds.contains(point)){self.takeFocus()}});this.sbHValueHolder={changed:false,getValue:function(){return self.getHScrollValue()},setValue:function(v){self.setHScrollValue(v)}};this.sbVValueHolder={changed:false,getValue:function(){return self.getVScrollValue()},setValue:function(v){self.setVScrollValue(v)}};this.sbHScrlCfg={step:1,page:40,rangeStart:0,rangeStop:0};this.sbVScrlCfg={step:1,page:40,rangeStart:0,rangeStop:0};this.sbHRangeAdapter=this.sbHScroller.createRangeAdapter(this.sbHValueHolder,this.sbHScrlCfg);this.sbVRangeAdapter=this.sbHScroller.createRangeAdapter(this.sbVValueHolder,this.sbVScrlCfg);this.sbHScroller.setRangeAdapter(this.sbHRangeAdapter);this.sbVScroller.setRangeAdapter(this.sbVRangeAdapter)},scrollValueChangedNotification:function(){if(this.hScrlValue===this.sbPrevHScrlVal&&this.vScrlValue===this.sbPrevVScrlVal){return}this.sbHValueHolder.changed=!this.sbHValueHolder.changed;this.sbVValueHolder.changed=!this.sbVValueHolder.changed;this.sbPrevHScrlVal=this.hScrlValue;this.sbPrevVScrlVal=this.vScrlValue;if(this.cellEdtr){this.cellEdtr.scrollValueChangedNotification()}},setValue:function(x,y,value){this.getBehavior().setValue(x,y,value);this.repaint()},synchronizeScrollingBoundries:function(){var behavior=this.getBehavior();if(!behavior){return}var numCols=behavior.getColCount();var numRows=behavior.getRowCount();var bounds=this.getCanvas().getBounds();var scrollableHeight=bounds.height()-behavior.getFixedRowsHeight();var scrollableWidth=bounds.width()-behavior.getFixedColsMaxWidth()-200;var lastPageColCount=0;var colsWidth=0;for(;lastPageColCount<numCols;lastPageColCount++){var eachWidth=behavior.getColWidth(numCols-lastPageColCount-1);colsWidth=colsWidth+eachWidth;if(colsWidth>scrollableWidth){break}}var lastPageRowCount=0;var rowsHeight=0;for(;lastPageRowCount<numRows;lastPageRowCount++){var eachHeight=behavior.getRowHeight(numRows-lastPageRowCount-1);rowsHeight=rowsHeight+eachHeight;if(rowsHeight>scrollableHeight){break}}this.sbVScrlCfg.rangeStop=behavior.getRowCount()-lastPageRowCount;this.sbHScrlCfg.rangeStop=behavior.getColCount()-lastPageColCount;this.sbVScroller.tickle();this.sbHScroller.tickle()},getViewableRows:function(){return this.getRenderer().getViewableRows()},getViewableCols:function(){return this.getRenderer().getViewableCols()},initRenderer:function(){this.renderer=this.shadowRoot.querySelector("fin-hypergrid-renderer");this.renderer.setGrid(this)},getRenderer:function(){return this.renderer},getColumnWidth:function(colIndex){return this.getBehavior().getColWidth(colIndex)},setColumnWidth:function(colIndex,colWidth){this.getBehavior().setColumnWidth(colIndex,colWidth)},getFixedColumnWidth:function(colIndex){return this.getBehavior().getFixedColWidth(colIndex)},getFixedColsWidth:function(){return this.getBehavior().getFixedColsWidth()},getFixedRowsHeight:function(){return this.getBehavior().getFixedRowsHeight()},setFixedColumnWidth:function(colIndex,colWidth){this.getBehavior().setFixedColumnWidth(colIndex,colWidth)},getColCount:function(){return this.getBehavior().getColCount()},getRowCount:function(){return this.getBehavior().getRowCount()},getFixedColCount:function(){return this.getBehavior().getFixedColCount()},getFixedRowCount:function(){return this.getBehavior().getFixedRowCount()},fixedRowClicked:function(mouse){this.getBehavior().fixedRowClicked(this,mouse)},fixedColClicked:function(mouse){this.getBehavior().fixedColClicked(this,mouse)},activateEditor:function(event){var gridCell=event.gridCell;var mX=this.getHScrollValue()+gridCell.x-1;var mY=this.getVScrollValue()+gridCell.y-1;var editor=this.getCellEditorAt(mX,mY);this.editAt(editor,event)},getCellEditorAt:function(x,y){var translatedX=this.translateColumnIndex(x);return this.getBehavior().getCellEditorAt(translatedX,y)},translateColumnIndex:function(x){var behavior=this.getBehavior();var translatedX=behavior.translateColumnIndex(x);return translatedX},floatColumnTo:function(columnDragDirection){var scrollLeft=this.getHScrollValue();var floaterIndex=this.columnRenderOverridesCache.floater.colIndex;var draggerIndex=this.columnRenderOverridesCache.dragger.colIndex;var hdpiratio=this.columnRenderOverridesCache.dragger.hdpiratio;var numFixedCols=this.getFixedColCount();var draggerStartX;var floaterStartX;if(columnDragDirection){draggerStartX=this.renderer.renderedColWidths[draggerIndex+numFixedCols];floaterStartX=draggerStartX+this.getColumnWidth(floaterIndex+scrollLeft);this.columnRenderOverridesCache.dragger.startX=floaterStartX*hdpiratio;this.columnRenderOverridesCache.floater.startX=draggerStartX*hdpiratio;floaterStartX=draggerStartX+this.getColumnWidth(draggerIndex+scrollLeft)}else{floaterStartX=this.renderer.renderedColWidths[floaterIndex+numFixedCols];draggerStartX=floaterStartX+this.getColumnWidth(draggerIndex+scrollLeft);this.columnRenderOverridesCache.dragger.startX=floaterStartX*hdpiratio;this.columnRenderOverridesCache.floater.startX=draggerStartX*hdpiratio}this.getBehavior().swapColumns(draggerIndex+scrollLeft,floaterIndex+scrollLeft);this.columnRenderOverridesCache.dragger.colIndex=floaterIndex;this.columnRenderOverridesCache.floater.colIndex=draggerIndex;this.floaterAnimationQueue.unshift(this.doColumnMoveAnimation(floaterStartX,draggerStartX));this.doFloaterAnimation()},doColumnMoveAnimation:function(floaterStartX,draggerStartX){var self=this;return function(){var d=self.floatColumn;d.style.display="inline";d.style.webkitTransform="translate("+floaterStartX+"px, "+0+"px)";window.requestAnimationFrame(function(){d.style.webkitTransition="-webkit-transform "+colAnimationTime+"ms ease";d.style.transition="transform "+colAnimationTime+"ms ease";d.style.webkitTransform="translate("+draggerStartX+"px, "+0+"px)"});self.repaint();setTimeout(function(){d.style.display="none";d.style.webkitTransition="";d.style.transition="";self.columnRenderOverridesCache.floater=null;self.repaint();self.doFloaterAnimation()},colAnimationTime+50)}},doFloaterAnimation:function(){if(this.floaterAnimationQueue.length===0){return}var animation=this.floaterAnimationQueue.pop();animation()},createFloatColumn:function(colIndex){var scrollLeft=this.getHScrollValue();var numFixedCols=this.getFixedColCount();var colWidth=colIndex<0?this.getFixedColumnWidth(numFixedCols+colIndex+scrollLeft):this.getColumnWidth(colIndex+scrollLeft);var colHeight=this.clientHeight;var d=this.floatColumn;var hdpiRatio=this.getHiDPI(this.floatColumnCTX);d.setAttribute("width",Math.round(colWidth*hdpiRatio)+"px");d.setAttribute("height",Math.round(colHeight*hdpiRatio)+"px");d.style.width=colWidth+"px";d.style.height=colHeight+"px";var startX=this.renderer.renderedColWidths[colIndex+numFixedCols];startX=startX*hdpiRatio;this.floatColumnCTX.scale(hdpiRatio,hdpiRatio);this.columnRenderOverridesCache.floater={colIndex:colIndex,ctx:this.floatColumnCTX,startX:startX,width:colWidth,height:colHeight,hdpiratio:hdpiRatio};d.style.zIndex="4";d.style.webkitTransform="translate("+startX+"px, "+0+"px)";d.style.cursor="none";this.repaint()},createDragColumn:function(x,colIndex){var scrollLeft=this.getHScrollValue();var numFixedCols=this.getFixedColCount();var hdpiRatio=this.getHiDPI(this.draggerCTX);var colWidth=colIndex<0?this.getFixedColumnWidth(numFixedCols+colIndex+scrollLeft):this.getColumnWidth(colIndex+scrollLeft);var colHeight=this.clientHeight;var d=this.dragger;d.setAttribute("width",Math.round(colWidth*hdpiRatio)+"px");d.setAttribute("height",Math.round(colHeight*hdpiRatio)+"px");d.style.width=colWidth+"px";d.style.height=colHeight+"px";var startX=this.renderer.renderedColWidths[colIndex+numFixedCols];startX=startX*hdpiRatio;this.draggerCTX.scale(hdpiRatio,hdpiRatio);this.columnRenderOverridesCache.dragger={colIndex:colIndex,ctx:this.draggerCTX,startX:startX,width:colWidth,height:colHeight,hdpiratio:hdpiRatio};d.style.webkitTransform="translate("+x+"px, "+0+"px)";d.style.zIndex="5";d.style.cursor="none";this.repaint()},getHiDPI:function(ctx){if(window.devicePixelRatio&&this.canvas.isHiDPI()){var devicePixelRatio=window.devicePixelRatio||1;var backingStoreRatio=ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1;var ratio=devicePixelRatio/backingStoreRatio;return ratio}else{return 1}},getFinalVisableColumnBoundry:function(){var renderer=this.getRenderer();var boundry=renderer.getFinalVisableColumnBoundry();return boundry},dragColumn:function(x){var hdpiRatio=this.getHiDPI(this.draggerCTX);var dragColumnIndex=this.columnRenderOverridesCache.dragger.colIndex;var colWidth=this.columnRenderOverridesCache.dragger.width;var minX=this.getFixedColsWidth();var maxX=this.getFinalVisableColumnBoundry()-colWidth;x=Math.min(x,maxX+15);x=Math.max(minX-15,x);var atMin=x<minX&&dragColumnIndex!==0;var atMax=x>maxX;var d=this.dragger;d.style.webkitTransition="";d.style.transition="";d.style.webkitTransform="translate("+x+"px, "+0+"px)";d.style.display="inline";var overCol=this.renderer.getColumnFromPixelX(x+d.width/2/hdpiRatio);if(atMin){overCol=0}var colDif=overCol-dragColumnIndex;var columnDragDirection=colDif>1;var threshold=columnDragDirection?1:0;if(colDif>1||colDif<0||atMin||atMax){this.createFloatColumn(overCol-threshold);this.floatColumnTo(columnDragDirection)}if(x<minX-10){this.checkAutoScrollToLeft(x)}if(x>minX-5&&x<minX+5){this.columnDragAutoScrolling=false}if(x>maxX+10){this.checkAutoScrollToRight(x)}if(x<maxX+5&&x>maxX-5){this.columnDragAutoScrolling=false}},checkAutoScrollToRight:function(x){if(this.columnDragAutoScrolling){return}this.columnDragAutoScrolling=true;this._checkAutoScrollToRight(x)},_checkAutoScrollToRight:function(x){if(!this.columnDragAutoScrolling){return}var behavior=this.getBehavior();var scrollLeft=this.getHScrollValue();if(!this.dragging||scrollLeft>this.sbHScrlCfg.rangeStop-2){return}var draggedIndex=this.columnRenderOverridesCache.dragger.colIndex;behavior.swapColumns(draggedIndex+scrollLeft,draggedIndex+scrollLeft+1);this.scrollBy(1,0);setTimeout(this._checkAutoScrollToRight.bind(this,x),250)},checkAutoScrollToLeft:function(x){if(this.columnDragAutoScrolling){return}this.columnDragAutoScrolling=true;this._checkAutoScrollToLeft(x)},_checkAutoScrollToLeft:function(x){if(!this.columnDragAutoScrolling){return}var behavior=this.getBehavior();var scrollLeft=this.getHScrollValue();if(!this.dragging||scrollLeft<1){return}var draggedIndex=this.columnRenderOverridesCache.dragger.colIndex;behavior.swapColumns(draggedIndex+scrollLeft,draggedIndex+scrollLeft-1);this.scrollBy(-1,0);setTimeout(this._checkAutoScrollToLeft.bind(this,x),250)},endDragColumn:function(){var self=this;var numFixedCols=this.getFixedColCount();var colIndex=this.columnRenderOverridesCache.dragger.colIndex;var startX=this.renderer.renderedColWidths[colIndex+numFixedCols];var d=this.dragger;d.style.webkitTransition="-webkit-transform "+colAnimationTime+"ms ease";d.style.transition="transform "+colAnimationTime+"ms ease";d.style.webkitTransform="translate("+startX+"px, "+0+"px)";setTimeout(function(){self.columnRenderOverridesCache.dragger=null;d.style.display="none";self.repaint()},colAnimationTime+50)},toggleHiDPI:function(){if(this.canvas.isHiDPI()){this.removeAttribute("hidpi")}else{this.setAttribute("hidpi",null)}this.canvas.resize()}})})();</script></polymer-element></body></html>